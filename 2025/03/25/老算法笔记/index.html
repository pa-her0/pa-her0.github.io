<!doctype html>
<html lang="zh"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta><title>老算法笔记 - 霸王龙的小窝🦖</title><link rel="manifest" href="/manifest.json"><meta name="application-name" content="霸王龙的小窝🦖"><meta name="msapplication-TileImage" content="/img/Whale.png"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-title" content="霸王龙的小窝🦖"><meta name="apple-mobile-web-app-status-bar-style" content="default"><meta name="description" content="代码的开始，算法学习的开始"><meta property="og:type" content="article"><meta property="og:title" content="老算法笔记"><meta property="og:url" content="http://whalefall.fun/2025/03/25/%E8%80%81%E7%AE%97%E6%B3%95%E7%AC%94%E8%AE%B0/"><meta property="og:site_name" content="霸王龙的小窝🦖"><meta property="og:description" content="代码的开始，算法学习的开始"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="http://whalefall.fun/img/ACM1.png"><meta property="article:published_time" content="2025-03-25T14:11:52.000Z"><meta property="article:modified_time" content="2025-07-26T06:37:36.018Z"><meta property="article:author" content="Jiely"><meta property="article:tag" content="热爱"><meta property="twitter:card" content="summary"><meta property="twitter:image:src" content="http://whalefall.fun/img/ACM1.png"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"http://whalefall.fun/2025/03/25/%E8%80%81%E7%AE%97%E6%B3%95%E7%AC%94%E8%AE%B0/"},"headline":"老算法笔记","image":["http://whalefall.fun/img/ACM1.png"],"datePublished":"2025-03-25T14:11:52.000Z","dateModified":"2025-07-26T06:37:36.018Z","author":{"@type":"Person","name":"Jiely"},"publisher":{"@type":"Organization","name":"霸王龙的小窝🦖","logo":{"@type":"ImageObject","url":{"light":"/img/JIELY.png","dark":"/img/JIELY.png"}}},"description":"代码的开始，算法学习的开始"}</script><link rel="canonical" href="http://whalefall.fun/2025/03/25/%E8%80%81%E7%AE%97%E6%B3%95%E7%AC%94%E8%AE%B0/"><link rel="alternate" href="/atom.xml" title="霸王龙的小窝🦖" type="application/atom+xml"><link rel="icon" href="/img/Whale.png"><link rel="stylesheet" href="/css/font/fontawesome/css/all.min.css"><link data-pjax rel="stylesheet" href="/js/imaegoo/highlight.js/11.7.0/styles/tokyo-night-dark.css"><link data-pjax rel="stylesheet" href="/css/default.css"><style>
                /* 主要容器圆角 */
                .card, .box, .notification {
                    border-radius: 12px;
                }
                
                /* 文章卡片 */
                .card-content, .media, .timeline-item {
                    border-radius: 8px;
                }
                
                /* 导航栏 */
                .navbar {
                    border-radius: 0 0 12px 12px;
                }
                
                /* 侧边栏组件 */
                .widget, .menu-list a {
                    border-radius: 8px;
                }
                
                /* 按钮 */
                .button {
                    border-radius: 6px;
                }
                
                /* 输入框 */
                .input, .textarea, .select select {
                    border-radius: 6px;
                }
                
                /* 代码块 */
                pre, code {
                    border-radius: 6px;
                }
                
                /* 引用块 */
                blockquote {
                    border-radius: 0 8px 8px 0;
                }
                
                /* 图片 */
                img {
                    border-radius: 8px;
                }
                
                /* 标签 */
                .tag {
                    border-radius: 12px;
                }
                
                /* 分页器 */
                .pagination-link, .pagination-previous, .pagination-next {
                    border-radius: 6px;
                }
                
                /* 评论区域 */
                .comments {
                    border-radius: 12px;
                }
                
                /* 目录 */
                .toc {
                    border-radius: 8px;
                }
                
                /* Mac风格的轻微阴影效果 */
                .card {
                    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
                    transition: box-shadow 0.3s ease;
                }
                
                .card:hover {
                    box-shadow: 0 4px 16px rgba(0, 0, 0, 0.15);
                }
            </style><!--!--><!--!--><script src="https://vercount.one/js" defer></script><link rel="stylesheet" href="/js/imaegoo/lightgallery/1.10.0/dist/css/lightgallery.min.css"><link rel="stylesheet" href="/js/imaegoo/justifiedGallery/3.8.1/dist/css/justifiedGallery.min.css"><script src="https://www.googletagmanager.com/gtag/js?id=G-RCCCLYKRH5" async></script><script>window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
    
        gtag('config', 'G-RCCCLYKRH5');</script><!--!--><link rel="stylesheet" href="/js/imaegoo/cookieconsent/3.1.1/build/cookieconsent.min.css"><!-- hexo injector head_end start --><script>
  (function () {
      function switchTab() {
          if (!location.hash) {
            return;
          }

          const id = '#' + CSS.escape(location.hash.substring(1));
          const $tabMenu = document.querySelector(`.tabs a[href="${id}"]`);
          if (!$tabMenu) {
            return;
          }

          const $tabMenuContainer = $tabMenu.parentElement.parentElement;
          Array.from($tabMenuContainer.children).forEach($menu => $menu.classList.remove('is-active'));
          Array.from($tabMenuContainer.querySelectorAll('a'))
              .map($menu => document.getElementById($menu.getAttribute("href").substring(1)))
              .forEach($content => $content.classList.add('is-hidden'));

          if ($tabMenu) {
              $tabMenu.parentElement.classList.add('is-active');
          }
          const $activeTab = document.querySelector(id);
          if ($activeTab) {
              $activeTab.classList.remove('is-hidden');
          }
      }
      switchTab();
      window.addEventListener('hashchange', switchTab, false);
  })();
  </script><!-- hexo injector head_end end --><meta name="generator" content="Hexo 7.3.0"><style>mjx-container[jax="SVG"] {
  direction: ltr;
}

mjx-container[jax="SVG"] > svg {
  overflow: visible;
}

mjx-container[jax="SVG"][display="true"] {
  display: block;
  text-align: center;
  margin: 1em 0;
}

mjx-container[jax="SVG"][justify="left"] {
  text-align: left;
}

mjx-container[jax="SVG"][justify="right"] {
  text-align: right;
}

g[data-mml-node="merror"] > g {
  fill: red;
  stroke: red;
}

g[data-mml-node="merror"] > rect[data-background] {
  fill: yellow;
  stroke: none;
}

g[data-mml-node="mtable"] > line[data-line] {
  stroke-width: 70px;
  fill: none;
}

g[data-mml-node="mtable"] > rect[data-frame] {
  stroke-width: 70px;
  fill: none;
}

g[data-mml-node="mtable"] > .mjx-dashed {
  stroke-dasharray: 140;
}

g[data-mml-node="mtable"] > .mjx-dotted {
  stroke-linecap: round;
  stroke-dasharray: 0,140;
}

g[data-mml-node="mtable"] > svg {
  overflow: visible;
}

[jax="SVG"] mjx-tool {
  display: inline-block;
  position: relative;
  width: 0;
  height: 0;
}

[jax="SVG"] mjx-tool > mjx-tip {
  position: absolute;
  top: 0;
  left: 0;
}

mjx-tool > mjx-tip {
  display: inline-block;
  padding: .2em;
  border: 1px solid #888;
  font-size: 70%;
  background-color: #F8F8F8;
  color: black;
  box-shadow: 2px 2px 5px #AAAAAA;
}

g[data-mml-node="maction"][data-toggle] {
  cursor: pointer;
}

mjx-status {
  display: block;
  position: fixed;
  left: 1em;
  bottom: 1em;
  min-width: 25%;
  padding: .2em .4em;
  border: 1px solid #888;
  font-size: 90%;
  background-color: #F8F8F8;
  color: black;
}

foreignObject[data-mjx-xml] {
  font-family: initial;
  line-height: normal;
  overflow: visible;
}

.MathJax path {
  stroke-width: 3;
}

mjx-container[display="true"] {
  overflow: auto hidden;
}

mjx-container[display="true"] + br {
  display: none;
}
</style></head><head><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css"></head><body class="is-2-column"><script type="text/javascript" src="/js/imaegoo/night.js"></script><canvas id="universe"></canvas><style>
                    @media screen and (min-width: 1024px) {
                        .container {
                            max-width: 900px !important;
                        }
                    }
                    @media screen and (min-width: 1216px) {
                        .container {
                            max-width: 1000px !important;
                        }
                    }
                    @media screen and (min-width: 1408px) {
                        .container {
                            max-width: 1100px !important;
                        }
                    }
                </style><nav class="navbar navbar-main"><div class="container navbar-container" style="paddingLeft:0.25rem;paddingRight:0.5rem;"><div class="navbar-brand" style="marginLeft:-2rem;"><a class="navbar-item navbar-logo" href="/"><img class="logo-img" src="/img/JIELY.png" alt="霸王龙的小窝🦖" height="28"><img class="logo-img-dark" src="/img/JIELY.png" alt="霸王龙的小窝🦖" height="28"></a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item" href="/">首页</a><a class="navbar-item" href="/archives/">时间轴</a><a class="navbar-item" href="/categories/">分类</a><a class="navbar-item" href="/tags/">标签</a><a class="navbar-item" href="/about/">关于</a></div><div class="navbar-end"><a class="navbar-item is-hidden-tablet catalogue" title="目录" href="javascript:;"><i class="fas fa-list-ul"></i><span>  目录</span></a><a class="navbar-item night" id="night-nav" title="Night Mode" href="javascript:;"><i class="fas fa-moon" id="night-icon"></i></a><a class="navbar-item search" title="搜索" href="javascript:;"><i class="fas fa-search"></i></a></div></div></div></nav><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-8-tablet is-8-desktop is-10-widescreen"><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2025-03-25T14:11:52.000Z" title="3/25/2025, 10:11:52 PM">2025-03-25</time>发表</span><span class="level-item"><time dateTime="2025-07-26T06:37:36.018Z" title="7/26/2025, 2:37:36 PM">2025-07-26</time>更新</span><span class="level-item"><a class="link-muted" href="/categoriehexo-theme-claudias/%E7%AE%97%E6%B3%95/">算法</a></span><span class="level-item">42 分钟读完 (大约6373个字)</span><span class="level-item leancloud_visitors" id="/2025/03/25/%E8%80%81%E7%AE%97%E6%B3%95%E7%AC%94%E8%AE%B0/" data-flag-title="老算法笔记"><i class="far fa-eye"></i>&nbsp;&nbsp;<span id="twikoo_visitors"><i class="fa fa-spinner fa-spin"></i></span>次访问</span></div></div><h1 class="title is-3 is-size-4-mobile">老算法笔记</h1><div class="content"><blockquote class="alert alert-note">
<p><strong>代码的开始，算法学习的开始</strong></p>
</blockquote>
<span id="more"></span>
<h1>左神课程笔记</h1>
<h1>前置基本问题：</h1>
<h2 id="1-归并分治算法">1. 归并分治算法</h2>
<h3 id="大范围的答案-等不等于-左边部分-右边部分-跨越左右两边的答案">大范围的答案  等不等于 左边部分 + 右边部分 + 跨越左右两边的答案</h3>
<p>💡考虑跨左右 <strong>有序</strong>是否能提升便捷性。</p>
<ul class="lvl-0">
<li class="lvl-2">
<p><strong>归并排序：</strong></p>
</li>
</ul>
<p>💡归并排序是一个稳定的排序。</p>
<p><strong>分成左右，merge排序</strong></p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">1e5</span><span class="number">+10</span>;</span><br><span class="line"><span class="type">int</span> a[N];</span><br><span class="line"><span class="type">int</span> help[N];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">merge</span><span class="params">(<span class="type">int</span> l,<span class="type">int</span> r)</span></span>{</span><br><span class="line">    <span class="type">int</span> i = l, j = ((l + r) &gt;&gt; <span class="number">1</span>) + <span class="number">1</span>, t1 = <span class="number">0</span>;</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">while</span>(i &lt;= ((l + r)&gt;&gt; <span class="number">1</span>) &amp;&amp; j &lt;= r){</span><br><span class="line">          help[t1++] = (a[i] &lt;= a[j]) ? a[i++] : a[j++];}</span><br><span class="line">    <span class="keyword">while</span>(i &lt;= ((l + r)&gt;&gt; <span class="number">1</span>) ){. help[t1++] = a[i++];  }</span><br><span class="line">    <span class="keyword">while</span>(j &lt;= r){. help[t1++] = a[j++];  }</span><br><span class="line">   </span><br><span class="line">    <span class="keyword">for</span>(i = r; i &gt;=l; i--){. a[i] = help[--t1];  }</span><br><span class="line">}</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">guibin</span><span class="params">(<span class="type">int</span> l, <span class="type">int</span> r,<span class="type">int</span> n)</span></span>{</span><br><span class="line">     <span class="keyword">if</span>(l &gt;= r) <span class="keyword">return</span> ;</span><br><span class="line"> </span><br><span class="line">     <span class="built_in">guibin</span>(l, (l + r) &gt;&gt; <span class="number">1</span>, n);</span><br><span class="line">     <span class="built_in">guibin</span>(((l + r) &gt;&gt; <span class="number">1</span>)<span class="number">+1</span>, r, n);</span><br><span class="line">     <span class="built_in">merge</span>(l, r);</span><br><span class="line">}</span><br><span class="line">  </span><br></pre></td></tr></table></figure>
<ul class="lvl-0">
<li class="lvl-2">
<p><strong>归并分治</strong></p>
</li>
</ul>
<p>💡</p>
<p>归并分治是基于归并排序，在归并排序的基础上进行分 <strong>左右 + 左右中的过渡</strong>，主要是<strong>分析左右中的过渡过程是否跟左右部分的有序性相关。</strong></p>
<h2 id="2-随机快速排序">2. 随机快速排序</h2>
<p><strong>基本内容与快速排序保持一致，只是在选择pivot的时候是随机选择。</strong></p>
<aside>
💡
<p>pivot的随机选择是从概率上讲快速排序的时间复杂度降低到<strong>O(nlogn)</strong></p>
<p><strong>快排的重要部分是 partition函数 部分</strong></p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">1e5</span><span class="number">+10</span>;</span><br><span class="line"><span class="type">int</span> nums[N];</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> a,b;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">swap</span><span class="params">(<span class="type">int</span> i, <span class="type">int</span> j)</span></span>{</span><br><span class="line">    <span class="type">int</span> temp;</span><br><span class="line">    temp = nums[i];</span><br><span class="line">    nums[i] = nums[j];</span><br><span class="line">    nums[j] = temp;</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">part</span><span class="params">(<span class="type">int</span> l, <span class="type">int</span> r, <span class="type">int</span> x)</span></span>{</span><br><span class="line">    <span class="type">int</span>  i = l; <span class="comment">// 小于区域 a 大于区域 b</span></span><br><span class="line">    a = l, b = r;</span><br><span class="line">    <span class="keyword">while</span>(i &lt;= b){</span><br><span class="line">         <span class="keyword">if</span>(nums[i] &lt; x){</span><br><span class="line">            <span class="built_in">swap</span>(i++,a++);</span><br><span class="line">         }<span class="keyword">else</span> <span class="keyword">if</span>(nums[i] &gt; x){</span><br><span class="line">            <span class="built_in">swap</span>(i, b--);</span><br><span class="line">         }<span class="keyword">else</span> i++;</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">quick__sort</span><span class="params">(<span class="type">int</span> l, <span class="type">int</span> r)</span></span>{</span><br><span class="line">    <span class="keyword">if</span>(l &gt;= r){</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    }</span><br><span class="line">    <span class="type">int</span> pivot = nums[l];</span><br><span class="line">    <span class="built_in">part</span>(l, r, pivot);</span><br><span class="line">    <span class="built_in">quick__sort</span>(l,a<span class="number">-1</span>);</span><br><span class="line">    <span class="built_in">quick__sort</span>(b<span class="number">+1</span>,r);</span><br><span class="line">}</span><br></pre></td></tr></table></figure>
<h3 id="可以用-partition-来寻找-第k大-第k小-荷兰国旗问题">可以用 partition 来寻找 第k大 第k小 (荷兰国旗问题)</h3>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">1e5</span><span class="number">+10</span>;</span><br><span class="line"><span class="type">int</span> nums[N];</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> a, b;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">swap</span><span class="params">(<span class="type">int</span> i, <span class="type">int</span> j)</span></span>{</span><br><span class="line">    <span class="type">int</span> temp = nums[i];</span><br><span class="line">    nums[i] = nums[j];</span><br><span class="line">    nums[j] = temp;</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">partition</span><span class="params">(<span class="type">int</span> l, <span class="type">int</span> r, <span class="type">int</span> x)</span></span>{</span><br><span class="line">    <span class="type">int</span> i = l;</span><br><span class="line">    a = l, b = r;</span><br><span class="line">    <span class="keyword">while</span>(i &lt;= b){</span><br><span class="line">          <span class="keyword">if</span>(nums[i] &lt; x){</span><br><span class="line">            <span class="built_in">swap</span>(i++,a++);</span><br><span class="line">          }<span class="keyword">else</span> <span class="keyword">if</span>(nums[i] &gt; x){</span><br><span class="line">            <span class="built_in">swap</span>(i, b--);</span><br><span class="line">          }<span class="keyword">else</span> i++;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">}</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">find</span><span class="params">(<span class="type">int</span> k, <span class="type">int</span> n)</span></span>{</span><br><span class="line">    <span class="type">int</span> ans = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> l = <span class="number">0</span>, r = n; l &lt;= r;){</span><br><span class="line">        <span class="built_in">partition</span>(l, r, nums[l]);</span><br><span class="line">        <span class="keyword">if</span>(k &lt; a){</span><br><span class="line">            r = a <span class="number">-1</span>;</span><br><span class="line">        }<span class="keyword">else</span> <span class="keyword">if</span>(k &gt; b){</span><br><span class="line">            l = b + <span class="number">1</span>;</span><br><span class="line">        }<span class="keyword">else</span>{</span><br><span class="line">            ans = nums[k];</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">}</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h2 id="构建前缀信息（46）">构建前缀信息（46）</h2>
<p>常见构建</p>
<ul class="lvl-0">
<li class="lvl-2">
<p>构建前缀信息 （<strong>最早 最晚） 出现的位置</strong></p>
</li>
</ul>
<ol>
<li class="lvl-3">
<p>前缀和来 求区间和</p>
</li>
</ol>
<ul class="lvl-0">
<li class="lvl-2">
<p>sum[i] = sum[i-1] + a[i]</p>
</li>
<li class="lvl-2">
<p>{l , r} → sum[r + 1] - sum[l]</p>
<ol start="2">
<li class="lvl-6">求 区间累加和 为确定值的 最长长度（子数组个数）</li>
</ol>
</li>
<li class="lvl-2">
<p>记录 t = sum[i] - aim 的最早出现次数（i 之前的 t 的出现个数）</p>
<ol start="3">
<li class="lvl-5">正数 和 负数 相等的 最长数组长度</li>
</ol>
</li>
<li class="lvl-2">
<p>正数相当于 1 负数相当于 -1 求区间为 0 1的子数组最长长度</p>
</li>
</ul>
<ol start="4">
<li class="lvl-4">
<p>区间大于 0 的最长数组长度 （值只有 -1, 1）</p>
</li>
</ol>
<ul class="lvl-0">
<li class="lvl-2">
<p>aim = sum[i] - sum[j] ≥ 0</p>
</li>
<li class="lvl-2">
<p><input type="checkbox" id="checkbox3"><label for="checkbox3"> if sum[i] &gt; 0 → ans = i</label></p>
</li>
<li class="lvl-2">
<p><input type="checkbox" id="checkbox4"><label for="checkbox4"> if sum[i] ≤ 0 → sum[i] -1 最早出现的位置</label></p>
</li>
</ul>
<ol start="5">
<li class="lvl-4">
<p>移除最短的数组子数组长度 sum 能被 p 整数</p>
</li>
</ol>
<ul class="lvl-0">
<li class="lvl-2">
<p>与 余数相关</p>
</li>
<li class="lvl-2">
<p>sum1 %  p = a  // sum2 % p = b</p>
</li>
<li class="lvl-2">
<p>if(a + b % p == 0)  (sum1 + sum2) % p == 0</p>
</li>
<li class="lvl-2">
<p>整体 aim = sum(总) % p → 看哪个区间的 的余数 (t + aim) % p == 0</p>
</li>
<li class="lvl-2">
<p>find = (t + p - aim) % p <strong>(同余原理) → 与环也有关</strong></p>
</li>
<li class="lvl-2">
</li>
</ul>
<p>💡</p>
<p>单调队列 和 单调栈 一样，保存着对于答案的可能性，并且从栈中弹出的时候，进行计算，不进行后续的计算，一般应用于 区间问题。</p>
<p><strong>核心思想 ： 越往后的 满足要求更好的选择 更好</strong></p>
<h2 id="单调队列">单调队列</h2>
<p>单调队列基本用法 → 用来维护一个<strong>窗口里面的最值（左闭右开）</strong></p>
<aside>
💡
因为从左弹出的时候，这个队列无论如何是没有过期下标的（要不一开始被最值从右边顶出去了，要不越界被左边弹出去了）
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">deque&lt;<span class="type">int</span>&gt; q;</span><br><span class="line">    <span class="keyword">for</span> (l = r = <span class="number">0</span>; r &lt; n; r++)</span><br><span class="line">    {</span><br><span class="line">        <span class="keyword">while</span> (!q.<span class="built_in">empty</span>() &amp;&amp; a[r] &gt;= a[q.<span class="built_in">back</span>()])</span><br><span class="line">        {</span><br><span class="line">            q.<span class="built_in">pop_back</span>();</span><br><span class="line">        }</span><br><span class="line">        q.<span class="built_in">push_back</span>(r);</span><br><span class="line">        <span class="keyword">if</span> (q.<span class="built_in">size</span>() == limit + <span class="number">1</span>)</span><br><span class="line">        {</span><br><span class="line">            <span class="keyword">if</span> (l++ == q.<span class="built_in">front</span>())</span><br><span class="line">            {</span><br><span class="line">                q.<span class="built_in">pop_front</span>();</span><br><span class="line">            }</span><br><span class="line">        }</span><br><span class="line">    }</span><br></pre></td></tr></table></figure>
<h3 id="优先队列扩展">优先队列扩展</h3>
<ol>
<li class="lvl-3">
<p>区间和 小于 定值的 最短长度</p>
</li>
</ol>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> <span class="title">shortestSubarray</span><span class="params">(vector&lt;<span class="type">int</span>&gt;&amp; nums, <span class="type">int</span> k)</span> </span>{</span><br><span class="line">   <span class="type">int</span> n = nums.<span class="built_in">size</span>();</span><br><span class="line">   <span class="function">vector&lt;<span class="type">long</span> <span class="type">long</span>&gt; <span class="title">sum</span><span class="params">(n + <span class="number">1</span>, <span class="number">0</span>)</span></span>;</span><br><span class="line">   deque&lt;<span class="type">int</span>&gt; q; <span class="comment">// 小 -&gt; 大</span></span><br><span class="line">   <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++){</span><br><span class="line">       sum[i] = sum[i<span class="number">-1</span>] + nums[i<span class="number">-1</span>];</span><br><span class="line">   }</span><br><span class="line">   <span class="type">int</span> ans = INT_MAX;</span><br><span class="line">   q.<span class="built_in">push_back</span>(<span class="number">0</span>);</span><br><span class="line">   <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++){</span><br><span class="line">       <span class="keyword">while</span>(!q.<span class="built_in">empty</span>() &amp;&amp; sum[i] - sum[q.<span class="built_in">front</span>()] &gt;= k){</span><br><span class="line">           <span class="comment">//cout &lt;&lt; ans &lt;&lt; " " &lt;&lt; i - q.front() &lt;&lt; endl;</span></span><br><span class="line">           ans = <span class="built_in">min</span>(ans,i - q.<span class="built_in">front</span>());</span><br><span class="line">           q.<span class="built_in">pop_front</span>();</span><br><span class="line">       }           </span><br><span class="line">       <span class="keyword">while</span>(!q.<span class="built_in">empty</span>() &amp;&amp; sum[i] &lt;= sum[q.<span class="built_in">back</span>()]){</span><br><span class="line">           q.<span class="built_in">pop_back</span>();</span><br><span class="line">       }</span><br><span class="line">       q.<span class="built_in">push_back</span>(i);</span><br><span class="line">   }</span><br><span class="line">   <span class="keyword">return</span> ans == INT_MAX ? <span class="number">-1</span> : ans;</span><br><span class="line">   }</span><br></pre></td></tr></table></figure>
<h3 id="双端队列吃药任务安排">双端队列吃药任务安排</h3>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="type">int</span> n, s;</span><br><span class="line">cin &gt;&gt; n &gt;&gt;s;</span><br><span class="line"><span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">a</span><span class="params">(n)</span></span>;</span><br><span class="line"><span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">b</span><span class="params">(n)</span></span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; i++) cin &gt;&gt; a[i]; <span class="comment">// 人的体力</span></span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; i++) cin &gt;&gt; b[i]; <span class="comment">// 任务的需求</span></span><br><span class="line"><span class="built_in">sort</span>(a.<span class="built_in">begin</span>(),a.<span class="built_in">end</span>());</span><br><span class="line"><span class="built_in">sort</span>(b.<span class="built_in">begin</span>(),b.<span class="built_in">end</span>());</span><br><span class="line"><span class="type">int</span> ans = <span class="number">0</span>; <span class="comment">// 最少的药丸次数</span></span><br><span class="line">deque&lt;<span class="type">int</span>&gt; q;    </span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">      先看每一个的力所能及 放入队列中</span></span><br><span class="line"><span class="comment">  */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>, p = <span class="number">0</span>; i &lt; n; i++){</span><br><span class="line">    <span class="keyword">while</span>(p &lt; n &amp;&amp; b[p] &lt;= a[i]){</span><br><span class="line">        q.<span class="built_in">push_back</span>(b[p++]); </span><br><span class="line">    }</span><br><span class="line">    <span class="keyword">if</span>(!q.<span class="built_in">empty</span>() &amp;&amp; a[i] &gt;= q.<span class="built_in">front</span>()){</span><br><span class="line">       q.<span class="built_in">pop_front</span>();</span><br><span class="line">    }<span class="keyword">else</span> {</span><br><span class="line">        <span class="keyword">while</span>(p &lt; n &amp;&amp; b[p] &lt; a[i] + s){</span><br><span class="line">            q.<span class="built_in">push_back</span>(b[p++]);</span><br><span class="line">        }</span><br><span class="line">        <span class="keyword">if</span>(q.<span class="built_in">empty</span>()){</span><br><span class="line">            cout &lt;&lt; <span class="string">"can't do it"</span> &lt;&lt; endl;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        }<span class="keyword">else</span>{</span><br><span class="line">            ans++;</span><br><span class="line">            q.<span class="built_in">pop_back</span>(); <span class="comment">// 吃药取最大</span></span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line">cout &lt;&lt; ans &lt;&lt; endl;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br></pre></td></tr></table></figure>
<h2 id="单调栈">单调栈</h2>
<ul class="lvl-0">
<li class="lvl-2">
<p>基本使用方法 维护 <strong>左右侧</strong> 比 当前元素 <strong>大或者小</strong> 的最近位置</p>
</li>
</ul>
<aside>
💡
<p>构建一个 栈 → 越后出现的值 有更大的<strong>影响力</strong></p>
<p><strong>找出 以某个值为最值的 子数组（最长 或者 对这个子数组进行一些计算）</strong></p>
<p><strong>同时间维护左右的 最近的 最值</strong></p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">stack&lt;<span class="type">int</span>&gt; s; <span class="comment">// 记录下标</span></span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; i++){</span><br><span class="line">    <span class="keyword">while</span>(!s.<span class="built_in">empty</span>() &amp;&amp; a[s.<span class="built_in">top</span>()] &gt;= a[i]){</span><br><span class="line">        <span class="comment">// i 为右边</span></span><br><span class="line">        <span class="type">int</span> cur = s.<span class="built_in">top</span>(); s.<span class="built_in">pop</span>(); <span class="comment">// 中间</span></span><br><span class="line">        <span class="type">int</span> l = s.<span class="built_in">empty</span>() ? <span class="number">-1</span> : s.<span class="built_in">top</span>(); <span class="comment">// 左边</span></span><br><span class="line">    }</span><br><span class="line">    s.<span class="built_in">push</span>(i);</span><br><span class="line">}</span><br><span class="line"><span class="keyword">while</span>(!s.<span class="built_in">empty</span>()){</span><br><span class="line">    <span class="type">int</span> cur = s.<span class="built_in">top</span>(); s.<span class="built_in">pop</span>();</span><br><span class="line">    <span class="type">int</span> l = s.<span class="built_in">empty</span>() ? <span class="number">-1</span> : s.<span class="built_in">top</span>();</span><br><span class="line">    ans += (cur - l) * (n - cur) * a[cur];</span><br><span class="line">}</span><br></pre></td></tr></table></figure>
<p>创新 ：</p>
<p>求 <strong>子数组中的最小值的和</strong></p>
<aside>
💡
<p>用 单调栈 → 求出左右两边 小于(大于) 这个值的位置 → 在这个中间 i位置的值便是最值</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>{</span><br><span class="line">    <span class="type">int</span> n;</span><br><span class="line">    cin &gt;&gt; n;</span><br><span class="line">    <span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">a</span><span class="params">(n)</span></span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; i++){</span><br><span class="line">        cin &gt;&gt; a[i];</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 在子数组中 cur 位置为最小 i 为 右边</span></span><br><span class="line">    stack&lt;<span class="type">int</span>&gt; s; <span class="comment">// 记录下标</span></span><br><span class="line">    <span class="type">long</span> <span class="type">long</span> ans = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; i++){</span><br><span class="line">        <span class="keyword">while</span>(!s.<span class="built_in">empty</span>() &amp;&amp; a[s.<span class="built_in">top</span>()] &gt;= a[i]){</span><br><span class="line">            <span class="type">int</span> cur = s.<span class="built_in">top</span>(); s.<span class="built_in">pop</span>(); <span class="comment">// 中间</span></span><br><span class="line">            <span class="type">int</span> l = s.<span class="built_in">empty</span>() ? <span class="number">-1</span> : s.<span class="built_in">top</span>(); <span class="comment">// 左边</span></span><br><span class="line">            ans += (cur - l) * (i - cur) * a[cur];</span><br><span class="line">        }</span><br><span class="line">        s.<span class="built_in">push</span>(i);</span><br><span class="line">    }</span><br><span class="line">    <span class="keyword">while</span>(!s.<span class="built_in">empty</span>()){</span><br><span class="line">        <span class="type">int</span> cur = s.<span class="built_in">top</span>(); s.<span class="built_in">pop</span>();</span><br><span class="line">        <span class="type">int</span> l = s.<span class="built_in">empty</span>() ? <span class="number">-1</span> : s.<span class="built_in">top</span>();</span><br><span class="line">        ans += (cur - l) * (n - cur) * a[cur];</span><br><span class="line">    }</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">}</span><br></pre></td></tr></table></figure>
<h3 id="实现最小字典序（单调栈）">实现最小字典序（单调栈）</h3>
<aside>
💡
<p>利用单调栈来维护一个从小到大的 stack</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; a.<span class="built_in">size</span>(); i++){</span><br><span class="line">     in[a[i] - <span class="string">'a'</span>]++;</span><br><span class="line"> }</span><br><span class="line"></span><br><span class="line"> stack&lt;pair&lt;<span class="type">char</span>,<span class="type">int</span>&gt;&gt; s;</span><br><span class="line"> <span class="function">vector&lt;<span class="type">bool</span>&gt; <span class="title">vis</span><span class="params">(<span class="number">26</span>,<span class="literal">false</span>)</span></span>;</span><br><span class="line"></span><br><span class="line"> <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; a.<span class="built_in">size</span>(); i++){</span><br><span class="line"> <span class="keyword">if</span>(!vis[a[i] - <span class="string">'a'</span>]){</span><br><span class="line"> <span class="keyword">while</span>(!s.<span class="built_in">empty</span>() &amp;&amp; s.<span class="built_in">top</span>().first &gt; a[i] &amp;&amp; in[s.<span class="built_in">top</span>().first - <span class="string">'a'</span>] &gt;= <span class="number">1</span>){</span><br><span class="line">         vis[s.<span class="built_in">top</span>().first- <span class="string">'a'</span>] = <span class="literal">false</span>;</span><br><span class="line">         s.<span class="built_in">pop</span>();</span><br><span class="line">     }</span><br><span class="line"> vis[a[i] - <span class="string">'a'</span>] = <span class="literal">true</span>;</span><br><span class="line"> s.<span class="built_in">push</span>({a[i], i});</span><br><span class="line"> }</span><br><span class="line"> in[a[i] - <span class="string">'a'</span>]--;</span><br><span class="line"> }</span><br><span class="line"> string ans = <span class="string">""</span>;</span><br><span class="line"> </span><br><span class="line"> <span class="keyword">while</span>(!s.<span class="built_in">empty</span>()){</span><br><span class="line">     ans = s.<span class="built_in">top</span>().first + ans;</span><br><span class="line">     s.<span class="built_in">pop</span>();</span><br><span class="line"> }</span><br></pre></td></tr></table></figure>
<h2 id="滑动窗口-双指针（视频）">滑动窗口 + 双指针（视频）</h2>
<h1>数据结构</h1>
<h2 id="前缀树（字典树）">前缀树（字典树）</h2>
<aside>
💡
<p>前缀树有点像链式前向星，是一个用静态数组来连接。</p>
<p><strong>重点部分</strong></p>
<p><strong>cnt：用序号表示连接，如果这个节点没有使用过，他把这个节点用cnt来编号，然后cur会使用它来跳转，会到达一个没有去过的层次。</strong></p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> cnt = <span class="number">1</span>; <span class="comment">// 层次编号</span></span><br><span class="line"><span class="comment">// 插入单词</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">insert</span><span class="params">(<span class="type">const</span> string&amp; word)</span> </span>{</span><br><span class="line">    <span class="type">int</span> cur = <span class="number">1</span>;</span><br><span class="line">    pass[cur]++;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">char</span> ch : word) {</span><br><span class="line">        <span class="type">int</span> path = ch - <span class="string">'a'</span>;</span><br><span class="line">        <span class="keyword">if</span> (tree[cur][path] == <span class="number">0</span>) {</span><br><span class="line">            tree[cur][path] = ++cnt;</span><br><span class="line">        }</span><br><span class="line">         cur = tree[cur][path];</span><br><span class="line">        pass[cur]++;</span><br><span class="line">    }</span><br><span class="line">    end[cur]++;</span><br><span class="line">}</span><br><span class="line"><span class="comment">// 查询前缀的数量</span></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">prefixNumber</span><span class="params">(<span class="type">const</span> string&amp; prefix)</span> </span>{</span><br><span class="line">    <span class="type">int</span> cur = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">char</span> ch : prefix) {</span><br><span class="line">        <span class="type">int</span> path = ch - <span class="string">'a'</span>;</span><br><span class="line">        <span class="keyword">if</span> (tree[cur][path] == <span class="number">0</span>) {</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        }</span><br><span class="line">        cur = tree[cur][path];</span><br><span class="line">    }</span><br><span class="line">    <span class="keyword">return</span> pass[cur];</span><br><span class="line">}</span><br><span class="line"><span class="comment">// 删除单词</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">deleteWord</span><span class="params">(<span class="type">const</span> string&amp; word)</span> </span>{</span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">prefixNumber</span>(word) &gt; <span class="number">0</span>) {</span><br><span class="line">        <span class="type">int</span> cur = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">char</span> ch : word) {</span><br><span class="line">            <span class="type">int</span> path = ch - <span class="string">'a'</span>;</span><br><span class="line">            <span class="keyword">if</span> (--pass[tree[cur][path]] == <span class="number">0</span>) {</span><br><span class="line">                tree[cur][path] = <span class="number">0</span>;</span><br><span class="line">                <span class="keyword">return</span>;</span><br><span class="line">            }</span><br><span class="line">            cur = tree[cur][path];</span><br><span class="line">        }</span><br><span class="line">        end[cur]--;</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"><span class="comment">// 清空前缀树</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">clear</span><span class="params">()</span> </span>{</span><br><span class="line">    <span class="built_in">memset</span>(tree, <span class="number">0</span>, <span class="built_in">sizeof</span>(tree));</span><br><span class="line">    <span class="built_in">memset</span>(pass, <span class="number">0</span>, <span class="built_in">sizeof</span>(pass));</span><br><span class="line">    <span class="built_in">memset</span>(end, <span class="number">0</span>, <span class="built_in">sizeof</span>(end));</span><br><span class="line">    cnt = <span class="number">1</span>;</span><br><span class="line">}</span><br></pre></td></tr></table></figure>
<h3 id="以下是关于-字典树-二进制运算：">以下是关于 <strong>字典树 + 二进制</strong>运算：</h3>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">1e3</span><span class="number">+10</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> M = <span class="number">2</span>;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> pass[N];</span><br><span class="line"><span class="type">int</span> End[N];</span><br><span class="line"><span class="type">int</span> tree[N][M];</span><br><span class="line"><span class="type">int</span> cnt = <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">insert</span><span class="params">(<span class="type">int</span> s)</span></span>{</span><br><span class="line">     <span class="type">int</span> cur = <span class="number">1</span>;</span><br><span class="line">     <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">63</span>; i &gt;= <span class="number">0</span>; i--){</span><br><span class="line">         <span class="type">int</span> temp = ((<span class="number">1</span> &lt;&lt; i) &amp; s) &gt;&gt;i;</span><br><span class="line">         <span class="comment">//cout &lt;&lt; temp &lt;&lt; endl;</span></span><br><span class="line">        <span class="keyword">if</span>(tree[cur][temp] == <span class="number">0</span>){</span><br><span class="line">            tree[cur][temp] = ++cnt;</span><br><span class="line">        }</span><br><span class="line">        cur = tree[cur][temp];</span><br><span class="line">     }</span><br><span class="line">     <span class="comment">// 我如何取到这个二进制上面的值</span></span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">exam</span><span class="params">(<span class="type">int</span> t)</span></span>{</span><br><span class="line">    <span class="type">int</span> cur = <span class="number">1</span>;</span><br><span class="line">    <span class="type">int</span> Max = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">63</span>; i &gt;= <span class="number">0</span>; i--){</span><br><span class="line">        <span class="type">int</span> temp = (t &gt;&gt; i) &amp; <span class="number">1</span>;</span><br><span class="line">        <span class="comment">// 最好 temp ^ aim == 1 aim == 1 ^ temp</span></span><br><span class="line">        <span class="type">int</span> aim = <span class="number">1</span> ^ temp;</span><br><span class="line">        <span class="keyword">if</span>(tree[cur][aim] == <span class="number">0</span>){</span><br><span class="line">           aim ^= <span class="number">1</span>; </span><br><span class="line">        }</span><br><span class="line">        Max |= ((temp ^ aim) &lt;&lt; i);</span><br><span class="line">        cur = tree[cur][aim];</span><br><span class="line">    } </span><br><span class="line">    <span class="keyword">return</span> Max;</span><br><span class="line">}</span><br></pre></td></tr></table></figure>
<h2 id="单调栈-单调队列">单调栈 + 单调队列</h2>
<p>stack<int> st 便是单调栈的形式，只是栈中的元素是单调的。</int></p>
<p>priority_queue<int> q 便是单调队列（优先队列）的形式，在优先队列中的元素是单调的。</int></p>
<h2 id="并查集（模版）">并查集（模版）</h2>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">1e5</span> + <span class="number">10</span>;</span><br><span class="line"><span class="type">int</span> father[N];</span><br><span class="line"><span class="comment">// 初始化并查集</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">build</span><span class="params">(<span class="type">int</span> n)</span> </span>{</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; i++) {</span><br><span class="line">        father[i] = i;</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"><span class="comment">// 查找元素的根，并进行路径压缩</span></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">find</span><span class="params">(<span class="type">int</span> i)</span> </span>{</span><br><span class="line">    <span class="keyword">if</span> (i != father[i]) {</span><br><span class="line">        father[i] = <span class="built_in">find</span>(father[i]);</span><br><span class="line">    }</span><br><span class="line">    <span class="keyword">return</span> father[i];</span><br><span class="line">}</span><br><span class="line"><span class="comment">// 判断两个元素是否属于同一个集合</span></span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">isSameSet</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> y)</span> </span>{</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">find</span>(x) == <span class="built_in">find</span>(y);</span><br><span class="line">}</span><br><span class="line"><span class="comment">// 合并两个集合</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">unite</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> y)</span> </span>{</span><br><span class="line">    father[<span class="built_in">find</span>(x)] = <span class="built_in">find</span>(y);</span><br><span class="line">}</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="基本建图方法">基本建图方法</h3>
<ul class="lvl-0">
<li class="lvl-2">
<p>vector <strong>数组建图</strong></p>
</li>
</ul>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vector&lt;pair&lt;<span class="type">int</span>,<span class="type">int</span>&gt;&gt;a[<span class="number">10005</span>];</span><br></pre></td></tr></table></figure>
<ul class="lvl-0">
<li class="lvl-2">
<p><strong>链式前向星</strong></p>
</li>
</ul>
<aside>
💡     **初始的 cnt 是没有使用过的
    然后将这个 cnt 对应 v节点
    next 表示 下一条边的编号
    head[u] 节点的 头部边的编号**
---
<p><strong>u -&gt; new -&gt; old<br>
一开始的 head[u] -&gt; old<br>
现在将 head[u] -&gt; new 将 new 的 next -&gt; old</strong></p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">1e5</span><span class="number">+10</span>;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> cnt = <span class="number">0</span>;</span><br><span class="line"><span class="type">int</span> head[N];</span><br><span class="line"><span class="keyword">struct</span>{</span><br><span class="line">    <span class="type">int</span> to, next, w;</span><br><span class="line">}edge[N];</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">init</span><span class="params">()</span></span>{</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; N; i++){</span><br><span class="line">        head[i] = <span class="number">-1</span>;</span><br><span class="line">        edge[i].next = <span class="number">-1</span>;</span><br><span class="line">    }</span><br><span class="line">    cnt = <span class="number">1</span>;</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">add</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> v, <span class="type">int</span> w)</span></span>{</span><br><span class="line">    edge[cnt].to = v;</span><br><span class="line">    edge[cnt].w = w;</span><br><span class="line">    edge[cnt].next = head[u];</span><br><span class="line">    head[u] = cnt++;</span><br><span class="line">}</span><br><span class="line"><span class="comment">// 遍历方法</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">ex</span><span class="params">()</span></span>{</span><br><span class="line">    <span class="type">int</span> u ;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> e = head[u]; e &gt; <span class="number">0</span>; e = edge[e].next){</span><br><span class="line">        <span class="type">int</span> v = edge[e].to;</span><br><span class="line">     }</span><br><span class="line">}</span><br></pre></td></tr></table></figure>
<h2 id="拓扑排序">拓扑排序</h2>
<aside>
💡 所谓的拓扑排序，其实是图论里面的一个常见手段，常用于有前后关系的节点状态问题。
<p>常从 <strong>入度为0</strong> 的节点开始访问**。（与 priority_queue<int> 小根堆结合应用）**</int></p>
<p><em>如果无法把所有的点都删掉，说明有向图里有环</em></p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">1e5</span><span class="number">+10</span>;</span><br><span class="line"><span class="type">int</span> queue[N]; <span class="comment">// 可以用 STL 代替 （queue）</span></span><br><span class="line"><span class="type">int</span> indegree[N];</span><br></pre></td></tr></table></figure>
<h3 id="拓扑排序扩展知识（类似树型dp）">拓扑排序扩展知识（类似树型dp）</h3>
<aside>
💡
<p>将 上游节点的信息 → 推送到下游节点</p>
<h2 id="倍增算法-ST表（用于区间查询最值，gcd）-先看-基础dp">倍增算法 + ST表（用于区间查询最值，gcd）(先看 基础dp )</h2>
<aside>
💡
<p>原理：<strong>每一个数字 都能用 二进数 来表示 //  尽量逼进 目标值</strong></p>
<p>应用: 可重复贡献问题</p>
<p>前提：后面的点 跳的距离 会 大于等于 前面的点</p>
<p>跳跃公式：<strong>ST[ i ][ p ] = ST[ ST[ i ][ p-1 ] ][ p-1]</strong>    p → 跳 2 的 p 次方</p>
<p>从 <strong>大 → 小</strong> 尝试</p>
<p>仅需 初始化 ST[ i ][ 0 ] ，其余 可以用 跳跃公式 解决 //  从列开始填</p>
<aside>
💡
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">ST[i][p] = <span class="built_in">max</span>(ST[i][p<span class="number">-1</span>], ST[i + <span class="number">2</span> ^ p<span class="number">-1</span>][p<span class="number">-1</span>])</span><br><span class="line">ST[i][p] = <span class="built_in">min</span>(ST[i][p<span class="number">-1</span>], ST[i + <span class="number">2</span> ^ p<span class="number">-1</span>][p<span class="number">-1</span>])</span><br><span class="line">ST[i][p] = <span class="built_in">gcd</span>(ST[i][p<span class="number">-1</span>], ST[i + <span class="number">2</span> ^ p<span class="number">-1</span>][p<span class="number">-1</span>])</span><br><span class="line">     </span><br><span class="line">(i , j) -&gt; <span class="built_in">max</span>(ST[i][p], ST[j - <span class="number">2</span> ^ p + <span class="number">1</span>][p])  </span><br><span class="line">        <span class="comment">// p == log2(i - j + 1)</span></span><br></pre></td></tr></table></figure>
</aside>
<p>Max，Min的基本代码</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">1e3</span> + <span class="number">10</span>;</span><br><span class="line"><span class="type">int</span> Log2[N];</span><br><span class="line"><span class="type">int</span> stmax[N][N];</span><br><span class="line"><span class="type">int</span> stmin[N][N];</span><br><span class="line"><span class="type">int</span> num[N];</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">bulid</span><span class="params">(<span class="type">int</span> n)</span></span>{</span><br><span class="line">    Log2[<span class="number">0</span>] = <span class="number">-1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++){</span><br><span class="line">        Log2[i] = Log2[i &gt;&gt; <span class="number">1</span>] + <span class="number">1</span>;</span><br><span class="line">        stmax[i][<span class="number">0</span>] = num[i];</span><br><span class="line">        stmin[i][<span class="number">0</span>] = num[i]; </span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> p = <span class="number">1</span>; p &lt;= Log2[n]; p ++){</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++){</span><br><span class="line">            stmax[i][p] = <span class="built_in">max</span>(stmax[i][p<span class="number">-1</span>],stmax[i + (<span class="number">1</span> &lt;&lt; (p<span class="number">-1</span>))][ p<span class="number">-1</span> ]);</span><br><span class="line">            stmin[i][p] = <span class="built_in">min</span>(stmin[i][p<span class="number">-1</span>],stmin[i + (<span class="number">1</span> &lt;&lt; p<span class="number">-1</span>)][p<span class="number">-1</span>]); </span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></table></figure>
<p>扩展的可重复贡献区间问题:</p>
<p><strong>区间与 区间或 (两个相同的数字 与 或 不会影响结果)</strong></p>
<h2 id="树上问题">树上问题</h2>
<h3 id="树上倍增-LCA">树上倍增 + LCA</h3>
<ol>
<li class="lvl-3">
<p>tarjian算法</p>
</li>
</ol>
<aside>
💡
<p>批量 离线 查询</p>
<p>如果访问的 ans -&gt; u 的对应节点v 访问过 ans = v 的代表节点</p>
<p>理解：</p>
<pre><code>      因为 你到这个节点的时候，对应的节点访问过了的话，那些节点是在一个集合里面的，然后 节点遍历是 属于 DFS，所以都是 分支访问，访问完这个 分支， 节点进行汇总集合。
</code></pre>
</aside>
<p><img src="%E5%B7%A6%E7%A5%9E%E8%AF%BE%E7%A8%8B%E7%AC%94%E8%AE%B0%2017ae0092222580e58afce9620b5d2463/image.png" alt="image.png"></p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">tarjan</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> f)</span></span>{</span><br><span class="line">    vis[u] = <span class="literal">true</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> e = head[u]; e != <span class="number">0</span>; e = ed[e].next){</span><br><span class="line">        <span class="type">int</span> v = ed[e].to;</span><br><span class="line">        <span class="keyword">if</span>(v != f){</span><br><span class="line">            <span class="built_in">tarjan</span>(v, u);</span><br><span class="line">            father[v] = u;</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> e = q_head[u]; e != <span class="number">0</span>; e = que[e].next){</span><br><span class="line">        <span class="type">int</span> v = que[e].to;</span><br><span class="line">        <span class="keyword">if</span>(vis[v]){</span><br><span class="line">            ans[que[e].w] = <span class="built_in">find</span>(v);</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></table></figure>
<ol>
<li class="lvl-3">
<p>ST表</p>
</li>
</ol>
<aside>
💡
<p>当 Deep 深度数组 到达同一层的时候 所对应的 节点 是否相同</p>
<p>相同 ： LCA = Deep 小的</p>
<p>不相同：</p>
<p>再次同时间跳（only 不跳到同一节点我们才跳）</p>
<p>ST表实现的问题 ： 加快 Deep数组的跳跃过程</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">LCA</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> v)</span></span>{</span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">        u在下面    </span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">if</span>(Deep[u] &lt; Deep[v]){</span><br><span class="line">        <span class="type">int</span> t = u;</span><br><span class="line">        u = v;</span><br><span class="line">        v = t;</span><br><span class="line">    }</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = power; i &gt;= <span class="number">0</span>; i--){</span><br><span class="line">        <span class="keyword">if</span>(Deep[ST[u][i]] &gt;= Deep[v]){</span><br><span class="line">            u = ST[u][i];</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(u == v){</span><br><span class="line">        <span class="keyword">return</span> v;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = power; i &gt;= <span class="number">0</span>; i--){</span><br><span class="line">        <span class="keyword">if</span>(ST[u][i] != ST[v][i]){</span><br><span class="line">            u = ST[u][i];</span><br><span class="line">            v = ST[v][i];</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line">    <span class="keyword">return</span> ST[v][<span class="number">0</span>];</span><br><span class="line"></span><br><span class="line">}</span><br></pre></td></tr></table></figure>
<h3 id="树的重心（有一个或者两个）">树的重心（有一个或者两个）</h3>
<p>树的重心的基本定义：</p>
<ul class="lvl-0">
<li class="lvl-2">
<p>最大子树的节点数 足够小</p>
</li>
<li class="lvl-2">
<p>每棵子树的节点数 不超过 总节点数的一半</p>
</li>
<li class="lvl-2">
<p>所有节点 汇聚到 重心的 步数最少</p>
</li>
</ul>
<p>补充性质：</p>
<ul class="lvl-0">
<li class="lvl-2">
<p>一棵树最多有两个重心，两个重心一定相邻</p>
</li>
<li class="lvl-2">
<p>如果树上增加或者删除一个叶节点，重心最多移动一条边</p>
</li>
<li class="lvl-2">
<p>将两棵树连起来，新树的重心一定在两个原来重心的连线上</p>
</li>
<li class="lvl-2">
<p>如果边权为正，所有节点走向重心的 总距离和 最小</p>
</li>
</ul>
<ol>
<li class="lvl-3">
<p>求法一 : 最大子树 足够小</p>
</li>
</ol>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> ans = <span class="number">0</span>, best = INT_MAX;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">  重心：</span></span><br><span class="line"><span class="comment">   以当前节点为 重心，所有子树中 最大数量的子树的 数量足够小</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">dfs</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> f)</span></span>{</span><br><span class="line">    Size[u] = <span class="number">1</span>;</span><br><span class="line">    <span class="type">int</span> mx = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> v = head[u]; v != <span class="number">0</span>; v = edge[v].next){</span><br><span class="line">        <span class="type">int</span> e = edge[v].to;</span><br><span class="line">        <span class="keyword">if</span>(e != f){</span><br><span class="line">            <span class="built_in">dfs</span>(e,u);</span><br><span class="line">            Size[u] += Size[e];</span><br><span class="line">            mx = <span class="built_in">max</span>(mx, Size[e]);</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line">    mx = <span class="built_in">max</span>(mx, n - Size[u]);</span><br><span class="line">    <span class="keyword">if</span>(mx &lt; best || (mx  == best &amp;&amp; u &lt; ans)){</span><br><span class="line">        ans = u;</span><br><span class="line">        mx = best;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">}</span><br></pre></td></tr></table></figure>
<ol>
<li class="lvl-3">
<p>求法二 ：每棵子树的节点数 不超过总节点的一半</p>
</li>
</ol>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> Size[N];</span><br><span class="line">vector&lt;<span class="type">int</span>&gt; ans;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">dfs</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> f)</span></span>{</span><br><span class="line">    Size[u] = <span class="number">1</span>;</span><br><span class="line">    <span class="type">int</span> Mx = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> e = head[u]; e != <span class="number">0</span>; e =edge[e].next){</span><br><span class="line">        <span class="type">int</span> v = edge[e].to;</span><br><span class="line">        <span class="keyword">if</span>(v != f){</span><br><span class="line">            <span class="built_in">dfs</span>(v,u);</span><br><span class="line">            Size[u] += Size[v];</span><br><span class="line">            Mx = <span class="built_in">max</span>(Size[v], Mx);</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line">    Mx = <span class="built_in">max</span>(Mx, n - Size[u]);</span><br><span class="line">    <span class="keyword">if</span>(Mx &lt;= n / <span class="number">2</span>){</span><br><span class="line">        ans.<span class="built_in">push_back</span>(u);</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></table></figure>
<p>扩展： 带 点权的树 如何求重心</p>
<p>仅 修改一个 → Size[u] 的初始值 变成了 点权重 56分以上</p>
<aside>
💡
<p>首先：重心 是与 边权 没有关系的，所谓的点权，可以理解为一个独立的树，树中的节点数量 就是 点的权重</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> Size[N];</span><br><span class="line"><span class="type">int</span> a[N];</span><br><span class="line">vector&lt;<span class="type">int</span>&gt; ans;</span><br><span class="line"><span class="type">int</span> sum; <span class="comment">// sum 是总点权和</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">dfs</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> f)</span></span>{</span><br><span class="line">    Size[u] = a[u];</span><br><span class="line">    <span class="type">int</span> Mx = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> e = head[u]; e != <span class="number">0</span>; e =edge[e].next){</span><br><span class="line">        <span class="type">int</span> v = edge[e].to;</span><br><span class="line">        <span class="keyword">if</span>(v != f){</span><br><span class="line">            <span class="built_in">dfs</span>(v,u);</span><br><span class="line">            Size[u] += Size[v];</span><br><span class="line">            Mx = <span class="built_in">max</span>(Size[v], Mx);</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line">    Mx = <span class="built_in">max</span>(Mx, sum - Size[u]);</span><br><span class="line">    <span class="keyword">if</span>(Mx &lt;= sum / <span class="number">2</span>){</span><br><span class="line">        ans.<span class="built_in">push_back</span>(u);</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></table></figure>
<h3 id="树的直径">树的直径</h3>
<p><strong>树上的最长路径</strong></p>
<ul class="lvl-0">
<li class="lvl-2">
<p>两次 DFS（仅使用没有 负边权）</p>
</li>
</ul>
<aside>
💡能得到路径信息
1. 从根节点 找离根节点最远的点
2. 在从 这个节点找离这个节点最远的点
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">  法一： 两次dfs</span></span><br><span class="line"><span class="comment">  优点：能得到路径信息</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="type">int</span> start, End;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> di[N]; <span class="comment">// 记录从规定节点到 当前节点到距离</span></span><br><span class="line"><span class="type">int</span> la[N]; <span class="comment">// 记录路径</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">dfs</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> f, <span class="type">int</span> w)</span></span>{</span><br><span class="line">      la[u] = f;</span><br><span class="line">      di[u] = di[f] + w;</span><br><span class="line">      <span class="keyword">for</span>(<span class="type">int</span> e = head[u]; e != <span class="number">0</span>; e = ed[e].next){</span><br><span class="line">        <span class="type">int</span> v = ed[e].to;</span><br><span class="line">        <span class="keyword">if</span>(v != f){</span><br><span class="line">            <span class="built_in">dfs</span>(v, u, ed[e].w);</span><br><span class="line">        }</span><br><span class="line">      }</span><br><span class="line">}</span><br><span class="line"><span class="function">pair&lt;<span class="type">int</span>,<span class="type">int</span>&gt; <span class="title">find_road</span><span class="params">(<span class="type">int</span> n)</span></span>{</span><br><span class="line">    <span class="built_in">dfs</span>(<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">    start = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++){</span><br><span class="line">        <span class="keyword">if</span>(di[i] &gt; di[start]){</span><br><span class="line">            start = i;</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line">    <span class="built_in">dfs</span>(start, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">    End = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++){</span><br><span class="line">        <span class="keyword">if</span>(di[i] &gt; di[End]){</span><br><span class="line">           End = i;</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line">    <span class="keyword">return</span> {start, End};</span><br><span class="line">}</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<ul class="lvl-0">
<li class="lvl-2">
<p>树型dp</p>
</li>
</ul>
<aside>
💡
<p>只能得到 直径长度</p>
<p><img src="%E5%B7%A6%E7%A5%9E%E8%AF%BE%E7%A8%8B%E7%AC%94%E8%AE%B0%2017ae0092222580e58afce9620b5d2463/image%201.png" alt="image.png"></p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> Max_dia = INT_MIN;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">dp</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> f)</span></span>{</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> e = head[u];  e != <span class="number">0</span>; e = ed[e].next){</span><br><span class="line">        <span class="type">int</span> v = ed[e].to;</span><br><span class="line">        <span class="keyword">if</span>(v != f){</span><br><span class="line">            <span class="built_in">dp</span>(v, u);</span><br><span class="line">            Max_dia = <span class="built_in">max</span>(Max_dia, dist[u] + dist[v] + ed[e].w);</span><br><span class="line">            dist[u] = <span class="built_in">max</span>(dist[u], dist[v] + ed[e].w);</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></table></figure>
<p>相关结论（边权为正）</p>
<ol>
<li class="lvl-3">
<p>如果有 多条直径，这多条直径一定 有一个 <strong>公共路段</strong></p>
</li>
<li class="lvl-3">
<p>树上任意一点，相隔最远的点的集合，<strong>直径的两端点至少有一个在其中。</strong></p>
</li>
</ol>
<h3 id="树上差分">树上差分</h3>
<ol>
<li class="lvl-3">
<p>点差分</p>
</li>
</ol>
<p><img src="%E5%B7%A6%E7%A5%9E%E8%AF%BE%E7%A8%8B%E7%AC%94%E8%AE%B0%2017ae0092222580e58afce9620b5d2463/image%202.png" alt="image.png"></p>
<aside>
💡
<p><strong>1.计算公式</strong> （子节点的 变化 会<strong>向上传递</strong>)</p>
<p>(x → y) + v</p>
<pre><code>x += v

y += v
</code></pre>
<p>LCA -= v</p>
<p>LCA_father -= v</p>
<p><strong>2.合并</strong></p>
<p>num[i] += num[所有孩子]</p>
</aside>
<ol>
<li class="lvl-3">
<p>边差分</p>
</li>
</ol>
<p><img src="%E5%B7%A6%E7%A5%9E%E8%AF%BE%E7%A8%8B%E7%AC%94%E8%AE%B0%2017ae0092222580e58afce9620b5d2463/image%203.png" alt="image.png"></p>
<aside>
💡
<ol>
<li class="lvl-3">
<p>计算公式</p>
</li>
</ol>
<p>点权变化:</p>
<pre><code>   (x → y) + v

    x += v

    y += v

    LCA -=  2*v
</code></pre>
<ol start="2">
<li class="lvl-6">
<p>更新权重</p>
</li>
</ol>
<p>num[ i → j 边] += weight[ j ]（点权）</p>
<p>weight[ i ] += weight[ 所有子节点 ]</p>
<h2 id="树状数组（视频）">树状数组（视频）</h2>
<p>树状数组 是 处理区间查询 的方法。</p>
<ul class="lvl-0">
<li class="lvl-2">
<p>一般处理 <strong>可差分信息 （总体 是 由部分构成的）| 下标一定从 1 开始</strong></p>
</li>
<li class="lvl-2">
<p>怎么得到 最右边的 1 → i &amp; -i</p>
</li>
</ul>
<p><strong>常见有以下四种查询类型</strong></p>
<ul class="lvl-0">
<li class="lvl-2">
<p>单点增加 + 范围查询</p>
</li>
</ul>
<p>管理范围                                                     (去除最右边的 1（ lowbit(i) ） + 1， 自己)</p>
<p><img src="%E5%B7%A6%E7%A5%9E%E8%AF%BE%E7%A8%8B%E7%AC%94%E8%AE%B0%2017ae0092222580e58afce9620b5d2463/image%204.png" alt="image.png"></p>
<aside>
💡
<p>输入的时候 tree数组 用add 方法进行添加</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> tree[N];</span><br><span class="line"><span class="comment">// 单点增加  区间查询</span></span><br><span class="line"><span class="type">int</span> n; <span class="comment">//数组长度</span></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">lowbit</span><span class="params">(<span class="type">int</span> i)</span></span>{</span><br><span class="line">    <span class="comment">// 取最右边的 1</span></span><br><span class="line">    <span class="keyword">return</span> i &amp; -i;</span><br><span class="line">}</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">add</span><span class="params">(<span class="type">int</span> i, <span class="type">int</span> w)</span></span>{</span><br><span class="line">     <span class="comment">// 下标 + 最右边的 1 的地方 + w</span></span><br><span class="line">     <span class="keyword">while</span>(i &lt;= n){</span><br><span class="line">        tree[i] += w;</span><br><span class="line">        i += <span class="built_in">lowbit</span>(i);</span><br><span class="line">     }</span><br><span class="line">}</span><br><span class="line"><span class="comment">// 1 -- r 的范围和</span></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">sum</span><span class="params">(<span class="type">int</span> r)</span></span>{</span><br><span class="line">    <span class="comment">// sum = tree[x] 自己 然后不断去除最右边的 1</span></span><br><span class="line">    <span class="type">int</span> ans = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(r &gt; <span class="number">0</span>){</span><br><span class="line">        ans += tree[r];</span><br><span class="line">        r -= <span class="built_in">lowbit</span>(r);</span><br><span class="line">    }               </span><br><span class="line">    <span class="keyword">return</span> ans;                                                              </span><br><span class="line">}</span><br></pre></td></tr></table></figure>
<ul class="lvl-0">
<li class="lvl-2">
<p>范围增加 + 单点查询 （改成差分数组）</p>
</li>
</ul>
<aside>
💡
<p>原数组 a[i] = sum(delat[1] + …+ delat[i])</p>
<p>delat[i] = a[i] - a[i - 1]</p>
<p>差分数组 可以 实现 原数组的 区间增减</p>
<p>delat[l] + w, delat[r + 1] - w.</p>
<blockquote>
<p>构建 tree数组的时候, add_sum( i , w);</p>
</blockquote>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> tree[N];</span><br><span class="line"><span class="comment">// 单点增加  区间查询</span></span><br><span class="line"><span class="type">int</span> n; <span class="comment">//数组长度</span></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">lowbit</span><span class="params">(<span class="type">int</span> i)</span></span>{</span><br><span class="line">    <span class="comment">// 取最右边的 1</span></span><br><span class="line">    <span class="keyword">return</span> i &amp; -i;</span><br><span class="line">}</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">add</span><span class="params">(<span class="type">int</span> i, <span class="type">int</span> w)</span></span>{</span><br><span class="line">     <span class="comment">// 下标 + 最右边的 1 的地方 + w</span></span><br><span class="line">     <span class="keyword">while</span>(i &lt;= n){</span><br><span class="line">        tree[i] += w;</span><br><span class="line">        i += <span class="built_in">lowbit</span>(i);</span><br><span class="line">     }</span><br><span class="line">}</span><br><span class="line"><span class="comment">// 查询 r 位置的值</span></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">sum</span><span class="params">(<span class="type">int</span> r)</span></span>{</span><br><span class="line">    <span class="comment">// sum = tree[x] 自己 然后不断去除最右边的 1</span></span><br><span class="line">    <span class="type">int</span> ans = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(r &gt; <span class="number">0</span>){</span><br><span class="line">        ans += tree[r];</span><br><span class="line">        r -= <span class="built_in">lowbit</span>(r);</span><br><span class="line">    }               </span><br><span class="line">    <span class="keyword">return</span> ans;                                                              </span><br><span class="line">}</span><br><span class="line"><span class="comment">// 增加 l -&gt; r 的值</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">add_sum</span><span class="params">(<span class="type">int</span> l, <span class="type">int</span> r)</span></span></span><br><span class="line"><span class="function"></span>{</span><br><span class="line">  <span class="built_in">add</span>(l, w),<span class="built_in">add</span>(r + <span class="number">1</span>, -w);</span><br><span class="line">}</span><br></pre></td></tr></table></figure>
<ul class="lvl-0">
<li class="lvl-2">
<p>范围增加 + 范围查询</p>
</li>
</ul>
<aside>
💡
<p>sum(1 → r)</p>
<p>= r * Sum( delat[1 → r] ) - sum(1 → r)[(i - 1) * delat[i] ]\</p>
<h3 id="维护-两个差分数组-Di-（i-1-Di">维护 两个差分数组 Di  +  （i - 1) * Di</h3>
<p><img src="%E5%B7%A6%E7%A5%9E%E8%AF%BE%E7%A8%8B%E7%AC%94%E8%AE%B0%2017ae0092222580e58afce9620b5d2463/image%205.png" alt="image.png"></p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">1e5</span> + <span class="number">10</span>;</span><br><span class="line"><span class="comment">// Di</span></span><br><span class="line"><span class="type">int</span> tree1[N];</span><br><span class="line"><span class="comment">// (i - 1) * Di</span></span><br><span class="line"><span class="type">int</span> tree2[N];</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> n;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">lowbit</span><span class="params">(<span class="type">int</span> i)</span></span>{</span><br><span class="line">    <span class="keyword">return</span> i &amp; -i;</span><br><span class="line">}</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">add</span><span class="params">(<span class="type">int</span> i, <span class="type">int</span> w)</span></span>{</span><br><span class="line">    <span class="type">int</span> t = i;</span><br><span class="line">    <span class="keyword">while</span>(t &lt;= n){</span><br><span class="line">        tree1[t] += w;</span><br><span class="line">        t += <span class="built_in">lowbit</span>(t);</span><br><span class="line">    }</span><br><span class="line">    t = i;</span><br><span class="line">    <span class="type">int</span> W = (i - <span class="number">1</span>) * w;</span><br><span class="line">    <span class="keyword">while</span>(t &lt;= n){</span><br><span class="line">        tree2[t] += W;</span><br><span class="line">        t += <span class="built_in">lowbit</span>(t);</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">Add</span><span class="params">(<span class="type">int</span> l, <span class="type">int</span> r, <span class="type">int</span> w)</span></span>{</span><br><span class="line">    <span class="built_in">add</span>(l, w); <span class="built_in">add</span>(r + <span class="number">1</span>, -w);</span><br><span class="line">}</span><br><span class="line"><span class="comment">// 1 -&gt; i 的和</span></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">sum</span><span class="params">(<span class="type">int</span> i)</span></span>{</span><br><span class="line">    <span class="type">int</span> ans = <span class="number">0</span>, t = i;</span><br><span class="line">    <span class="keyword">while</span>(t &gt; <span class="number">0</span>){</span><br><span class="line">        ans += (tree1[t] * i);</span><br><span class="line">        ans -= tree2[t];</span><br><span class="line">        t = t - <span class="built_in">lowbit</span>(t);</span><br><span class="line">    }  </span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">}</span><br></pre></td></tr></table></figure>
<ul class="lvl-0">
<li class="lvl-2">
<p>二维的单点增加 + 范围查询</p>
</li>
</ul>
<p>要从 1 1开始</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">1e3</span> + <span class="number">10</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> M = <span class="number">1e3</span> + <span class="number">10</span>;</span><br><span class="line"><span class="type">int</span> tree[N][M];</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> n, m;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">lowbit</span><span class="params">(<span class="type">int</span> i)</span></span>{</span><br><span class="line">    <span class="keyword">return</span> i &amp; -i;</span><br><span class="line">}</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">add</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> y, <span class="type">int</span> w)</span></span>{</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = x; i += <span class="built_in">lowbit</span>(i); i &lt;= n){</span><br><span class="line">       <span class="keyword">for</span>(<span class="type">int</span> j = y; j += <span class="built_in">lowbit</span>(j); j &lt;= m){</span><br><span class="line">        tree[i][j] += w;</span><br><span class="line">       }</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"><span class="comment">// 1 -&gt; x 1 -&gt; y</span></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">sum</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> y)</span></span>{</span><br><span class="line">     <span class="type">int</span> ans = <span class="number">0</span>;</span><br><span class="line">     <span class="keyword">for</span>(<span class="type">int</span> i = x; i &gt; <span class="number">0</span>; i -= <span class="built_in">lowbit</span>(i)){</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> j = y; j &gt; <span class="number">0</span>; j-= <span class="built_in">lowbit</span>(j)){</span><br><span class="line">            ans += tree[i][j];</span><br><span class="line">        }</span><br><span class="line">     }</span><br><span class="line">     <span class="keyword">return</span> ans;</span><br><span class="line">}</span><br></pre></td></tr></table></figure>
<ul class="lvl-0">
<li class="lvl-2">
<p>二维数组的 范围增加 + 范围查询</p>
</li>
</ul>
<aside>
💡
<p>delat[i] = a[i][j] - a[i-1][j] - a[i][j-1] + a[i-1][j-1]</p>
<p>a[i][j] =  (1, 1) → (i, j) 的 delat 累加和</p>
</aside>
<p><img src="%E5%B7%A6%E7%A5%9E%E8%AF%BE%E7%A8%8B%E7%AC%94%E8%AE%B0%2017ae0092222580e58afce9620b5d2463/image%206.png" alt="image.png"></p>
<h3 id="逆序队问题">逆序队问题</h3>
<h2 id="线段树">线段树</h2>
<p>基本线段树</p>
<h1>动态规划（先做题目）</h1>
<h2 id="背包dp-（66-75）">背包dp （66 - 75）</h2>
<h2 id="区间dp">区间dp</h2>
<p>将大范围 划分为 若干个 小范围 的问题</p>
<aside>
💡
<p>可能性展开：</p>
<p>基于 <strong>两侧端点</strong> 讨论</p>
<p>基于 <strong>范围划分</strong> 讨论</p>
<h2 id="状态dp">状态dp</h2>
<p>利用 二进制 的 0 1 来表示 节点 状态</p>
<h2 id="树型dp">树型dp</h2>
<p>将 子树的 信息 返回给父亲</p>
<aside>
💡
<p>父亲节点的 ans <strong>依赖于 子树的信息</strong></p>
</aside>
<h2 id="数位dp">数位dp</h2>
<p>判断 <strong>数字的 可能性</strong></p>
<aside>
💡
<p>大部分都是 从左 向 右 进行尝试（线性展开）</p>
<h2 id="换根dp">换根dp</h2>
<p>将 根节点 互换，要求值的变化</p>
<h2 id="轮廓线dp">轮廓线dp</h2>
<h2 id="三进制状压dp">三进制状压dp</h2>
<h2 id="dp优化">dp优化</h2>
<h1>字符串</h1>
<h2 id="KMP">KMP</h2>
<p><strong>前缀函数</strong></p>
<aside>
💡
<p>NEXT 函数构建</p>
<pre><code> 前后缀 匹配长度
</code></pre>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> Next[N];</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">get_next</span><span class="params">(string s)</span></span>{</span><br><span class="line">    Next[<span class="number">0</span>] = <span class="number">-1</span>;</span><br><span class="line">    Next[<span class="number">1</span>] = <span class="number">0</span>;</span><br><span class="line">    <span class="type">int</span> i = <span class="number">2</span>, cn = <span class="number">0</span>;</span><br><span class="line">    <span class="comment">// Next[i] 表示的是 1 - i-1 的最长前后缀匹配长度</span></span><br><span class="line">    <span class="keyword">while</span>(i &lt; s.<span class="built_in">size</span>()){</span><br><span class="line">        <span class="keyword">if</span>(s[i - <span class="number">1</span>] == s[cn]){</span><br><span class="line">            Next[i++] = ++cn;</span><br><span class="line">        }<span class="keyword">else</span> <span class="keyword">if</span>(cn &gt; <span class="number">0</span>){</span><br><span class="line">            cn = Next[cn];</span><br><span class="line">        }<span class="keyword">else</span>{</span><br><span class="line">            Next[i++] = <span class="number">0</span>;</span><br><span class="line">        }</span><br><span class="line">    } </span><br><span class="line">}</span><br></pre></td></tr></table></figure>
<aside>
💡
<p>KMP 是依靠这个 前缀函数来实现的</p>
<p>如果当前 的字符不匹配</p>
<p>需要检测的 字符，根据 NEXT 数组 向前跳转</p>
<h3 id="扩展-KMP-（Z数组）前缀匹配问题">扩展 KMP （Z数组）前缀匹配问题</h3>
<p>动态图展示 🔗：<a target="_blank" rel="noopener" href="https://personal.utdallas.edu/~besp/demo/John2010/z-algorithm.htm">https://personal.utdallas.edu/~besp/demo/John2010/z-algorithm.htm</a></p>
<aside>
💡
<p><strong>Z[i] 表示 s[0 - n-1] 和 s[i - n-1] 的最长匹配长度</strong></p>
<p>线性加速过程：</p>
<pre><code>   如果在最右的最长前缀匹配区间中，会加速前缀加速匹配过程
</code></pre>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">2e6</span> + <span class="number">10</span>;</span><br><span class="line"><span class="type">int</span> z[N];</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">Z</span><span class="params">(string s)</span></span>{</span><br><span class="line">     z[<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line">     <span class="type">int</span> n = s.<span class="built_in">size</span>();</span><br><span class="line">     <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>, r = <span class="number">0</span>, l = <span class="number">0</span>; i &lt; n;i++){</span><br><span class="line">         <span class="keyword">if</span>(i &lt;= r &amp;&amp; z[i - l] &lt; r - i + <span class="number">1</span>){</span><br><span class="line">            z[i] = z[i - l];</span><br><span class="line">         }<span class="keyword">else</span>{</span><br><span class="line">            z[i] = <span class="built_in">max</span>(<span class="number">0</span>, r - i + <span class="number">1</span>);</span><br><span class="line">            <span class="keyword">while</span>(i + z[i] &lt; n &amp;&amp; s[z[i]] == s[i + z[i]]) z[i]++;</span><br><span class="line">            <span class="keyword">if</span>(i + z[i] - <span class="number">1</span> &gt; r){</span><br><span class="line">                r = i + z[i] - <span class="number">1</span>;</span><br><span class="line">                l = i;</span><br><span class="line">            }</span><br><span class="line">     }</span><br><span class="line">     }</span><br><span class="line">}</span><br></pre></td></tr></table></figure>
<h2 id="Manacher">Manacher</h2>
<aside>
💡
<p><strong>P[i] 数组是保留了更新的数组的回文串长度</strong></p>
<p><strong># a # a # a #          总长度 为 2 * n + 1</strong></p>
<p><strong>1 2 3 4 3 2 1</strong></p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">3e7</span>;</span><br><span class="line"><span class="type">int</span> p[N];</span><br><span class="line"><span class="type">int</span> Max = <span class="number">0</span>;</span><br><span class="line"><span class="function">string <span class="title">c</span><span class="params">(string s)</span></span>{</span><br><span class="line">    string s1 = <span class="string">"#"</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">auto</span> x : s){</span><br><span class="line">       s1 += x;</span><br><span class="line">       s1 += <span class="string">'#'</span>;</span><br><span class="line">    }</span><br><span class="line">    <span class="keyword">return</span> s1;</span><br><span class="line">}</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">manacher</span><span class="params">(string s)</span></span>{</span><br><span class="line">     <span class="type">int</span> n = s.<span class="built_in">length</span>();</span><br><span class="line">     <span class="type">int</span> c = <span class="number">0</span>, r = <span class="number">0</span>;</span><br><span class="line">     <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>, len; i &lt; n; i++){</span><br><span class="line">        len = r &gt; i ? <span class="built_in">min</span>(p[<span class="number">2</span> * c - i], r - i) : <span class="number">1</span>; <span class="comment">// 至少的回文半径区域</span></span><br><span class="line">        <span class="keyword">while</span>(i  + len &lt; n &amp;&amp; i - len &gt;= <span class="number">0</span> &amp;&amp; s[i + len] == s[i - len] ){</span><br><span class="line">            len ++;</span><br><span class="line">        }</span><br><span class="line">        <span class="keyword">if</span>(i + len &gt; r){</span><br><span class="line">            c = i;</span><br><span class="line">            r = i + len;</span><br><span class="line">        }</span><br><span class="line">        Max = <span class="built_in">max</span>(Max, len);</span><br><span class="line">         p[i] = len;</span><br><span class="line">     }</span><br><span class="line">}</span><br></pre></td></tr></table></figure>
<h2 id="AC自动机">AC自动机</h2>
<h2 id="字符串哈希">字符串哈希</h2>
<h1>数学</h1>
<h2 id="埃式筛">埃式筛</h2>
<aside>
💡
<p>如果这个 元素 没有访问过，便是质数，并且 <strong>这个质数的所有倍数的值 就不是质数</strong></p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">ehrlich</span><span class="params">(<span class="type">int</span> n)</span></span>{</span><br><span class="line">    <span class="function">vector&lt;<span class="type">bool</span>&gt; <span class="title">vis</span><span class="params">(n + <span class="number">1</span>, <span class="literal">false</span>)</span></span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">2</span>; i * i &lt;= n; i++){</span><br><span class="line">        <span class="keyword">if</span>(!vis[i]){</span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> j = i * i; j &lt;= n; j +=i){</span><br><span class="line">                vis[j] = <span class="literal">true</span>;</span><br><span class="line">            }</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line">    </span><br><span class="line">    <span class="type">int</span> cnt = <span class="number">0</span>; <span class="comment">// 质数 记数 vis 未访问过的 便是质数字</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++){</span><br><span class="line">        <span class="keyword">if</span>(!vis[i]){</span><br><span class="line">            cnt ++;</span><br><span class="line">            cout &lt;&lt; i &lt;&lt; <span class="string">" "</span>;</span><br><span class="line">        }</span><br><span class="line">    }cout &lt;&lt; endl;</span><br><span class="line">    }</span><br></pre></td></tr></table></figure>
<h2 id="乘法逆元">乘法逆元</h2>
<p><mjx-container class="MathJax" jax="SVG" display="true"><svg style="vertical-align: -1.577ex;" xmlns="http://www.w3.org/2000/svg" width="18.415ex" height="4.613ex" role="img" focusable="false" viewBox="0 -1342 8139.6 2039"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><text data-variant="normal" transform="scale(1,-1)" font-size="884px" font-family="serif">逆</text></g><g data-mml-node="mi" transform="translate(1000,0)"><text data-variant="normal" transform="scale(1,-1)" font-size="884px" font-family="serif">元</text></g><g data-mml-node="mi" transform="translate(2000,0)"><text data-variant="normal" transform="scale(1,-1)" font-size="884px" font-family="serif">含</text></g><g data-mml-node="mi" transform="translate(3000,0)"><text data-variant="normal" transform="scale(1,-1)" font-size="884px" font-family="serif">义</text></g><g data-mml-node="mi" transform="translate(4000,0)"><text data-variant="italic" transform="scale(1,-1)" font-size="884px" font-family="serif" font-style="italic">：</text></g><g data-mml-node="mi" transform="translate(5000,0)"><path data-c="1D465" d="M52 289Q59 331 106 386T222 442Q257 442 286 424T329 379Q371 442 430 442Q467 442 494 420T522 361Q522 332 508 314T481 292T458 288Q439 288 427 299T415 328Q415 374 465 391Q454 404 425 404Q412 404 406 402Q368 386 350 336Q290 115 290 78Q290 50 306 38T341 26Q378 26 414 59T463 140Q466 150 469 151T485 153H489Q504 153 504 145Q504 144 502 134Q486 77 440 33T333 -11Q263 -11 227 52Q186 -10 133 -10H127Q78 -10 57 16T35 71Q35 103 54 123T99 143Q142 143 142 101Q142 81 130 66T107 46T94 41L91 40Q91 39 97 36T113 29T132 26Q168 26 194 71Q203 87 217 139T245 247T261 313Q266 340 266 352Q266 380 251 392T217 404Q177 404 142 372T93 290Q91 281 88 280T72 278H58Q52 284 52 289Z"></path></g><g data-mml-node="mo" transform="translate(5849.8,0)"><path data-c="2192" d="M56 237T56 250T70 270H835Q719 357 692 493Q692 494 692 496T691 499Q691 511 708 511H711Q720 511 723 510T729 506T732 497T735 481T743 456Q765 389 816 336T935 261Q944 258 944 250Q944 244 939 241T915 231T877 212Q836 186 806 152T761 85T740 35T732 4Q730 -6 727 -8T711 -11Q691 -11 691 0Q691 7 696 25Q728 151 835 230H70Q56 237 56 250Z"></path></g><g data-mml-node="mfrac" transform="translate(7127.6,0)"><g data-mml-node="mn" transform="translate(256,676)"><path data-c="31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path></g><g data-mml-node="mi" transform="translate(220,-686)"><path data-c="1D465" d="M52 289Q59 331 106 386T222 442Q257 442 286 424T329 379Q371 442 430 442Q467 442 494 420T522 361Q522 332 508 314T481 292T458 288Q439 288 427 299T415 328Q415 374 465 391Q454 404 425 404Q412 404 406 402Q368 386 350 336Q290 115 290 78Q290 50 306 38T341 26Q378 26 414 59T463 140Q466 150 469 151T485 153H489Q504 153 504 145Q504 144 502 134Q486 77 440 33T333 -11Q263 -11 227 52Q186 -10 133 -10H127Q78 -10 57 16T35 71Q35 103 54 123T99 143Q142 143 142 101Q142 81 130 66T107 46T94 41L91 40Q91 39 97 36T113 29T132 26Q168 26 194 71Q203 87 217 139T245 247T261 313Q266 340 266 352Q266 380 251 392T217 404Q177 404 142 372T93 290Q91 281 88 280T72 278H58Q52 284 52 289Z"></path></g><rect width="772" height="60" x="120" y="220"></rect></g></g></g></svg></mjx-container></p>
<p><strong>法一 ：扩展欧几里得 求逆元</strong></p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="type">long</span> <span class="type">long</span> LL;</span><br><span class="line"><span class="function">LL <span class="title">ExGCD</span><span class="params">(LL a, LL mod, LL &amp;x, LL &amp;y)</span></span>{</span><br><span class="line">    <span class="keyword">if</span>(mod == <span class="number">0</span>){</span><br><span class="line">        x = <span class="number">1</span>; y = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">return</span> a;</span><br><span class="line">    }</span><br><span class="line">    LL d = <span class="built_in">ExGCD</span>(mod, a % mod, x, y), t = x;</span><br><span class="line">    x = y; y = t - a / mod * x;</span><br><span class="line">    <span class="keyword">return</span> d;</span><br><span class="line">}</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">ExGcdInv</span><span class="params">(<span class="type">int</span> a, <span class="type">int</span> mod)</span></span>{</span><br><span class="line">    LL x, y;</span><br><span class="line">    <span class="built_in">ExGCD</span>(a, mod, x, y);</span><br><span class="line">    <span class="keyword">return</span> (x + mod) % mod;</span><br><span class="line">}</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p><strong>法二 ： 快速幂 求逆元</strong></p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">LL <span class="title">fastpow</span><span class="params">(<span class="type">int</span> a, <span class="type">int</span> b, <span class="type">int</span> mod)</span></span>{</span><br><span class="line">    LL ret = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span>(b){</span><br><span class="line">        <span class="keyword">if</span>(b &amp; <span class="number">1</span>) ret = ret * a % mod;</span><br><span class="line">        a = a * a % mod;</span><br><span class="line">        b &gt;&gt;= <span class="number">1</span>; </span><br><span class="line">    }</span><br><span class="line">    <span class="keyword">return</span> ret;</span><br><span class="line">}</span><br><span class="line"><span class="function">LL <span class="title">FermatInv</span><span class="params">(<span class="type">int</span> a, <span class="type">int</span> mod)</span></span>{</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">fastpow</span>(a, mod - <span class="number">2</span>, mod);</span><br><span class="line">}</span><br></pre></td></tr></table></figure>
<p><strong>法三 ： 费马小递推 求逆元</strong></p>
<p><mjx-container class="MathJax" jax="SVG" display="true"><svg style="vertical-align: -0.566ex;" xmlns="http://www.w3.org/2000/svg" width="37.267ex" height="2.262ex" role="img" focusable="false" viewBox="0 -750 16471.9 1000"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mtext"><path data-c="69" d="M69 609Q69 637 87 653T131 669Q154 667 171 652T188 609Q188 579 171 564T129 549Q104 549 87 564T69 609ZM247 0Q232 3 143 3Q132 3 106 3T56 1L34 0H26V46H42Q70 46 91 49Q100 53 102 60T104 102V205V293Q104 345 102 359T88 378Q74 385 41 385H30V408Q30 431 32 431L42 432Q52 433 70 434T106 436Q123 437 142 438T171 441T182 442H185V62Q190 52 197 50T232 46H255V0H247Z"></path><path data-c="6E" d="M41 46H55Q94 46 102 60V68Q102 77 102 91T102 122T103 161T103 203Q103 234 103 269T102 328V351Q99 370 88 376T43 385H25V408Q25 431 27 431L37 432Q47 433 65 434T102 436Q119 437 138 438T167 441T178 442H181V402Q181 364 182 364T187 369T199 384T218 402T247 421T285 437Q305 442 336 442Q450 438 463 329Q464 322 464 190V104Q464 66 466 59T477 49Q498 46 526 46H542V0H534L510 1Q487 2 460 2T422 3Q319 3 310 0H302V46H318Q379 46 379 62Q380 64 380 200Q379 335 378 343Q372 371 358 385T334 402T308 404Q263 404 229 370Q202 343 195 315T187 232V168V108Q187 78 188 68T191 55T200 49Q221 46 249 46H265V0H257L234 1Q210 2 183 2T145 3Q42 3 33 0H25V46H41Z" transform="translate(278,0)"></path><path data-c="76" d="M338 431Q344 429 422 429Q479 429 503 431H508V385H497Q439 381 423 345Q421 341 356 172T288 -2Q283 -11 263 -11Q244 -11 239 -2Q99 359 98 364Q93 378 82 381T43 385H19V431H25L33 430Q41 430 53 430T79 430T104 429T122 428Q217 428 232 431H240V385H226Q187 384 184 370Q184 366 235 234L286 102L377 341V349Q377 363 367 372T349 383T335 385H331V431H338Z" transform="translate(834,0)"></path></g><g data-mml-node="mo" transform="translate(1362,0)"><path data-c="5B" d="M118 -250V750H255V710H158V-210H255V-250H118Z"></path></g><g data-mml-node="mi" transform="translate(1640,0)"><path data-c="1D456" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z"></path></g><g data-mml-node="mo" transform="translate(1985,0)"><path data-c="5D" d="M22 710V750H159V-250H22V-210H119V710H22Z"></path></g><g data-mml-node="mo" transform="translate(2540.8,0)"><path data-c="3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path></g><g data-mml-node="mo" transform="translate(3596.6,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path></g><g data-mml-node="mtext" transform="translate(3985.6,0)"><path data-c="6D" d="M41 46H55Q94 46 102 60V68Q102 77 102 91T102 122T103 161T103 203Q103 234 103 269T102 328V351Q99 370 88 376T43 385H25V408Q25 431 27 431L37 432Q47 433 65 434T102 436Q119 437 138 438T167 441T178 442H181V402Q181 364 182 364T187 369T199 384T218 402T247 421T285 437Q305 442 336 442Q351 442 364 440T387 434T406 426T421 417T432 406T441 395T448 384T452 374T455 366L457 361L460 365Q463 369 466 373T475 384T488 397T503 410T523 422T546 432T572 439T603 442Q729 442 740 329Q741 322 741 190V104Q741 66 743 59T754 49Q775 46 803 46H819V0H811L788 1Q764 2 737 2T699 3Q596 3 587 0H579V46H595Q656 46 656 62Q657 64 657 200Q656 335 655 343Q649 371 635 385T611 402T585 404Q540 404 506 370Q479 343 472 315T464 232V168V108Q464 78 465 68T468 55T477 49Q498 46 526 46H542V0H534L510 1Q487 2 460 2T422 3Q319 3 310 0H302V46H318Q379 46 379 62Q380 64 380 200Q379 335 378 343Q372 371 358 385T334 402T308 404Q263 404 229 370Q202 343 195 315T187 232V168V108Q187 78 188 68T191 55T200 49Q221 46 249 46H265V0H257L234 1Q210 2 183 2T145 3Q42 3 33 0H25V46H41Z"></path><path data-c="6F" d="M28 214Q28 309 93 378T250 448Q340 448 405 380T471 215Q471 120 407 55T250 -10Q153 -10 91 57T28 214ZM250 30Q372 30 372 193V225V250Q372 272 371 288T364 326T348 362T317 390T268 410Q263 411 252 411Q222 411 195 399Q152 377 139 338T126 246V226Q126 130 145 91Q177 30 250 30Z" transform="translate(833,0)"></path><path data-c="64" d="M376 495Q376 511 376 535T377 568Q377 613 367 624T316 637H298V660Q298 683 300 683L310 684Q320 685 339 686T376 688Q393 689 413 690T443 693T454 694H457V390Q457 84 458 81Q461 61 472 55T517 46H535V0Q533 0 459 -5T380 -11H373V44L365 37Q307 -11 235 -11Q158 -11 96 50T34 215Q34 315 97 378T244 442Q319 442 376 393V495ZM373 342Q328 405 260 405Q211 405 173 369Q146 341 139 305T131 211Q131 155 138 120T173 59Q203 26 251 26Q322 26 373 103V342Z" transform="translate(1333,0)"></path></g><g data-mml-node="mo" transform="translate(6096.8,0)"><path data-c="2212" d="M84 237T84 250T98 270H679Q694 262 694 250T679 230H98Q84 237 84 250Z"></path></g><g data-mml-node="mo" transform="translate(7097,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path></g><g data-mml-node="mtext" transform="translate(7486,0)"><path data-c="6D" d="M41 46H55Q94 46 102 60V68Q102 77 102 91T102 122T103 161T103 203Q103 234 103 269T102 328V351Q99 370 88 376T43 385H25V408Q25 431 27 431L37 432Q47 433 65 434T102 436Q119 437 138 438T167 441T178 442H181V402Q181 364 182 364T187 369T199 384T218 402T247 421T285 437Q305 442 336 442Q351 442 364 440T387 434T406 426T421 417T432 406T441 395T448 384T452 374T455 366L457 361L460 365Q463 369 466 373T475 384T488 397T503 410T523 422T546 432T572 439T603 442Q729 442 740 329Q741 322 741 190V104Q741 66 743 59T754 49Q775 46 803 46H819V0H811L788 1Q764 2 737 2T699 3Q596 3 587 0H579V46H595Q656 46 656 62Q657 64 657 200Q656 335 655 343Q649 371 635 385T611 402T585 404Q540 404 506 370Q479 343 472 315T464 232V168V108Q464 78 465 68T468 55T477 49Q498 46 526 46H542V0H534L510 1Q487 2 460 2T422 3Q319 3 310 0H302V46H318Q379 46 379 62Q380 64 380 200Q379 335 378 343Q372 371 358 385T334 402T308 404Q263 404 229 370Q202 343 195 315T187 232V168V108Q187 78 188 68T191 55T200 49Q221 46 249 46H265V0H257L234 1Q210 2 183 2T145 3Q42 3 33 0H25V46H41Z"></path><path data-c="6F" d="M28 214Q28 309 93 378T250 448Q340 448 405 380T471 215Q471 120 407 55T250 -10Q153 -10 91 57T28 214ZM250 30Q372 30 372 193V225V250Q372 272 371 288T364 326T348 362T317 390T268 410Q263 411 252 411Q222 411 195 399Q152 377 139 338T126 246V226Q126 130 145 91Q177 30 250 30Z" transform="translate(833,0)"></path><path data-c="64" d="M376 495Q376 511 376 535T377 568Q377 613 367 624T316 637H298V660Q298 683 300 683L310 684Q320 685 339 686T376 688Q393 689 413 690T443 693T454 694H457V390Q457 84 458 81Q461 61 472 55T517 46H535V0Q533 0 459 -5T380 -11H373V44L365 37Q307 -11 235 -11Q158 -11 96 50T34 215Q34 315 97 378T244 442Q319 442 376 393V495ZM373 342Q328 405 260 405Q211 405 173 369Q146 341 139 305T131 211Q131 155 138 120T173 59Q203 26 251 26Q322 26 373 103V342Z" transform="translate(1333,0)"></path></g><g data-mml-node="mo" transform="translate(9597.2,0)"><path data-c="F7" d="M318 466Q318 500 339 518T386 537Q418 537 438 517T458 466Q458 438 440 417T388 396Q355 396 337 417T318 466ZM56 237T56 250T70 270H706Q721 262 721 250T706 230H70Q56 237 56 250ZM318 34Q318 68 339 86T386 105Q418 105 438 85T458 34Q458 6 440 -15T388 -36Q355 -36 337 -15T318 34Z"></path></g><g data-mml-node="mi" transform="translate(10597.4,0)"><path data-c="1D456" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z"></path></g><g data-mml-node="mo" transform="translate(10942.4,0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path></g><g data-mml-node="mo" transform="translate(11331.4,0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path></g><g data-mml-node="mo" transform="translate(11942.7,0)"><path data-c="D7" d="M630 29Q630 9 609 9Q604 9 587 25T493 118L389 222L284 117Q178 13 175 11Q171 9 168 9Q160 9 154 15T147 29Q147 36 161 51T255 146L359 250L255 354Q174 435 161 449T147 471Q147 480 153 485T168 490Q173 490 175 489Q178 487 284 383L389 278L493 382Q570 459 587 475T609 491Q630 491 630 471Q630 464 620 453T522 355L418 250L522 145Q606 61 618 48T630 29Z"></path></g><g data-mml-node="mtext" transform="translate(12942.9,0)"><path data-c="69" d="M69 609Q69 637 87 653T131 669Q154 667 171 652T188 609Q188 579 171 564T129 549Q104 549 87 564T69 609ZM247 0Q232 3 143 3Q132 3 106 3T56 1L34 0H26V46H42Q70 46 91 49Q100 53 102 60T104 102V205V293Q104 345 102 359T88 378Q74 385 41 385H30V408Q30 431 32 431L42 432Q52 433 70 434T106 436Q123 437 142 438T171 441T182 442H185V62Q190 52 197 50T232 46H255V0H247Z"></path><path data-c="6E" d="M41 46H55Q94 46 102 60V68Q102 77 102 91T102 122T103 161T103 203Q103 234 103 269T102 328V351Q99 370 88 376T43 385H25V408Q25 431 27 431L37 432Q47 433 65 434T102 436Q119 437 138 438T167 441T178 442H181V402Q181 364 182 364T187 369T199 384T218 402T247 421T285 437Q305 442 336 442Q450 438 463 329Q464 322 464 190V104Q464 66 466 59T477 49Q498 46 526 46H542V0H534L510 1Q487 2 460 2T422 3Q319 3 310 0H302V46H318Q379 46 379 62Q380 64 380 200Q379 335 378 343Q372 371 358 385T334 402T308 404Q263 404 229 370Q202 343 195 315T187 232V168V108Q187 78 188 68T191 55T200 49Q221 46 249 46H265V0H257L234 1Q210 2 183 2T145 3Q42 3 33 0H25V46H41Z" transform="translate(278,0)"></path><path data-c="76" d="M338 431Q344 429 422 429Q479 429 503 431H508V385H497Q439 381 423 345Q421 341 356 172T288 -2Q283 -11 263 -11Q244 -11 239 -2Q99 359 98 364Q93 378 82 381T43 385H19V431H25L33 430Q41 430 53 430T79 430T104 429T122 428Q217 428 232 431H240V385H226Q187 384 184 370Q184 366 235 234L286 102L377 341V349Q377 363 367 372T349 383T335 385H331V431H338Z" transform="translate(834,0)"></path></g><g data-mml-node="mo" transform="translate(14304.9,0)"><path data-c="5B" d="M118 -250V750H255V710H158V-210H255V-250H118Z"></path></g><g data-mml-node="mtext" transform="translate(14582.9,0)"><path data-c="6D" d="M41 46H55Q94 46 102 60V68Q102 77 102 91T102 122T103 161T103 203Q103 234 103 269T102 328V351Q99 370 88 376T43 385H25V408Q25 431 27 431L37 432Q47 433 65 434T102 436Q119 437 138 438T167 441T178 442H181V402Q181 364 182 364T187 369T199 384T218 402T247 421T285 437Q305 442 336 442Q351 442 364 440T387 434T406 426T421 417T432 406T441 395T448 384T452 374T455 366L457 361L460 365Q463 369 466 373T475 384T488 397T503 410T523 422T546 432T572 439T603 442Q729 442 740 329Q741 322 741 190V104Q741 66 743 59T754 49Q775 46 803 46H819V0H811L788 1Q764 2 737 2T699 3Q596 3 587 0H579V46H595Q656 46 656 62Q657 64 657 200Q656 335 655 343Q649 371 635 385T611 402T585 404Q540 404 506 370Q479 343 472 315T464 232V168V108Q464 78 465 68T468 55T477 49Q498 46 526 46H542V0H534L510 1Q487 2 460 2T422 3Q319 3 310 0H302V46H318Q379 46 379 62Q380 64 380 200Q379 335 378 343Q372 371 358 385T334 402T308 404Q263 404 229 370Q202 343 195 315T187 232V168V108Q187 78 188 68T191 55T200 49Q221 46 249 46H265V0H257L234 1Q210 2 183 2T145 3Q42 3 33 0H25V46H41Z"></path><path data-c="6F" d="M28 214Q28 309 93 378T250 448Q340 448 405 380T471 215Q471 120 407 55T250 -10Q153 -10 91 57T28 214ZM250 30Q372 30 372 193V225V250Q372 272 371 288T364 326T348 362T317 390T268 410Q263 411 252 411Q222 411 195 399Q152 377 139 338T126 246V226Q126 130 145 91Q177 30 250 30Z" transform="translate(833,0)"></path><path data-c="64" d="M376 495Q376 511 376 535T377 568Q377 613 367 624T316 637H298V660Q298 683 300 683L310 684Q320 685 339 686T376 688Q393 689 413 690T443 693T454 694H457V390Q457 84 458 81Q461 61 472 55T517 46H535V0Q533 0 459 -5T380 -11H373V44L365 37Q307 -11 235 -11Q158 -11 96 50T34 215Q34 315 97 378T244 442Q319 442 376 393V495ZM373 342Q328 405 260 405Q211 405 173 369Q146 341 139 305T131 211Q131 155 138 120T173 59Q203 26 251 26Q322 26 373 103V342Z" transform="translate(1333,0)"></path></g></g></g></svg></mjx-container></p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> invList[mod+ <span class="number">10</span>];</span><br><span class="line"><span class="built_in">voidGetInv</span>(<span class="type">int</span> mod)</span><br><span class="line">{</span><br><span class="line">    invList[<span class="number">1</span>]= <span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i= <span class="number">2</span>; i&lt; mod; i++)</span><br><span class="line">        invList[i]= <span class="number">1LL</span>* (mod- mod/ i)* invList[mod% i]% mod;</span><br><span class="line">}</span><br></pre></td></tr></table></figure>
<h2 id="容斥原理">容斥原理</h2>
<p><strong>奇 ➕ 偶 ➖</strong><br>
<mjx-container class="MathJax" jax="SVG" display="true"><svg style="vertical-align: -0.564ex;" xmlns="http://www.w3.org/2000/svg" width="42.426ex" height="2.261ex" role="img" focusable="false" viewBox="0 -750 18752.3 999.5"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mtext"><text data-variant="bold" transform="scale(1,-1)" font-size="884px" font-family="serif" font-weight="bold">两</text><text data-variant="bold" transform="translate(1000,0) scale(1,-1)" font-size="884px" font-family="serif" font-weight="bold">个</text><text data-variant="bold" transform="translate(2000,0) scale(1,-1)" font-size="884px" font-family="serif" font-weight="bold">集</text><text data-variant="bold" transform="translate(3000,0) scale(1,-1)" font-size="884px" font-family="serif" font-weight="bold">合</text><text data-variant="bold" transform="translate(4000,0) scale(1,-1)" font-size="884px" font-family="serif" font-weight="bold">：</text></g><g data-mml-node="mstyle" transform="translate(5000,0)"><g data-mml-node="mspace"></g></g><g data-mml-node="mo" transform="translate(6000,0) translate(0 -0.5)"><path data-c="7C" d="M139 -249H137Q125 -249 119 -235V251L120 737Q130 750 139 750Q152 750 159 735V-235Q151 -249 141 -249H139Z"></path></g><g data-mml-node="mi" transform="translate(6278,0)"><path data-c="1D434" d="M208 74Q208 50 254 46Q272 46 272 35Q272 34 270 22Q267 8 264 4T251 0Q249 0 239 0T205 1T141 2Q70 2 50 0H42Q35 7 35 11Q37 38 48 46H62Q132 49 164 96Q170 102 345 401T523 704Q530 716 547 716H555H572Q578 707 578 706L606 383Q634 60 636 57Q641 46 701 46Q726 46 726 36Q726 34 723 22Q720 7 718 4T704 0Q701 0 690 0T651 1T578 2Q484 2 455 0H443Q437 6 437 9T439 27Q443 40 445 43L449 46H469Q523 49 533 63L521 213H283L249 155Q208 86 208 74ZM516 260Q516 271 504 416T490 562L463 519Q447 492 400 412L310 260L413 259Q516 259 516 260Z"></path></g><g data-mml-node="mo" transform="translate(7250.2,0)"><path data-c="222A" d="M591 598H592Q604 598 611 583V376Q611 345 611 296Q610 162 606 148Q605 146 605 145Q586 68 507 23T333 -22Q268 -22 209 -1T106 66T56 173Q55 180 55 384L56 585Q66 598 75 598Q85 598 95 585V378L96 172L98 162Q112 95 181 57T332 18Q415 18 487 58T570 175Q571 180 571 383V583Q579 598 591 598Z"></path></g><g data-mml-node="mi" transform="translate(8139.4,0)"><path data-c="1D435" d="M231 637Q204 637 199 638T194 649Q194 676 205 682Q206 683 335 683Q594 683 608 681Q671 671 713 636T756 544Q756 480 698 429T565 360L555 357Q619 348 660 311T702 219Q702 146 630 78T453 1Q446 0 242 0Q42 0 39 2Q35 5 35 10Q35 17 37 24Q42 43 47 45Q51 46 62 46H68Q95 46 128 49Q142 52 147 61Q150 65 219 339T288 628Q288 635 231 637ZM649 544Q649 574 634 600T585 634Q578 636 493 637Q473 637 451 637T416 636H403Q388 635 384 626Q382 622 352 506Q352 503 351 500L320 374H401Q482 374 494 376Q554 386 601 434T649 544ZM595 229Q595 273 572 302T512 336Q506 337 429 337Q311 337 310 336Q310 334 293 263T258 122L240 52Q240 48 252 48T333 46Q422 46 429 47Q491 54 543 105T595 229Z"></path></g><g data-mml-node="mo" transform="translate(8898.4,0) translate(0 -0.5)"><path data-c="7C" d="M139 -249H137Q125 -249 119 -235V251L120 737Q130 750 139 750Q152 750 159 735V-235Q151 -249 141 -249H139Z"></path></g><g data-mml-node="mo" transform="translate(9454.2,0)"><path data-c="3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path></g><g data-mml-node="mo" transform="translate(10510,0) translate(0 -0.5)"><path data-c="7C" d="M139 -249H137Q125 -249 119 -235V251L120 737Q130 750 139 750Q152 750 159 735V-235Q151 -249 141 -249H139Z"></path></g><g data-mml-node="mi" transform="translate(10788,0)"><path data-c="1D434" d="M208 74Q208 50 254 46Q272 46 272 35Q272 34 270 22Q267 8 264 4T251 0Q249 0 239 0T205 1T141 2Q70 2 50 0H42Q35 7 35 11Q37 38 48 46H62Q132 49 164 96Q170 102 345 401T523 704Q530 716 547 716H555H572Q578 707 578 706L606 383Q634 60 636 57Q641 46 701 46Q726 46 726 36Q726 34 723 22Q720 7 718 4T704 0Q701 0 690 0T651 1T578 2Q484 2 455 0H443Q437 6 437 9T439 27Q443 40 445 43L449 46H469Q523 49 533 63L521 213H283L249 155Q208 86 208 74ZM516 260Q516 271 504 416T490 562L463 519Q447 492 400 412L310 260L413 259Q516 259 516 260Z"></path></g><g data-mml-node="mo" transform="translate(11538,0) translate(0 -0.5)"><path data-c="7C" d="M139 -249H137Q125 -249 119 -235V251L120 737Q130 750 139 750Q152 750 159 735V-235Q151 -249 141 -249H139Z"></path></g><g data-mml-node="mo" transform="translate(12038.2,0)"><path data-c="2B" d="M56 237T56 250T70 270H369V420L370 570Q380 583 389 583Q402 583 409 568V270H707Q722 262 722 250T707 230H409V-68Q401 -82 391 -82H389H387Q375 -82 369 -68V230H70Q56 237 56 250Z"></path></g><g data-mml-node="mo" transform="translate(13038.4,0) translate(0 -0.5)"><path data-c="7C" d="M139 -249H137Q125 -249 119 -235V251L120 737Q130 750 139 750Q152 750 159 735V-235Q151 -249 141 -249H139Z"></path></g><g data-mml-node="mi" transform="translate(13316.4,0)"><path data-c="1D435" d="M231 637Q204 637 199 638T194 649Q194 676 205 682Q206 683 335 683Q594 683 608 681Q671 671 713 636T756 544Q756 480 698 429T565 360L555 357Q619 348 660 311T702 219Q702 146 630 78T453 1Q446 0 242 0Q42 0 39 2Q35 5 35 10Q35 17 37 24Q42 43 47 45Q51 46 62 46H68Q95 46 128 49Q142 52 147 61Q150 65 219 339T288 628Q288 635 231 637ZM649 544Q649 574 634 600T585 634Q578 636 493 637Q473 637 451 637T416 636H403Q388 635 384 626Q382 622 352 506Q352 503 351 500L320 374H401Q482 374 494 376Q554 386 601 434T649 544ZM595 229Q595 273 572 302T512 336Q506 337 429 337Q311 337 310 336Q310 334 293 263T258 122L240 52Q240 48 252 48T333 46Q422 46 429 47Q491 54 543 105T595 229Z"></path></g><g data-mml-node="mo" transform="translate(14075.4,0) translate(0 -0.5)"><path data-c="7C" d="M139 -249H137Q125 -249 119 -235V251L120 737Q130 750 139 750Q152 750 159 735V-235Q151 -249 141 -249H139Z"></path></g><g data-mml-node="mo" transform="translate(14575.7,0)"><path data-c="2212" d="M84 237T84 250T98 270H679Q694 262 694 250T679 230H98Q84 237 84 250Z"></path></g><g data-mml-node="mo" transform="translate(15575.9,0) translate(0 -0.5)"><path data-c="7C" d="M139 -249H137Q125 -249 119 -235V251L120 737Q130 750 139 750Q152 750 159 735V-235Q151 -249 141 -249H139Z"></path></g><g data-mml-node="mi" transform="translate(15853.9,0)"><path data-c="1D434" d="M208 74Q208 50 254 46Q272 46 272 35Q272 34 270 22Q267 8 264 4T251 0Q249 0 239 0T205 1T141 2Q70 2 50 0H42Q35 7 35 11Q37 38 48 46H62Q132 49 164 96Q170 102 345 401T523 704Q530 716 547 716H555H572Q578 707 578 706L606 383Q634 60 636 57Q641 46 701 46Q726 46 726 36Q726 34 723 22Q720 7 718 4T704 0Q701 0 690 0T651 1T578 2Q484 2 455 0H443Q437 6 437 9T439 27Q443 40 445 43L449 46H469Q523 49 533 63L521 213H283L249 155Q208 86 208 74ZM516 260Q516 271 504 416T490 562L463 519Q447 492 400 412L310 260L413 259Q516 259 516 260Z"></path></g><g data-mml-node="mo" transform="translate(16826.1,0)"><path data-c="2229" d="M88 -21T75 -21T55 -7V200Q55 231 55 280Q56 414 60 428Q61 430 61 431Q77 500 152 549T332 598Q443 598 522 544T610 405Q611 399 611 194V-7Q604 -22 591 -22Q582 -22 572 -9L570 405Q563 433 556 449T529 485Q498 519 445 538T334 558Q251 558 179 518T96 401Q95 396 95 193V-7Q88 -21 75 -21Z"></path></g><g data-mml-node="mi" transform="translate(17715.3,0)"><path data-c="1D435" d="M231 637Q204 637 199 638T194 649Q194 676 205 682Q206 683 335 683Q594 683 608 681Q671 671 713 636T756 544Q756 480 698 429T565 360L555 357Q619 348 660 311T702 219Q702 146 630 78T453 1Q446 0 242 0Q42 0 39 2Q35 5 35 10Q35 17 37 24Q42 43 47 45Q51 46 62 46H68Q95 46 128 49Q142 52 147 61Q150 65 219 339T288 628Q288 635 231 637ZM649 544Q649 574 634 600T585 634Q578 636 493 637Q473 637 451 637T416 636H403Q388 635 384 626Q382 622 352 506Q352 503 351 500L320 374H401Q482 374 494 376Q554 386 601 434T649 544ZM595 229Q595 273 572 302T512 336Q506 337 429 337Q311 337 310 336Q310 334 293 263T258 122L240 52Q240 48 252 48T333 46Q422 46 429 47Q491 54 543 105T595 229Z"></path></g><g data-mml-node="mo" transform="translate(18474.3,0) translate(0 -0.5)"><path data-c="7C" d="M139 -249H137Q125 -249 119 -235V251L120 737Q130 750 139 750Q152 750 159 735V-235Q151 -249 141 -249H139Z"></path></g></g></g></svg></mjx-container></p>
<p>$$<br>
\textbf{三个集合：} \quad<br>
|A \cup B \cup C| = |A| + |B| + |C|</p>
<ul class="lvl-0">
<li class="lvl-2">
<p>|A \cap B| - |A \cap C| - |B \cap C|</p>
</li>
</ul>
<ul class="lvl-0">
<li class="lvl-2">
<p>|A \cap B \cap C|<br>
$$</p>
</li>
</ul>
<p><mjx-container class="MathJax" jax="SVG" display="true"><svg style="vertical-align: -2.94ex;" xmlns="http://www.w3.org/2000/svg" width="90.249ex" height="6.889ex" role="img" focusable="false" viewBox="0 -1745.4 39890.3 3044.9"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mtext"><path data-c="1D427" d="M40 442Q217 450 218 450H224V407L225 365Q233 378 245 391T289 422T362 448Q374 450 398 450Q428 450 448 447T491 434T529 402T551 346Q553 335 554 198V62H623V0H614Q596 3 489 3Q374 3 365 0H356V62H425V194V275Q425 348 416 373T371 399Q326 399 288 370T238 290Q236 281 235 171V62H304V0H295Q277 3 171 3Q64 3 46 0H37V62H106V210V303Q106 353 104 363T91 376Q77 380 50 380H37V442H40Z"></path><path data-c="20" d="" transform="translate(639,0)"></path><text data-variant="bold" transform="translate(889,0) scale(1,-1)" font-size="884px" font-family="serif" font-weight="bold">个</text><text data-variant="bold" transform="translate(1889,0) scale(1,-1)" font-size="884px" font-family="serif" font-weight="bold">集</text><text data-variant="bold" transform="translate(2889,0) scale(1,-1)" font-size="884px" font-family="serif" font-weight="bold">合</text><text data-variant="bold" transform="translate(3889,0) scale(1,-1)" font-size="884px" font-family="serif" font-weight="bold">的</text><text data-variant="bold" transform="translate(4889,0) scale(1,-1)" font-size="884px" font-family="serif" font-weight="bold">情</text><text data-variant="bold" transform="translate(5889,0) scale(1,-1)" font-size="884px" font-family="serif" font-weight="bold">况</text><text data-variant="bold" transform="translate(6889,0) scale(1,-1)" font-size="884px" font-family="serif" font-weight="bold">（</text><text data-variant="bold" transform="translate(7889,0) scale(1,-1)" font-size="884px" font-family="serif" font-weight="bold">容</text><text data-variant="bold" transform="translate(8889,0) scale(1,-1)" font-size="884px" font-family="serif" font-weight="bold">斥</text><text data-variant="bold" transform="translate(9889,0) scale(1,-1)" font-size="884px" font-family="serif" font-weight="bold">原</text><text data-variant="bold" transform="translate(10889,0) scale(1,-1)" font-size="884px" font-family="serif" font-weight="bold">理</text><text data-variant="bold" transform="translate(11889,0) scale(1,-1)" font-size="884px" font-family="serif" font-weight="bold">）</text><text data-variant="bold" transform="translate(12889,0) scale(1,-1)" font-size="884px" font-family="serif" font-weight="bold">：</text></g><g data-mml-node="mstyle" transform="translate(13889,0)"><g data-mml-node="mspace"></g></g><g data-mml-node="mrow" transform="translate(15055.7,0)"><g data-mml-node="mo"><svg width="278" height="2990.8" y="-1245.4" x="27.5" viewBox="0 -370.5 278 2990.8"><path data-c="2223" d="M139 -249H137Q125 -249 119 -235V251L120 737Q130 750 139 750Q152 750 159 735V-235Q151 -249 141 -249H139Z" transform="scale(1,4.491)"></path></svg></g><g data-mml-node="munderover" transform="translate(333,0)"><g data-mml-node="mo" transform="translate(18.3,0) translate(0 -0.5)"><path data-c="22C3" d="M56 911Q58 926 71 938T103 950Q120 950 134 939T152 911Q153 907 153 463Q153 16 154 6Q165 -143 279 -247T556 -352Q716 -352 830 -248T956 6Q957 16 957 463Q957 907 958 911Q962 928 975 939T1006 950T1037 939T1054 911Q1055 906 1055 451Q1054 -5 1053 -16Q1029 -207 889 -328T555 -449Q363 -449 226 -331T62 -45Q57 -16 57 25T55 451Q55 906 56 911Z"></path></g><g data-mml-node="TeXAtom" transform="translate(0,-1087.4) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mi"><path data-c="1D456" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z"></path></g><g data-mml-node="mo" transform="translate(345,0)"><path data-c="3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path></g><g data-mml-node="mn" transform="translate(1123,0)"><path data-c="31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path></g></g><g data-mml-node="TeXAtom" transform="translate(361.7,1149.5) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mi"><path data-c="1D45B" d="M21 287Q22 293 24 303T36 341T56 388T89 425T135 442Q171 442 195 424T225 390T231 369Q231 367 232 367L243 378Q304 442 382 442Q436 442 469 415T503 336T465 179T427 52Q427 26 444 26Q450 26 453 27Q482 32 505 65T540 145Q542 153 560 153Q580 153 580 145Q580 144 576 130Q568 101 554 73T508 17T439 -10Q392 -10 371 17T350 73Q350 92 386 193T423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 180T152 343Q153 348 153 366Q153 405 129 405Q91 405 66 305Q60 285 60 284Q58 278 41 278H27Q21 284 21 287Z"></path></g></g></g><g data-mml-node="msub" transform="translate(1647.3,0)"><g data-mml-node="mi"><path data-c="1D434" d="M208 74Q208 50 254 46Q272 46 272 35Q272 34 270 22Q267 8 264 4T251 0Q249 0 239 0T205 1T141 2Q70 2 50 0H42Q35 7 35 11Q37 38 48 46H62Q132 49 164 96Q170 102 345 401T523 704Q530 716 547 716H555H572Q578 707 578 706L606 383Q634 60 636 57Q641 46 701 46Q726 46 726 36Q726 34 723 22Q720 7 718 4T704 0Q701 0 690 0T651 1T578 2Q484 2 455 0H443Q437 6 437 9T439 27Q443 40 445 43L449 46H469Q523 49 533 63L521 213H283L249 155Q208 86 208 74ZM516 260Q516 271 504 416T490 562L463 519Q447 492 400 412L310 260L413 259Q516 259 516 260Z"></path></g><g data-mml-node="mi" transform="translate(783,-150) scale(0.707)"><path data-c="1D456" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z"></path></g></g><g data-mml-node="mo" transform="translate(2724.3,0)"><svg width="278" height="2990.8" y="-1245.4" x="27.5" viewBox="0 -370.5 278 2990.8"><path data-c="2223" d="M139 -249H137Q125 -249 119 -235V251L120 737Q130 750 139 750Q152 750 159 735V-235Q151 -249 141 -249H139Z" transform="scale(1,4.491)"></path></svg></g></g><g data-mml-node="mo" transform="translate(18390.7,0)"><path data-c="3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path></g><g data-mml-node="munderover" transform="translate(19446.5,0)"><g data-mml-node="mo"><path data-c="2211" d="M60 948Q63 950 665 950H1267L1325 815Q1384 677 1388 669H1348L1341 683Q1320 724 1285 761Q1235 809 1174 838T1033 881T882 898T699 902H574H543H251L259 891Q722 258 724 252Q725 250 724 246Q721 243 460 -56L196 -356Q196 -357 407 -357Q459 -357 548 -357T676 -358Q812 -358 896 -353T1063 -332T1204 -283T1307 -196Q1328 -170 1348 -124H1388Q1388 -125 1381 -145T1356 -210T1325 -294L1267 -449L666 -450Q64 -450 61 -448Q55 -446 55 -439Q55 -437 57 -433L590 177Q590 178 557 222T452 366T322 544L56 909L55 924Q55 945 60 948Z"></path></g><g data-mml-node="TeXAtom" transform="translate(86,-1107.7) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mi"><path data-c="1D458" d="M121 647Q121 657 125 670T137 683Q138 683 209 688T282 694Q294 694 294 686Q294 679 244 477Q194 279 194 272Q213 282 223 291Q247 309 292 354T362 415Q402 442 438 442Q468 442 485 423T503 369Q503 344 496 327T477 302T456 291T438 288Q418 288 406 299T394 328Q394 353 410 369T442 390L458 393Q446 405 434 405H430Q398 402 367 380T294 316T228 255Q230 254 243 252T267 246T293 238T320 224T342 206T359 180T365 147Q365 130 360 106T354 66Q354 26 381 26Q429 26 459 145Q461 153 479 153H483Q499 153 499 144Q499 139 496 130Q455 -11 378 -11Q333 -11 305 15T277 90Q277 108 280 121T283 145Q283 167 269 183T234 206T200 217T182 220H180Q168 178 159 139T145 81T136 44T129 20T122 7T111 -2Q98 -11 83 -11Q66 -11 57 -1T48 16Q48 26 85 176T158 471L195 616Q196 629 188 632T149 637H144Q134 637 131 637T124 640T121 647Z"></path></g><g data-mml-node="mo" transform="translate(521,0)"><path data-c="3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path></g><g data-mml-node="mn" transform="translate(1299,0)"><path data-c="31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path></g></g><g data-mml-node="TeXAtom" transform="translate(509.9,1150) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mi"><path data-c="1D45B" d="M21 287Q22 293 24 303T36 341T56 388T89 425T135 442Q171 442 195 424T225 390T231 369Q231 367 232 367L243 378Q304 442 382 442Q436 442 469 415T503 336T465 179T427 52Q427 26 444 26Q450 26 453 27Q482 32 505 65T540 145Q542 153 560 153Q580 153 580 145Q580 144 576 130Q568 101 554 73T508 17T439 -10Q392 -10 371 17T350 73Q350 92 386 193T423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 180T152 343Q153 348 153 366Q153 405 129 405Q91 405 66 305Q60 285 60 284Q58 278 41 278H27Q21 284 21 287Z"></path></g></g></g><g data-mml-node="mo" transform="translate(20890.5,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path></g><g data-mml-node="mo" transform="translate(21279.5,0)"><path data-c="2212" d="M84 237T84 250T98 270H679Q694 262 694 250T679 230H98Q84 237 84 250Z"></path></g><g data-mml-node="mn" transform="translate(22057.5,0)"><path data-c="31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path></g><g data-mml-node="msup" transform="translate(22557.5,0)"><g data-mml-node="mo"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path></g><g data-mml-node="TeXAtom" transform="translate(422,413) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mi"><path data-c="1D458" d="M121 647Q121 657 125 670T137 683Q138 683 209 688T282 694Q294 694 294 686Q294 679 244 477Q194 279 194 272Q213 282 223 291Q247 309 292 354T362 415Q402 442 438 442Q468 442 485 423T503 369Q503 344 496 327T477 302T456 291T438 288Q418 288 406 299T394 328Q394 353 410 369T442 390L458 393Q446 405 434 405H430Q398 402 367 380T294 316T228 255Q230 254 243 252T267 246T293 238T320 224T342 206T359 180T365 147Q365 130 360 106T354 66Q354 26 381 26Q429 26 459 145Q461 153 479 153H483Q499 153 499 144Q499 139 496 130Q455 -11 378 -11Q333 -11 305 15T277 90Q277 108 280 121T283 145Q283 167 269 183T234 206T200 217T182 220H180Q168 178 159 139T145 81T136 44T129 20T122 7T111 -2Q98 -11 83 -11Q66 -11 57 -1T48 16Q48 26 85 176T158 471L195 616Q196 629 188 632T149 637H144Q134 637 131 637T124 640T121 647Z"></path></g><g data-mml-node="mo" transform="translate(521,0)"><path data-c="2B" d="M56 237T56 250T70 270H369V420L370 570Q380 583 389 583Q402 583 409 568V270H707Q722 262 722 250T707 230H409V-68Q401 -82 391 -82H389H387Q375 -82 369 -68V230H70Q56 237 56 250Z"></path></g><g data-mml-node="mn" transform="translate(1299,0)"><path data-c="31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path></g></g></g><g data-mml-node="munder" transform="translate(24468.2,0)"><g data-mml-node="mo" transform="translate(2290.8,0)"><path data-c="2211" d="M60 948Q63 950 665 950H1267L1325 815Q1384 677 1388 669H1348L1341 683Q1320 724 1285 761Q1235 809 1174 838T1033 881T882 898T699 902H574H543H251L259 891Q722 258 724 252Q725 250 724 246Q721 243 460 -56L196 -356Q196 -357 407 -357Q459 -357 548 -357T676 -358Q812 -358 896 -353T1063 -332T1204 -283T1307 -196Q1328 -170 1348 -124H1388Q1388 -125 1381 -145T1356 -210T1325 -294L1267 -449L666 -450Q64 -450 61 -448Q55 -446 55 -439Q55 -437 57 -433L590 177Q590 178 557 222T452 366T322 544L56 909L55 924Q55 945 60 948Z"></path></g><g data-mml-node="TeXAtom" transform="translate(0,-1087.9) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mn"><path data-c="31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path></g><g data-mml-node="mo" transform="translate(500,0)"><path data-c="2264" d="M674 636Q682 636 688 630T694 615T687 601Q686 600 417 472L151 346L399 228Q687 92 691 87Q694 81 694 76Q694 58 676 56H670L382 192Q92 329 90 331Q83 336 83 348Q84 359 96 365Q104 369 382 500T665 634Q669 636 674 636ZM84 -118Q84 -108 99 -98H678Q694 -104 694 -118Q694 -130 679 -138H98Q84 -131 84 -118Z"></path></g><g data-mml-node="msub" transform="translate(1278,0)"><g data-mml-node="mi"><path data-c="1D456" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z"></path></g><g data-mml-node="mn" transform="translate(378,-150) scale(0.707)"><path data-c="31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path></g></g><g data-mml-node="mo" transform="translate(2059.6,0)"><path data-c="3C" d="M694 -11T694 -19T688 -33T678 -40Q671 -40 524 29T234 166L90 235Q83 240 83 250Q83 261 91 266Q664 540 678 540Q681 540 687 534T694 519T687 505Q686 504 417 376L151 250L417 124Q686 -4 687 -5Q694 -11 694 -19Z"></path></g><g data-mml-node="msub" transform="translate(2837.6,0)"><g data-mml-node="mi"><path data-c="1D456" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z"></path></g><g data-mml-node="mn" transform="translate(378,-150) scale(0.707)"><path data-c="32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"></path></g></g><g data-mml-node="mo" transform="translate(3619.1,0)"><path data-c="3C" d="M694 -11T694 -19T688 -33T678 -40Q671 -40 524 29T234 166L90 235Q83 240 83 250Q83 261 91 266Q664 540 678 540Q681 540 687 534T694 519T687 505Q686 504 417 376L151 250L417 124Q686 -4 687 -5Q694 -11 694 -19Z"></path></g><g data-mml-node="mo" transform="translate(4397.1,0)"><path data-c="22EF" d="M78 250Q78 274 95 292T138 310Q162 310 180 294T199 251Q199 226 182 208T139 190T96 207T78 250ZM525 250Q525 274 542 292T585 310Q609 310 627 294T646 251Q646 226 629 208T586 190T543 207T525 250ZM972 250Q972 274 989 292T1032 310Q1056 310 1074 294T1093 251Q1093 226 1076 208T1033 190T990 207T972 250Z"></path></g><g data-mml-node="mo" transform="translate(5569.1,0)"><path data-c="3C" d="M694 -11T694 -19T688 -33T678 -40Q671 -40 524 29T234 166L90 235Q83 240 83 250Q83 261 91 266Q664 540 678 540Q681 540 687 534T694 519T687 505Q686 504 417 376L151 250L417 124Q686 -4 687 -5Q694 -11 694 -19Z"></path></g><g data-mml-node="msub" transform="translate(6347.1,0)"><g data-mml-node="mi"><path data-c="1D456" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z"></path></g><g data-mml-node="mi" transform="translate(378,-150) scale(0.707)"><path data-c="1D458" d="M121 647Q121 657 125 670T137 683Q138 683 209 688T282 694Q294 694 294 686Q294 679 244 477Q194 279 194 272Q213 282 223 291Q247 309 292 354T362 415Q402 442 438 442Q468 442 485 423T503 369Q503 344 496 327T477 302T456 291T438 288Q418 288 406 299T394 328Q394 353 410 369T442 390L458 393Q446 405 434 405H430Q398 402 367 380T294 316T228 255Q230 254 243 252T267 246T293 238T320 224T342 206T359 180T365 147Q365 130 360 106T354 66Q354 26 381 26Q429 26 459 145Q461 153 479 153H483Q499 153 499 144Q499 139 496 130Q455 -11 378 -11Q333 -11 305 15T277 90Q277 108 280 121T283 145Q283 167 269 183T234 206T200 217T182 220H180Q168 178 159 139T145 81T136 44T129 20T122 7T111 -2Q98 -11 83 -11Q66 -11 57 -1T48 16Q48 26 85 176T158 471L195 616Q196 629 188 632T149 637H144Q134 637 131 637T124 640T121 647Z"></path></g></g><g data-mml-node="mo" transform="translate(7143.5,0)"><path data-c="2264" d="M674 636Q682 636 688 630T694 615T687 601Q686 600 417 472L151 346L399 228Q687 92 691 87Q694 81 694 76Q694 58 676 56H670L382 192Q92 329 90 331Q83 336 83 348Q84 359 96 365Q104 369 382 500T665 634Q669 636 674 636ZM84 -118Q84 -108 99 -98H678Q694 -104 694 -118Q694 -130 679 -138H98Q84 -131 84 -118Z"></path></g><g data-mml-node="mi" transform="translate(7921.5,0)"><path data-c="1D45B" d="M21 287Q22 293 24 303T36 341T56 388T89 425T135 442Q171 442 195 424T225 390T231 369Q231 367 232 367L243 378Q304 442 382 442Q436 442 469 415T503 336T465 179T427 52Q427 26 444 26Q450 26 453 27Q482 32 505 65T540 145Q542 153 560 153Q580 153 580 145Q580 144 576 130Q568 101 554 73T508 17T439 -10Q392 -10 371 17T350 73Q350 92 386 193T423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 180T152 343Q153 348 153 366Q153 405 129 405Q91 405 66 305Q60 285 60 284Q58 278 41 278H27Q21 284 21 287Z"></path></g></g></g><g data-mml-node="mrow" transform="translate(30660.5,0)"><g data-mml-node="mo" transform="translate(0 -0.5)"><path data-c="7C" d="M139 -249H137Q125 -249 119 -235V251L120 737Q130 750 139 750Q152 750 159 735V-235Q151 -249 141 -249H139Z"></path></g><g data-mml-node="msub" transform="translate(278,0)"><g data-mml-node="mi"><path data-c="1D434" d="M208 74Q208 50 254 46Q272 46 272 35Q272 34 270 22Q267 8 264 4T251 0Q249 0 239 0T205 1T141 2Q70 2 50 0H42Q35 7 35 11Q37 38 48 46H62Q132 49 164 96Q170 102 345 401T523 704Q530 716 547 716H555H572Q578 707 578 706L606 383Q634 60 636 57Q641 46 701 46Q726 46 726 36Q726 34 723 22Q720 7 718 4T704 0Q701 0 690 0T651 1T578 2Q484 2 455 0H443Q437 6 437 9T439 27Q443 40 445 43L449 46H469Q523 49 533 63L521 213H283L249 155Q208 86 208 74ZM516 260Q516 271 504 416T490 562L463 519Q447 492 400 412L310 260L413 259Q516 259 516 260Z"></path></g><g data-mml-node="TeXAtom" transform="translate(783,-150) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="msub"><g data-mml-node="mi"><path data-c="1D456" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z"></path></g><g data-mml-node="mn" transform="translate(378,-150) scale(0.707)"><path data-c="31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path></g></g></g></g><g data-mml-node="mo" transform="translate(1885.9,0)"><path data-c="2229" d="M88 -21T75 -21T55 -7V200Q55 231 55 280Q56 414 60 428Q61 430 61 431Q77 500 152 549T332 598Q443 598 522 544T610 405Q611 399 611 194V-7Q604 -22 591 -22Q582 -22 572 -9L570 405Q563 433 556 449T529 485Q498 519 445 538T334 558Q251 558 179 518T96 401Q95 396 95 193V-7Q88 -21 75 -21Z"></path></g><g data-mml-node="msub" transform="translate(2775.1,0)"><g data-mml-node="mi"><path data-c="1D434" d="M208 74Q208 50 254 46Q272 46 272 35Q272 34 270 22Q267 8 264 4T251 0Q249 0 239 0T205 1T141 2Q70 2 50 0H42Q35 7 35 11Q37 38 48 46H62Q132 49 164 96Q170 102 345 401T523 704Q530 716 547 716H555H572Q578 707 578 706L606 383Q634 60 636 57Q641 46 701 46Q726 46 726 36Q726 34 723 22Q720 7 718 4T704 0Q701 0 690 0T651 1T578 2Q484 2 455 0H443Q437 6 437 9T439 27Q443 40 445 43L449 46H469Q523 49 533 63L521 213H283L249 155Q208 86 208 74ZM516 260Q516 271 504 416T490 562L463 519Q447 492 400 412L310 260L413 259Q516 259 516 260Z"></path></g><g data-mml-node="TeXAtom" transform="translate(783,-150) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="msub"><g data-mml-node="mi"><path data-c="1D456" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z"></path></g><g data-mml-node="mn" transform="translate(378,-150) scale(0.707)"><path data-c="32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"></path></g></g></g></g><g data-mml-node="mo" transform="translate(4383,0)"><path data-c="2229" d="M88 -21T75 -21T55 -7V200Q55 231 55 280Q56 414 60 428Q61 430 61 431Q77 500 152 549T332 598Q443 598 522 544T610 405Q611 399 611 194V-7Q604 -22 591 -22Q582 -22 572 -9L570 405Q563 433 556 449T529 485Q498 519 445 538T334 558Q251 558 179 518T96 401Q95 396 95 193V-7Q88 -21 75 -21Z"></path></g><g data-mml-node="mo" transform="translate(5272.2,0)"><path data-c="22EF" d="M78 250Q78 274 95 292T138 310Q162 310 180 294T199 251Q199 226 182 208T139 190T96 207T78 250ZM525 250Q525 274 542 292T585 310Q609 310 627 294T646 251Q646 226 629 208T586 190T543 207T525 250ZM972 250Q972 274 989 292T1032 310Q1056 310 1074 294T1093 251Q1093 226 1076 208T1033 190T990 207T972 250Z"></path></g><g data-mml-node="mo" transform="translate(6666.4,0)"><path data-c="2229" d="M88 -21T75 -21T55 -7V200Q55 231 55 280Q56 414 60 428Q61 430 61 431Q77 500 152 549T332 598Q443 598 522 544T610 405Q611 399 611 194V-7Q604 -22 591 -22Q582 -22 572 -9L570 405Q563 433 556 449T529 485Q498 519 445 538T334 558Q251 558 179 518T96 401Q95 396 95 193V-7Q88 -21 75 -21Z"></path></g><g data-mml-node="msub" transform="translate(7555.6,0)"><g data-mml-node="mi"><path data-c="1D434" d="M208 74Q208 50 254 46Q272 46 272 35Q272 34 270 22Q267 8 264 4T251 0Q249 0 239 0T205 1T141 2Q70 2 50 0H42Q35 7 35 11Q37 38 48 46H62Q132 49 164 96Q170 102 345 401T523 704Q530 716 547 716H555H572Q578 707 578 706L606 383Q634 60 636 57Q641 46 701 46Q726 46 726 36Q726 34 723 22Q720 7 718 4T704 0Q701 0 690 0T651 1T578 2Q484 2 455 0H443Q437 6 437 9T439 27Q443 40 445 43L449 46H469Q523 49 533 63L521 213H283L249 155Q208 86 208 74ZM516 260Q516 271 504 416T490 562L463 519Q447 492 400 412L310 260L413 259Q516 259 516 260Z"></path></g><g data-mml-node="TeXAtom" transform="translate(783,-150) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="msub"><g data-mml-node="mi"><path data-c="1D456" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z"></path></g><g data-mml-node="mi" transform="translate(378,-150) scale(0.707)"><path data-c="1D458" d="M121 647Q121 657 125 670T137 683Q138 683 209 688T282 694Q294 694 294 686Q294 679 244 477Q194 279 194 272Q213 282 223 291Q247 309 292 354T362 415Q402 442 438 442Q468 442 485 423T503 369Q503 344 496 327T477 302T456 291T438 288Q418 288 406 299T394 328Q394 353 410 369T442 390L458 393Q446 405 434 405H430Q398 402 367 380T294 316T228 255Q230 254 243 252T267 246T293 238T320 224T342 206T359 180T365 147Q365 130 360 106T354 66Q354 26 381 26Q429 26 459 145Q461 153 479 153H483Q499 153 499 144Q499 139 496 130Q455 -11 378 -11Q333 -11 305 15T277 90Q277 108 280 121T283 145Q283 167 269 183T234 206T200 217T182 220H180Q168 178 159 139T145 81T136 44T129 20T122 7T111 -2Q98 -11 83 -11Q66 -11 57 -1T48 16Q48 26 85 176T158 471L195 616Q196 629 188 632T149 637H144Q134 637 131 637T124 640T121 647Z"></path></g></g></g></g><g data-mml-node="mo" transform="translate(8951.8,0) translate(0 -0.5)"><path data-c="7C" d="M139 -249H137Q125 -249 119 -235V251L120 737Q130 750 139 750Q152 750 159 735V-235Q151 -249 141 -249H139Z"></path></g></g></g></g></svg></mjx-container></p>
<p>相关题目：</p>
<ul class="lvl-0">
<li class="lvl-2">
<p>计算区间 [1,n] 内不被给定质数整除的整数个数</p>
</li>
</ul>
<aside>
💡
<p>因为 需要随机选 a0 → an 中的任意几个数的组合，所以用 <strong>二进制的形式</strong> 来计算</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="type">long</span> <span class="type">long</span> LL;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">lcm</span><span class="params">(<span class="type">int</span> a, <span class="type">int</span> b)</span></span>{</span><br><span class="line">    <span class="keyword">return</span> a / __gcd(a, b) * b;</span><br><span class="line">}</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>{</span><br><span class="line">    <span class="type">int</span> k, n;</span><br><span class="line">    cin &gt;&gt; k &gt;&gt; n;</span><br><span class="line">    <span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">a</span><span class="params">(k)</span></span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">auto</span>&amp; x : a){</span><br><span class="line">        cin &gt;&gt; x;</span><br><span class="line">    }</span><br><span class="line">    LL t = <span class="number">1</span> &lt;&lt; k; </span><br><span class="line">    LL result = <span class="number">0</span>;   </span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= t; i++){</span><br><span class="line">        <span class="type">int</span> l = <span class="number">1</span>, bits = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> j = <span class="number">0</span>; j &lt; k; j++){</span><br><span class="line">           <span class="keyword">if</span>(i &amp; (<span class="number">1</span> &lt;&lt; j)){</span><br><span class="line">             bits++;</span><br><span class="line">             <span class="keyword">if</span>(l &gt; n / a[i]){</span><br><span class="line">                l = n + <span class="number">1</span>;</span><br><span class="line">                <span class="comment">// 相当于 没必要进行后续计算 因为 n / l == 0</span></span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">             }</span><br><span class="line">             l = <span class="built_in">lcm</span>(l, a[i]);</span><br><span class="line">           }</span><br><span class="line">        }</span><br><span class="line">        <span class="keyword">if</span>(bits % <span class="number">2</span>) result += n / l;</span><br><span class="line">        <span class="keyword">else</span> result -= n / l;</span><br><span class="line">    }</span><br><span class="line">    cout &lt;&lt; n - result &lt;&lt; endl;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">}</span><br></pre></td></tr></table></figure>
<ul class="lvl-0">
<li class="lvl-2">
<p>计算非互质整数对的个数</p>
</li>
<li class="lvl-2">
<p>计算符合排列条件的方案数（n！的排列中，至少有 k 个字符 在原位上的 个数）</p>
</li>
</ul>
<h2 id="快速幂">快速幂</h2>
<ul class="lvl-0">
<li class="lvl-2">
<p>基本快速幂</p>
</li>
</ul>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="type">long</span> <span class="type">long</span> LL;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> mod = <span class="number">1e9</span> + <span class="number">7</span>;</span><br><span class="line"><span class="function">LL <span class="title">fastpow</span><span class="params">(<span class="type">int</span> a, <span class="type">int</span> b)</span></span>{</span><br><span class="line">    LL ant = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span>(b){</span><br><span class="line">        <span class="keyword">if</span>(b &amp; <span class="number">1</span>){</span><br><span class="line">            ant = ant * a %mod;</span><br><span class="line">        }</span><br><span class="line">        a = a * a %mod;</span><br><span class="line">        b &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">    }</span><br><span class="line">    <span class="keyword">return</span> ant % mod;</span><br><span class="line">}</span><br></pre></td></tr></table></figure>
<ul class="lvl-0">
<li class="lvl-2">
<p>矩阵快速幂</p>
</li>
</ul>
<aside>
💡
<p>矩阵快速幂 常用于 DP（固定线性递归）问题</p>
<ol>
<li class="lvl-3">
<p><strong>一维 k阶</strong>（k 个式子） <strong>时间复杂度 ：O(logn * 2^k)</strong></p>
</li>
</ol>
<p><mjx-container class="MathJax" jax="SVG" display="true"><svg style="vertical-align: -0.566ex;" xmlns="http://www.w3.org/2000/svg" width="49.088ex" height="2.262ex" role="img" focusable="false" viewBox="0 -750 21696.7 1000"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D453" d="M118 -162Q120 -162 124 -164T135 -167T147 -168Q160 -168 171 -155T187 -126Q197 -99 221 27T267 267T289 382V385H242Q195 385 192 387Q188 390 188 397L195 425Q197 430 203 430T250 431Q298 431 298 432Q298 434 307 482T319 540Q356 705 465 705Q502 703 526 683T550 630Q550 594 529 578T487 561Q443 561 443 603Q443 622 454 636T478 657L487 662Q471 668 457 668Q445 668 434 658T419 630Q412 601 403 552T387 469T380 433Q380 431 435 431Q480 431 487 430T498 424Q499 420 496 407T491 391Q489 386 482 386T428 385H372L349 263Q301 15 282 -47Q255 -132 212 -173Q175 -205 139 -205Q107 -205 81 -186T55 -132Q55 -95 76 -78T118 -61Q162 -61 162 -103Q162 -122 151 -136T127 -157L118 -162Z"></path></g><g data-mml-node="mo" transform="translate(550,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path></g><g data-mml-node="mi" transform="translate(939,0)"><path data-c="1D45B" d="M21 287Q22 293 24 303T36 341T56 388T89 425T135 442Q171 442 195 424T225 390T231 369Q231 367 232 367L243 378Q304 442 382 442Q436 442 469 415T503 336T465 179T427 52Q427 26 444 26Q450 26 453 27Q482 32 505 65T540 145Q542 153 560 153Q580 153 580 145Q580 144 576 130Q568 101 554 73T508 17T439 -10Q392 -10 371 17T350 73Q350 92 386 193T423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 180T152 343Q153 348 153 366Q153 405 129 405Q91 405 66 305Q60 285 60 284Q58 278 41 278H27Q21 284 21 287Z"></path></g><g data-mml-node="mo" transform="translate(1539,0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path></g><g data-mml-node="mo" transform="translate(2205.8,0)"><path data-c="3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path></g><g data-mml-node="msub" transform="translate(3261.6,0)"><g data-mml-node="mi"><path data-c="1D450" d="M34 159Q34 268 120 355T306 442Q362 442 394 418T427 355Q427 326 408 306T360 285Q341 285 330 295T319 325T330 359T352 380T366 386H367Q367 388 361 392T340 400T306 404Q276 404 249 390Q228 381 206 359Q162 315 142 235T121 119Q121 73 147 50Q169 26 205 26H209Q321 26 394 111Q403 121 406 121Q410 121 419 112T429 98T420 83T391 55T346 25T282 0T202 -11Q127 -11 81 37T34 159Z"></path></g><g data-mml-node="mn" transform="translate(466,-150) scale(0.707)"><path data-c="31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path></g></g><g data-mml-node="mi" transform="translate(4131.1,0)"><path data-c="1D453" d="M118 -162Q120 -162 124 -164T135 -167T147 -168Q160 -168 171 -155T187 -126Q197 -99 221 27T267 267T289 382V385H242Q195 385 192 387Q188 390 188 397L195 425Q197 430 203 430T250 431Q298 431 298 432Q298 434 307 482T319 540Q356 705 465 705Q502 703 526 683T550 630Q550 594 529 578T487 561Q443 561 443 603Q443 622 454 636T478 657L487 662Q471 668 457 668Q445 668 434 658T419 630Q412 601 403 552T387 469T380 433Q380 431 435 431Q480 431 487 430T498 424Q499 420 496 407T491 391Q489 386 482 386T428 385H372L349 263Q301 15 282 -47Q255 -132 212 -173Q175 -205 139 -205Q107 -205 81 -186T55 -132Q55 -95 76 -78T118 -61Q162 -61 162 -103Q162 -122 151 -136T127 -157L118 -162Z"></path></g><g data-mml-node="mo" transform="translate(4681.1,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path></g><g data-mml-node="mi" transform="translate(5070.1,0)"><path data-c="1D45B" d="M21 287Q22 293 24 303T36 341T56 388T89 425T135 442Q171 442 195 424T225 390T231 369Q231 367 232 367L243 378Q304 442 382 442Q436 442 469 415T503 336T465 179T427 52Q427 26 444 26Q450 26 453 27Q482 32 505 65T540 145Q542 153 560 153Q580 153 580 145Q580 144 576 130Q568 101 554 73T508 17T439 -10Q392 -10 371 17T350 73Q350 92 386 193T423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 180T152 343Q153 348 153 366Q153 405 129 405Q91 405 66 305Q60 285 60 284Q58 278 41 278H27Q21 284 21 287Z"></path></g><g data-mml-node="mo" transform="translate(5892.3,0)"><path data-c="2212" d="M84 237T84 250T98 270H679Q694 262 694 250T679 230H98Q84 237 84 250Z"></path></g><g data-mml-node="mn" transform="translate(6892.6,0)"><path data-c="31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path></g><g data-mml-node="mo" transform="translate(7392.6,0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path></g><g data-mml-node="mo" transform="translate(8003.8,0)"><path data-c="2B" d="M56 237T56 250T70 270H369V420L370 570Q380 583 389 583Q402 583 409 568V270H707Q722 262 722 250T707 230H409V-68Q401 -82 391 -82H389H387Q375 -82 369 -68V230H70Q56 237 56 250Z"></path></g><g data-mml-node="msub" transform="translate(9004,0)"><g data-mml-node="mi"><path data-c="1D450" d="M34 159Q34 268 120 355T306 442Q362 442 394 418T427 355Q427 326 408 306T360 285Q341 285 330 295T319 325T330 359T352 380T366 386H367Q367 388 361 392T340 400T306 404Q276 404 249 390Q228 381 206 359Q162 315 142 235T121 119Q121 73 147 50Q169 26 205 26H209Q321 26 394 111Q403 121 406 121Q410 121 419 112T429 98T420 83T391 55T346 25T282 0T202 -11Q127 -11 81 37T34 159Z"></path></g><g data-mml-node="mn" transform="translate(466,-150) scale(0.707)"><path data-c="32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"></path></g></g><g data-mml-node="mi" transform="translate(9873.6,0)"><path data-c="1D453" d="M118 -162Q120 -162 124 -164T135 -167T147 -168Q160 -168 171 -155T187 -126Q197 -99 221 27T267 267T289 382V385H242Q195 385 192 387Q188 390 188 397L195 425Q197 430 203 430T250 431Q298 431 298 432Q298 434 307 482T319 540Q356 705 465 705Q502 703 526 683T550 630Q550 594 529 578T487 561Q443 561 443 603Q443 622 454 636T478 657L487 662Q471 668 457 668Q445 668 434 658T419 630Q412 601 403 552T387 469T380 433Q380 431 435 431Q480 431 487 430T498 424Q499 420 496 407T491 391Q489 386 482 386T428 385H372L349 263Q301 15 282 -47Q255 -132 212 -173Q175 -205 139 -205Q107 -205 81 -186T55 -132Q55 -95 76 -78T118 -61Q162 -61 162 -103Q162 -122 151 -136T127 -157L118 -162Z"></path></g><g data-mml-node="mo" transform="translate(10423.6,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path></g><g data-mml-node="mi" transform="translate(10812.6,0)"><path data-c="1D45B" d="M21 287Q22 293 24 303T36 341T56 388T89 425T135 442Q171 442 195 424T225 390T231 369Q231 367 232 367L243 378Q304 442 382 442Q436 442 469 415T503 336T465 179T427 52Q427 26 444 26Q450 26 453 27Q482 32 505 65T540 145Q542 153 560 153Q580 153 580 145Q580 144 576 130Q568 101 554 73T508 17T439 -10Q392 -10 371 17T350 73Q350 92 386 193T423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 180T152 343Q153 348 153 366Q153 405 129 405Q91 405 66 305Q60 285 60 284Q58 278 41 278H27Q21 284 21 287Z"></path></g><g data-mml-node="mo" transform="translate(11634.8,0)"><path data-c="2212" d="M84 237T84 250T98 270H679Q694 262 694 250T679 230H98Q84 237 84 250Z"></path></g><g data-mml-node="mn" transform="translate(12635,0)"><path data-c="32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"></path></g><g data-mml-node="mo" transform="translate(13135,0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path></g><g data-mml-node="mo" transform="translate(13746.2,0)"><path data-c="2B" d="M56 237T56 250T70 270H369V420L370 570Q380 583 389 583Q402 583 409 568V270H707Q722 262 722 250T707 230H409V-68Q401 -82 391 -82H389H387Q375 -82 369 -68V230H70Q56 237 56 250Z"></path></g><g data-mml-node="mo" transform="translate(14746.4,0)"><path data-c="2026" d="M78 60Q78 84 95 102T138 120Q162 120 180 104T199 61Q199 36 182 18T139 0T96 17T78 60ZM525 60Q525 84 542 102T585 120Q609 120 627 104T646 61Q646 36 629 18T586 0T543 17T525 60ZM972 60Q972 84 989 102T1032 120Q1056 120 1074 104T1093 61Q1093 36 1076 18T1033 0T990 17T972 60Z"></path></g><g data-mml-node="mo" transform="translate(16140.7,0)"><path data-c="2B" d="M56 237T56 250T70 270H369V420L370 570Q380 583 389 583Q402 583 409 568V270H707Q722 262 722 250T707 230H409V-68Q401 -82 391 -82H389H387Q375 -82 369 -68V230H70Q56 237 56 250Z"></path></g><g data-mml-node="msub" transform="translate(17140.9,0)"><g data-mml-node="mi"><path data-c="1D450" d="M34 159Q34 268 120 355T306 442Q362 442 394 418T427 355Q427 326 408 306T360 285Q341 285 330 295T319 325T330 359T352 380T366 386H367Q367 388 361 392T340 400T306 404Q276 404 249 390Q228 381 206 359Q162 315 142 235T121 119Q121 73 147 50Q169 26 205 26H209Q321 26 394 111Q403 121 406 121Q410 121 419 112T429 98T420 83T391 55T346 25T282 0T202 -11Q127 -11 81 37T34 159Z"></path></g><g data-mml-node="mi" transform="translate(466,-150) scale(0.707)"><path data-c="1D458" d="M121 647Q121 657 125 670T137 683Q138 683 209 688T282 694Q294 694 294 686Q294 679 244 477Q194 279 194 272Q213 282 223 291Q247 309 292 354T362 415Q402 442 438 442Q468 442 485 423T503 369Q503 344 496 327T477 302T456 291T438 288Q418 288 406 299T394 328Q394 353 410 369T442 390L458 393Q446 405 434 405H430Q398 402 367 380T294 316T228 255Q230 254 243 252T267 246T293 238T320 224T342 206T359 180T365 147Q365 130 360 106T354 66Q354 26 381 26Q429 26 459 145Q461 153 479 153H483Q499 153 499 144Q499 139 496 130Q455 -11 378 -11Q333 -11 305 15T277 90Q277 108 280 121T283 145Q283 167 269 183T234 206T200 217T182 220H180Q168 178 159 139T145 81T136 44T129 20T122 7T111 -2Q98 -11 83 -11Q66 -11 57 -1T48 16Q48 26 85 176T158 471L195 616Q196 629 188 632T149 637H144Q134 637 131 637T124 640T121 647Z"></path></g></g><g data-mml-node="mi" transform="translate(18025.3,0)"><path data-c="1D453" d="M118 -162Q120 -162 124 -164T135 -167T147 -168Q160 -168 171 -155T187 -126Q197 -99 221 27T267 267T289 382V385H242Q195 385 192 387Q188 390 188 397L195 425Q197 430 203 430T250 431Q298 431 298 432Q298 434 307 482T319 540Q356 705 465 705Q502 703 526 683T550 630Q550 594 529 578T487 561Q443 561 443 603Q443 622 454 636T478 657L487 662Q471 668 457 668Q445 668 434 658T419 630Q412 601 403 552T387 469T380 433Q380 431 435 431Q480 431 487 430T498 424Q499 420 496 407T491 391Q489 386 482 386T428 385H372L349 263Q301 15 282 -47Q255 -132 212 -173Q175 -205 139 -205Q107 -205 81 -186T55 -132Q55 -95 76 -78T118 -61Q162 -61 162 -103Q162 -122 151 -136T127 -157L118 -162Z"></path></g><g data-mml-node="mo" transform="translate(18575.3,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path></g><g data-mml-node="mi" transform="translate(18964.3,0)"><path data-c="1D45B" d="M21 287Q22 293 24 303T36 341T56 388T89 425T135 442Q171 442 195 424T225 390T231 369Q231 367 232 367L243 378Q304 442 382 442Q436 442 469 415T503 336T465 179T427 52Q427 26 444 26Q450 26 453 27Q482 32 505 65T540 145Q542 153 560 153Q580 153 580 145Q580 144 576 130Q568 101 554 73T508 17T439 -10Q392 -10 371 17T350 73Q350 92 386 193T423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 180T152 343Q153 348 153 366Q153 405 129 405Q91 405 66 305Q60 285 60 284Q58 278 41 278H27Q21 284 21 287Z"></path></g><g data-mml-node="mo" transform="translate(19786.5,0)"><path data-c="2212" d="M84 237T84 250T98 270H679Q694 262 694 250T679 230H98Q84 237 84 250Z"></path></g><g data-mml-node="mi" transform="translate(20786.7,0)"><path data-c="1D458" d="M121 647Q121 657 125 670T137 683Q138 683 209 688T282 694Q294 694 294 686Q294 679 244 477Q194 279 194 272Q213 282 223 291Q247 309 292 354T362 415Q402 442 438 442Q468 442 485 423T503 369Q503 344 496 327T477 302T456 291T438 288Q418 288 406 299T394 328Q394 353 410 369T442 390L458 393Q446 405 434 405H430Q398 402 367 380T294 316T228 255Q230 254 243 252T267 246T293 238T320 224T342 206T359 180T365 147Q365 130 360 106T354 66Q354 26 381 26Q429 26 459 145Q461 153 479 153H483Q499 153 499 144Q499 139 496 130Q455 -11 378 -11Q333 -11 305 15T277 90Q277 108 280 121T283 145Q283 167 269 183T234 206T200 217T182 220H180Q168 178 159 139T145 81T136 44T129 20T122 7T111 -2Q98 -11 83 -11Q66 -11 57 -1T48 16Q48 26 85 176T158 471L195 616Q196 629 188 632T149 637H144Q134 637 131 637T124 640T121 647Z"></path></g><g data-mml-node="mo" transform="translate(21307.7,0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path></g></g></g></svg></mjx-container></p>
<ol>
<li class="lvl-3">
<p><strong>k维一阶</strong></p>
</li>
</ol>
<p><mjx-container class="MathJax" jax="SVG" display="true"><svg style="vertical-align: -0.186ex;" xmlns="http://www.w3.org/2000/svg" width="15.258ex" height="1.805ex" role="img" focusable="false" viewBox="0 -716 6744 798"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="TeXAtom" data-mjx-texclass="ORD"><g data-mml-node="mi"><path data-c="1D417" d="M327 0Q306 3 174 3Q52 3 43 0H33V62H98L162 63L360 333L157 624H48V686H59Q80 683 217 683Q368 683 395 686H408V624H335L393 540L452 458L573 623Q573 624 528 624H483V686H494Q515 683 646 683Q769 683 778 686H787V624H658L575 511Q493 398 493 397L508 376Q522 356 553 312T611 229L727 62H835V0H824Q803 3 667 3Q516 3 489 0H476V62H513L549 63L401 274L247 63Q247 62 292 62H338V0H327Z"></path></g></g><g data-mml-node="mi" transform="translate(869,0)"><path data-c="1D45B" d="M21 287Q22 293 24 303T36 341T56 388T89 425T135 442Q171 442 195 424T225 390T231 369Q231 367 232 367L243 378Q304 442 382 442Q436 442 469 415T503 336T465 179T427 52Q427 26 444 26Q450 26 453 27Q482 32 505 65T540 145Q542 153 560 153Q580 153 580 145Q580 144 576 130Q568 101 554 73T508 17T439 -10Q392 -10 371 17T350 73Q350 92 386 193T423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 180T152 343Q153 348 153 366Q153 405 129 405Q91 405 66 305Q60 285 60 284Q58 278 41 278H27Q21 284 21 287Z"></path></g><g data-mml-node="mo" transform="translate(1746.8,0)"><path data-c="3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path></g><g data-mml-node="mi" transform="translate(2802.6,0)"><path data-c="1D434" d="M208 74Q208 50 254 46Q272 46 272 35Q272 34 270 22Q267 8 264 4T251 0Q249 0 239 0T205 1T141 2Q70 2 50 0H42Q35 7 35 11Q37 38 48 46H62Q132 49 164 96Q170 102 345 401T523 704Q530 716 547 716H555H572Q578 707 578 706L606 383Q634 60 636 57Q641 46 701 46Q726 46 726 36Q726 34 723 22Q720 7 718 4T704 0Q701 0 690 0T651 1T578 2Q484 2 455 0H443Q437 6 437 9T439 27Q443 40 445 43L449 46H469Q523 49 533 63L521 213H283L249 155Q208 86 208 74ZM516 260Q516 271 504 416T490 562L463 519Q447 492 400 412L310 260L413 259Q516 259 516 260Z"></path></g><g data-mml-node="TeXAtom" data-mjx-texclass="ORD" transform="translate(3552.6,0)"><g data-mml-node="mi"><path data-c="1D417" d="M327 0Q306 3 174 3Q52 3 43 0H33V62H98L162 63L360 333L157 624H48V686H59Q80 683 217 683Q368 683 395 686H408V624H335L393 540L452 458L573 623Q573 624 528 624H483V686H494Q515 683 646 683Q769 683 778 686H787V624H658L575 511Q493 398 493 397L508 376Q522 356 553 312T611 229L727 62H835V0H824Q803 3 667 3Q516 3 489 0H476V62H513L549 63L401 274L247 63Q247 62 292 62H338V0H327Z"></path></g></g><g data-mml-node="TeXAtom" data-mjx-texclass="ORD" transform="translate(4421.6,0)"><g data-mml-node="mi"><path data-c="1D45B" d="M21 287Q22 293 24 303T36 341T56 388T89 425T135 442Q171 442 195 424T225 390T231 369Q231 367 232 367L243 378Q304 442 382 442Q436 442 469 415T503 336T465 179T427 52Q427 26 444 26Q450 26 453 27Q482 32 505 65T540 145Q542 153 560 153Q580 153 580 145Q580 144 576 130Q568 101 554 73T508 17T439 -10Q392 -10 371 17T350 73Q350 92 386 193T423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 180T152 343Q153 348 153 366Q153 405 129 405Q91 405 66 305Q60 285 60 284Q58 278 41 278H27Q21 284 21 287Z"></path></g><g data-mml-node="mo" transform="translate(822.2,0)"><path data-c="2212" d="M84 237T84 250T98 270H679Q694 262 694 250T679 230H98Q84 237 84 250Z"></path></g><g data-mml-node="mn" transform="translate(1822.4,0)"><path data-c="31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path></g></g></g></g></svg></mjx-container></p>
<aside>
💡
<p>相当于 第 i 位置的 ans 需要第 i-1 位置的 ans（可能是二维的，以为着需要 i-1 位置的多个答案）</p>
<h3 id="矩阵快速幂的基本伪代码">矩阵快速幂的基本伪代码</h3>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">vector&lt;vector&lt;<span class="type">int</span>&gt;&gt; <span class="built_in">multiply</span>(vector&lt;vector&lt;<span class="type">int</span>&gt;&gt; a, vector&lt;vector&lt;<span class="type">int</span>&gt;&gt; b){</span><br><span class="line">    <span class="type">int</span> n = a.<span class="built_in">size</span>();</span><br><span class="line">    <span class="type">int</span> m = b[<span class="number">0</span>].<span class="built_in">size</span>();</span><br><span class="line">    <span class="type">int</span> k = a[<span class="number">0</span>].<span class="built_in">size</span>();</span><br><span class="line">    vector&lt;vector&lt;<span class="type">int</span>&gt;&gt; <span class="built_in">ans</span>(n, <span class="built_in">vector</span>&lt;<span class="type">int</span>&gt;(m));</span><br><span class="line">    <span class="comment">// ans[i][j] == a的 第i行 * b的 第j列</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; i++){</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> j = <span class="number">0</span>; j &lt; m; j++){</span><br><span class="line">            <span class="type">int</span> temp = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> t = <span class="number">0</span>; t &lt; k; t++){</span><br><span class="line">                ans[i][j] +=a[i][t] * b[t][j];</span><br><span class="line">            }</span><br><span class="line">         </span><br><span class="line">        }</span><br><span class="line">    } </span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line">vector&lt;vector&lt;<span class="type">int</span>&gt;&gt; <span class="built_in">power</span>(vector&lt;vector&lt;<span class="type">int</span>&gt;&gt; a, <span class="type">int</span> t){</span><br><span class="line">    <span class="type">int</span> n = a.<span class="built_in">size</span>();</span><br><span class="line">    vector&lt;vector&lt;<span class="type">int</span>&gt;&gt; <span class="built_in">ans</span>(n, <span class="built_in">vector</span>&lt;<span class="type">int</span>&gt; (n, <span class="number">0</span>));</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; i++) ans[i][i] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span>(t){</span><br><span class="line">        <span class="keyword">if</span>(t &amp; <span class="number">1</span>) ans = <span class="built_in">multiply</span>(ans, a);</span><br><span class="line">        a = <span class="built_in">multiply</span>(a, a);</span><br><span class="line">        t &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">    }</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">}</span><br><span class="line"></span><br></pre></td></tr></table></figure>
</aside></aside></aside></aside></aside></aside></aside></aside></aside></aside></aside></aside></aside></aside></aside></aside></aside></aside></aside></aside></aside></aside></aside></aside></aside></aside></aside></aside></div><div class="article-licensing box"><div class="licensing-title"><p>老算法笔记</p><p><a href="http://whalefall.fun/2025/03/25/老算法笔记/">http://whalefall.fun/2025/03/25/老算法笔记/</a></p></div><div class="licensing-meta level is-mobile"><div class="level-left"><div class="level-item is-narrow"><div><h6>作者</h6><p>Jiely</p></div></div><div class="level-item is-narrow"><div><h6>发布于</h6><p>2025-03-25</p></div></div><div class="level-item is-narrow"><div><h6>更新于</h6><p>2025-07-26</p></div></div><div class="level-item is-narrow"><div><h6>许可协议</h6><p><a class="icons" rel="noopener" target="_blank" title="Creative Commons" href="https://creativecommons.org/"><i class="icon fab fa-creative-commons"></i></a><a class="icons" rel="noopener" target="_blank" title="Attribution" href="https://creativecommons.org/licenses/by/4.0/"><i class="icon fab fa-creative-commons-by"></i></a><a class="icons" rel="noopener" target="_blank" title="Noncommercial" href="https://creativecommons.org/licenses/by-nc/4.0/"><i class="icon fab fa-creative-commons-nc"></i></a></p></div></div></div></div></div><div class="article-tags is-size-7 mb-4"><span class="mr-2">#</span><a class="link-muted mr-2" rel="tag" href="/tags/%E7%83%AD%E7%88%B1/">热爱</a></div><!--!--></article></div><!--!--><div class="card"><nav class="post-navigation mt-4 level is-mobile card-content"><div class="level-start"><a class="article-nav-prev level level-item link-muted" href="/2025/04/12/%E6%95%B0%E6%8D%AE%E5%BA%93%E5%9F%BA%E7%A1%80/"><i class="level-item fas fa-chevron-left"></i><span class="level-item">数据库基础学习</span></a></div><div class="level-end"><a class="article-nav-next level level-item link-muted" href="/2025/03/25/%E5%8D%9A%E5%AE%A2%E5%BC%80%E7%AB%AF/"><span class="level-item">第一个博客！新的世界！</span><i class="level-item fas fa-chevron-right"></i></a></div></nav></div><div class="card" id="comments"><div class="card-content"><h3 class="title is-5">评论</h3><div class="content twikoo" id="twikoo"></div><script src="https://cdn.jsdelivr.net/npm/twikoo@1.6.44/dist/twikoo.all.min.js"></script><script>twikoo.init({
            envId: 'https://visionary-gecko-25af79.netlify.app/.netlify/functions/twikoo',
            
            lang: "zh-CN",
            onCommentLoaded: function () {
              var commentContents = document.getElementsByClassName('tk-content');
              for (var i = 0; i < commentContents.length; i++) {
                var commentItem = commentContents[i];
                var imgEls = commentItem.getElementsByTagName('img');
                if (imgEls.length > 0) {
                  for (var j = 0; j < imgEls.length; j++) {
                    var imgEl = imgEls[j];
                    var aEl = document.createElement('a');
                    aEl.setAttribute('class', 'tk-lg-link');
                    aEl.setAttribute('href', imgEl.getAttribute('src'));
                    aEl.setAttribute('data-src', imgEl.getAttribute('src'));
                    aEl.appendChild(imgEl.cloneNode(false));
                    imgEl.parentNode.insertBefore(aEl, imgEl.nextSibling);
                    imgEl.remove();
                  }
                  if (typeof $.fn.lightGallery === 'function') {
                    $(commentItem).lightGallery({
                      selector: '.tk-lg-link'
                    });
                  }
                }
                handleThirdPartyLink && handleThirdPartyLink(commentItem);
              }
            }
        });</script></div></div></div><style>.column.column-left,.column.column-right{display:none}</style><div class="column column-left is-4-tablet is-4-desktop is-3-widescreen  order-1"><div class="card widget toc-widget" id="toc" data-type="toc"><div class="toc-header"><h3 class="menu-label"><i class="fas fa-list toc-icon"></i>目录</h3></div><div class="toc-content"><ul class="toc-list toc-level-1"><li class="toc-item toc-h2"><a class="toc-link" href="#" data-level="2" data-target=""><span class="toc-index">1</span><span class="toc-text">左神课程笔记</span></a></li><li class="toc-item toc-h2"><a class="toc-link" href="#" data-level="2" data-target=""><span class="toc-index">2</span><span class="toc-text">前置基本问题：</span></a><ul class="toc-list toc-level-2"><li class="toc-item toc-h3"><a class="toc-link" href="#1-归并分治算法" data-level="3" data-target="1-归并分治算法"><span class="toc-index">2.1</span><span class="toc-text">1. 归并分治算法</span></a><ul class="toc-list toc-level-3"><li class="toc-item toc-h4"><a class="toc-link" href="#大范围的答案-等不等于-左边部分-右边部分-跨越左右两边的答案" data-level="4" data-target="大范围的答案-等不等于-左边部分-右边部分-跨越左右两边的答案"><span class="toc-index">2.1.1</span><span class="toc-text">大范围的答案  等不等于 左边部分 + 右边部分 + 跨越左右两边的答案</span></a></li></ul></li><li class="toc-item toc-h3"><a class="toc-link" href="#2-随机快速排序" data-level="3" data-target="2-随机快速排序"><span class="toc-index">2.2</span><span class="toc-text">2. 随机快速排序</span></a><ul class="toc-list toc-level-3"><li class="toc-item toc-h4"><a class="toc-link" href="#可以用-partition-来寻找-第k大-第k小-荷兰国旗问题" data-level="4" data-target="可以用-partition-来寻找-第k大-第k小-荷兰国旗问题"><span class="toc-index">2.2.1</span><span class="toc-text">可以用 partition 来寻找 第k大 第k小 (荷兰国旗问题)</span></a></li></ul></li><li class="toc-item toc-h3"><a class="toc-link" href="#构建前缀信息（46）" data-level="3" data-target="构建前缀信息（46）"><span class="toc-index">2.3</span><span class="toc-text">构建前缀信息（46）</span></a></li><li class="toc-item toc-h3"><a class="toc-link" href="#单调队列" data-level="3" data-target="单调队列"><span class="toc-index">2.4</span><span class="toc-text">单调队列</span></a><ul class="toc-list toc-level-3"><li class="toc-item toc-h4"><a class="toc-link" href="#优先队列扩展" data-level="4" data-target="优先队列扩展"><span class="toc-index">2.4.1</span><span class="toc-text">优先队列扩展</span></a></li><li class="toc-item toc-h4"><a class="toc-link" href="#双端队列吃药任务安排" data-level="4" data-target="双端队列吃药任务安排"><span class="toc-index">2.4.2</span><span class="toc-text">双端队列吃药任务安排</span></a></li></ul></li><li class="toc-item toc-h3"><a class="toc-link" href="#单调栈" data-level="3" data-target="单调栈"><span class="toc-index">2.5</span><span class="toc-text">单调栈</span></a><ul class="toc-list toc-level-3"><li class="toc-item toc-h4"><a class="toc-link" href="#实现最小字典序（单调栈）" data-level="4" data-target="实现最小字典序（单调栈）"><span class="toc-index">2.5.1</span><span class="toc-text">实现最小字典序（单调栈）</span></a></li></ul></li><li class="toc-item toc-h3"><a class="toc-link" href="#滑动窗口-双指针（视频）" data-level="3" data-target="滑动窗口-双指针（视频）"><span class="toc-index">2.6</span><span class="toc-text">滑动窗口 + 双指针（视频）</span></a></li></ul></li><li class="toc-item toc-h2"><a class="toc-link" href="#" data-level="2" data-target=""><span class="toc-index">3</span><span class="toc-text">数据结构</span></a><ul class="toc-list toc-level-2"><li class="toc-item toc-h3"><a class="toc-link" href="#前缀树（字典树）" data-level="3" data-target="前缀树（字典树）"><span class="toc-index">3.1</span><span class="toc-text">前缀树（字典树）</span></a><ul class="toc-list toc-level-3"><li class="toc-item toc-h4"><a class="toc-link" href="#以下是关于-字典树-二进制运算：" data-level="4" data-target="以下是关于-字典树-二进制运算："><span class="toc-index">3.1.1</span><span class="toc-text">以下是关于 字典树 + 二进制运算：</span></a></li></ul></li><li class="toc-item toc-h3"><a class="toc-link" href="#单调栈-单调队列" data-level="3" data-target="单调栈-单调队列"><span class="toc-index">3.2</span><span class="toc-text">单调栈 + 单调队列</span></a></li><li class="toc-item toc-h3"><a class="toc-link" href="#并查集（模版）" data-level="3" data-target="并查集（模版）"><span class="toc-index">3.3</span><span class="toc-text">并查集（模版）</span></a><ul class="toc-list toc-level-3"><li class="toc-item toc-h4"><a class="toc-link" href="#基本建图方法" data-level="4" data-target="基本建图方法"><span class="toc-index">3.3.1</span><span class="toc-text">基本建图方法</span></a></li></ul></li><li class="toc-item toc-h3"><a class="toc-link" href="#拓扑排序" data-level="3" data-target="拓扑排序"><span class="toc-index">3.4</span><span class="toc-text">拓扑排序</span></a><ul class="toc-list toc-level-3"><li class="toc-item toc-h4"><a class="toc-link" href="#拓扑排序扩展知识（类似树型dp）" data-level="4" data-target="拓扑排序扩展知识（类似树型dp）"><span class="toc-index">3.4.1</span><span class="toc-text">拓扑排序扩展知识（类似树型dp）</span></a></li></ul></li><li class="toc-item toc-h3"><a class="toc-link" href="#倍增算法-ST表（用于区间查询最值，gcd）-先看-基础dp" data-level="3" data-target="倍增算法-ST表（用于区间查询最值，gcd）-先看-基础dp"><span class="toc-index">3.5</span><span class="toc-text">倍增算法 + ST表（用于区间查询最值，gcd）(先看 基础dp )</span></a></li><li class="toc-item toc-h3"><a class="toc-link" href="#树上问题" data-level="3" data-target="树上问题"><span class="toc-index">3.6</span><span class="toc-text">树上问题</span></a><ul class="toc-list toc-level-3"><li class="toc-item toc-h4"><a class="toc-link" href="#树上倍增-LCA" data-level="4" data-target="树上倍增-LCA"><span class="toc-index">3.6.1</span><span class="toc-text">树上倍增 + LCA</span></a></li><li class="toc-item toc-h4"><a class="toc-link" href="#树的重心（有一个或者两个）" data-level="4" data-target="树的重心（有一个或者两个）"><span class="toc-index">3.6.2</span><span class="toc-text">树的重心（有一个或者两个）</span></a></li><li class="toc-item toc-h4"><a class="toc-link" href="#树的直径" data-level="4" data-target="树的直径"><span class="toc-index">3.6.3</span><span class="toc-text">树的直径</span></a></li><li class="toc-item toc-h4"><a class="toc-link" href="#树上差分" data-level="4" data-target="树上差分"><span class="toc-index">3.6.4</span><span class="toc-text">树上差分</span></a></li></ul></li><li class="toc-item toc-h3"><a class="toc-link" href="#树状数组（视频）" data-level="3" data-target="树状数组（视频）"><span class="toc-index">3.7</span><span class="toc-text">树状数组（视频）</span></a><ul class="toc-list toc-level-3"><li class="toc-item toc-h4"><a class="toc-link" href="#维护-两个差分数组-Di-（i-1-Di" data-level="4" data-target="维护-两个差分数组-Di-（i-1-Di"><span class="toc-index">3.7.1</span><span class="toc-text">维护 两个差分数组 Di  +  （i - 1) * Di</span></a></li><li class="toc-item toc-h4"><a class="toc-link" href="#逆序队问题" data-level="4" data-target="逆序队问题"><span class="toc-index">3.7.2</span><span class="toc-text">逆序队问题</span></a></li></ul></li><li class="toc-item toc-h3"><a class="toc-link" href="#线段树" data-level="3" data-target="线段树"><span class="toc-index">3.8</span><span class="toc-text">线段树</span></a></li></ul></li><li class="toc-item toc-h2"><a class="toc-link" href="#" data-level="2" data-target=""><span class="toc-index">4</span><span class="toc-text">动态规划（先做题目）</span></a><ul class="toc-list toc-level-2"><li class="toc-item toc-h3"><a class="toc-link" href="#背包dp-（66-75）" data-level="3" data-target="背包dp-（66-75）"><span class="toc-index">4.1</span><span class="toc-text">背包dp （66 - 75）</span></a></li><li class="toc-item toc-h3"><a class="toc-link" href="#区间dp" data-level="3" data-target="区间dp"><span class="toc-index">4.2</span><span class="toc-text">区间dp</span></a></li><li class="toc-item toc-h3"><a class="toc-link" href="#状态dp" data-level="3" data-target="状态dp"><span class="toc-index">4.3</span><span class="toc-text">状态dp</span></a></li><li class="toc-item toc-h3"><a class="toc-link" href="#树型dp" data-level="3" data-target="树型dp"><span class="toc-index">4.4</span><span class="toc-text">树型dp</span></a></li><li class="toc-item toc-h3"><a class="toc-link" href="#数位dp" data-level="3" data-target="数位dp"><span class="toc-index">4.5</span><span class="toc-text">数位dp</span></a></li><li class="toc-item toc-h3"><a class="toc-link" href="#换根dp" data-level="3" data-target="换根dp"><span class="toc-index">4.6</span><span class="toc-text">换根dp</span></a></li><li class="toc-item toc-h3"><a class="toc-link" href="#轮廓线dp" data-level="3" data-target="轮廓线dp"><span class="toc-index">4.7</span><span class="toc-text">轮廓线dp</span></a></li><li class="toc-item toc-h3"><a class="toc-link" href="#三进制状压dp" data-level="3" data-target="三进制状压dp"><span class="toc-index">4.8</span><span class="toc-text">三进制状压dp</span></a></li><li class="toc-item toc-h3"><a class="toc-link" href="#dp优化" data-level="3" data-target="dp优化"><span class="toc-index">4.9</span><span class="toc-text">dp优化</span></a></li></ul></li><li class="toc-item toc-h2"><a class="toc-link" href="#" data-level="2" data-target=""><span class="toc-index">5</span><span class="toc-text">字符串</span></a><ul class="toc-list toc-level-2"><li class="toc-item toc-h3"><a class="toc-link" href="#KMP" data-level="3" data-target="KMP"><span class="toc-index">5.1</span><span class="toc-text">KMP</span></a><ul class="toc-list toc-level-3"><li class="toc-item toc-h4"><a class="toc-link" href="#扩展-KMP-（Z数组）前缀匹配问题" data-level="4" data-target="扩展-KMP-（Z数组）前缀匹配问题"><span class="toc-index">5.1.1</span><span class="toc-text">扩展 KMP （Z数组）前缀匹配问题</span></a></li></ul></li><li class="toc-item toc-h3"><a class="toc-link" href="#Manacher" data-level="3" data-target="Manacher"><span class="toc-index">5.2</span><span class="toc-text">Manacher</span></a></li><li class="toc-item toc-h3"><a class="toc-link" href="#AC自动机" data-level="3" data-target="AC自动机"><span class="toc-index">5.3</span><span class="toc-text">AC自动机</span></a></li><li class="toc-item toc-h3"><a class="toc-link" href="#字符串哈希" data-level="3" data-target="字符串哈希"><span class="toc-index">5.4</span><span class="toc-text">字符串哈希</span></a></li></ul></li><li class="toc-item toc-h2"><a class="toc-link" href="#" data-level="2" data-target=""><span class="toc-index">6</span><span class="toc-text">数学</span></a><ul class="toc-list toc-level-2"><li class="toc-item toc-h3"><a class="toc-link" href="#埃式筛" data-level="3" data-target="埃式筛"><span class="toc-index">6.1</span><span class="toc-text">埃式筛</span></a></li><li class="toc-item toc-h3"><a class="toc-link" href="#乘法逆元" data-level="3" data-target="乘法逆元"><span class="toc-index">6.2</span><span class="toc-text">乘法逆元</span></a></li><li class="toc-item toc-h3"><a class="toc-link" href="#容斥原理" data-level="3" data-target="容斥原理"><span class="toc-index">6.3</span><span class="toc-text">容斥原理</span></a></li><li class="toc-item toc-h3"><a class="toc-link" href="#快速幂" data-level="3" data-target="快速幂"><span class="toc-index">6.4</span><span class="toc-text">快速幂</span></a><ul class="toc-list toc-level-3"><li class="toc-item toc-h4"><a class="toc-link" href="#矩阵快速幂的基本伪代码" data-level="4" data-target="矩阵快速幂的基本伪代码"><span class="toc-index">6.4.1</span><span class="toc-text">矩阵快速幂的基本伪代码</span></a></li></ul></li></ul></li></ul></div><style>
            .toc-widget {
                position: sticky;
                top: 1rem;
                max-height: calc(100vh - 2rem);
                display: flex;
                flex-direction: column;
            }
            
            .toc-header {
                flex-shrink: 0;
                padding: 1.25rem 1.25rem 0.75rem;
                border-bottom: 1px solid #e8e8e8;
                background: white;
                border-radius: 0.375rem 0.375rem 0 0;
            }
            
            .toc-header .menu-label {
                margin: 0;
                font-size: 1rem;
                font-weight: 600;
                color: #363636;
                display: flex;
                align-items: center;
            }
            
            .toc-header .toc-icon {
                margin-right: 0.5rem;
                color: #3273dc;
            }
            
            .toc-content {
                flex: 1;
                overflow-y: auto;
                padding: 0.75rem 1.25rem 1.25rem;
                background: white;
                border-radius: 0 0 0.375rem 0.375rem;
                max-height: 400px;
            }
            
            .toc-content::-webkit-scrollbar {
                width: 6px;
            }
            
            .toc-content::-webkit-scrollbar-track {
                background: #f1f1f1;
                border-radius: 3px;
            }
            
            .toc-content::-webkit-scrollbar-thumb {
                background: #c1c1c1;
                border-radius: 3px;
            }
            
            .toc-content::-webkit-scrollbar-thumb:hover {
                background: #a8a8a8;
            }
            
            .toc-list {
                list-style: none;
                margin: 0;
                padding: 0;
            }
            
            .toc-item {
                margin: 0;
                position: relative;
            }
            
            .toc-link {
                display: flex;
                align-items: flex-start;
                padding: 0.4rem 0;
                text-decoration: none;
                color: #4a4a4a;
                transition: all 0.2s ease;
                border-radius: 4px;
                line-height: 1.4;
            }
            
            .toc-link:hover {
                color: #3273dc;
                background-color: rgba(50, 115, 220, 0.05);
                transform: translateX(2px);
            }
            
            .toc-link.is-active {
                color: #3273dc;
                background-color: rgba(50, 115, 220, 0.15);
                font-weight: 600;
                border-left: 3px solid #3273dc;
                padding-left: calc(0.4rem + 3px);
                margin-left: -3px;
                box-shadow: 0 2px 4px rgba(50, 115, 220, 0.1);
            }
            
            .toc-link.is-active .toc-index {
                color: #3273dc;
                font-weight: 700;
            }
            
            .toc-link.is-active .toc-text {
                color: #3273dc;
                font-weight: 600;
            }
            
            .toc-index {
                color: #3273dc;
                font-weight: 500;
                margin-right: 0.5rem;
                font-size: 0.85rem;
                flex-shrink: 0;
                min-width: 2rem;
            }
            
            .toc-text {
                flex: 1;
                overflow: hidden;
                text-overflow: ellipsis;
                display: -webkit-box;
                -webkit-line-clamp: 2;
                -webkit-box-orient: vertical;
            }
            
            /* 不同层级的样式 */
            .toc-h1 .toc-link {
                font-size: 0.95rem;
                font-weight: 500;
                padding-left: 0;
            }
            
            .toc-h1 .toc-link.is-active {
                padding-left: 3px;
            }
            
            .toc-h2 .toc-link {
                font-size: 0.9rem;
                padding-left: 1rem;
                position: relative;
            }
            
            .toc-h2 .toc-link.is-active {
                padding-left: calc(1rem + 3px);
            }
            
            .toc-h2 .toc-link:before {
                content: '';
                position: absolute;
                left: 0.5rem;
                top: 50%;
                width: 4px;
                height: 4px;
                background: #dbdbdb;
                border-radius: 50%;
                transform: translateY(-50%);
            }
            
            .toc-h2 .toc-link.is-active:before {
                background: #3273dc;
                left: calc(0.5rem + 3px);
            }
            
            .toc-h3 .toc-link {
                font-size: 0.85rem;
                padding-left: 2rem;
                color: #7a7a7a;
            }
            
            .toc-h3 .toc-link.is-active {
                padding-left: calc(2rem + 3px);
            }
            
            .toc-h4 .toc-link,
            .toc-h5 .toc-link,
            .toc-h6 .toc-link {
                font-size: 0.8rem;
                padding-left: 2.5rem;
                color: #999;
            }
            
            .toc-h4 .toc-link.is-active,
            .toc-h5 .toc-link.is-active,
            .toc-h6 .toc-link.is-active {
                padding-left: calc(2.5rem + 3px);
            }
            
            /* 嵌套列表样式 */
            .toc-level-1 {
                margin-top: 0;
            }
            
            .toc-level-2,
            .toc-level-3 {
                margin-top: 0.25rem;
                padding-left: 0;
            }
            
            /* 滚动渐变效果 */
            .toc-content {
                position: relative;
            }
            
            .toc-content:before {
                content: '';
                position: absolute;
                top: 0;
                left: 0;
                right: 0;
                height: 10px;
                background: linear-gradient(to bottom, white, transparent);
                pointer-events: none;
                z-index: 1;
            }
            
            .toc-content:after {
                content: '';
                position: absolute;
                bottom: 0;
                left: 0;
                right: 0;
                height: 10px;
                background: linear-gradient(to top, white, transparent);
                pointer-events: none;
                z-index: 1;
            }
            
            /* 响应式设计 */
            @media (max-width: 768px) {
                .toc-widget {
                    max-height: 300px;
                }
                
                .toc-content {
                    max-height: 250px;
                }
            }
        </style><script src="/js/toc.js" defer></script><script>
            (function() {
                let currentActiveLink = null;
                let headings = [];
                let tocLinks = [];
                let isUserScrolling = true;
                let scrollTimeout = null;
                
                // 配置常量 - 当标题到达页面中间偏上位置时激活
                const SCROLL_OFFSET = 80; // 点击滚动时的偏移量
                const ACTIVATION_POSITION = window.innerHeight * 0.3; // 激活位置：视口高度的30%处（中间偏上）
                
                function initTocTracking() {
                    // 获取所有标题元素
                    headings = Array.from(document.querySelectorAll('h1, h2, h3, h4, h5, h6')).filter(h => h.id);
                    
                    // 获取所有TOC链接
                    tocLinks = Array.from(document.querySelectorAll('.toc-link[data-target]'));
                    
                    if (headings.length === 0 || tocLinks.length === 0) return;
                    
                    // 为TOC链接添加点击事件
                    tocLinks.forEach(link => {
                        link.addEventListener('click', (e) => {
                            e.preventDefault();
                            const targetId = link.getAttribute('data-target');
                            const targetElement = document.getElementById(targetId);
                            
                            if (targetElement) {
                                isUserScrolling = false; // 标记为程序控制的滚动
                                
                                const targetPosition = targetElement.getBoundingClientRect().top + window.pageYOffset - SCROLL_OFFSET;
                                
                                window.scrollTo({
                                    top: targetPosition,
                                    behavior: 'smooth'
                                });
                                
                                // 立即更新激活状态
                                updateActiveLink(targetId);
                                
                                // 滚动完成后恢复用户滚动标记
                                setTimeout(() => {
                                    isUserScrolling = true;
                                }, 1000);
                            }
                        });
                    });
                    
                    // 设置滚动监听
                    setupScrollTracking();
                    
                    // 初始化时检查当前位置
                    setTimeout(() => {
                        updateActiveFromScroll();
                    }, 300);
                }
                
                function setupScrollTracking() {
                    window.addEventListener('scroll', () => {
                        if (!isUserScrolling) return;
                        
                        clearTimeout(scrollTimeout);
                        scrollTimeout = setTimeout(() => {
                            updateActiveFromScroll();
                        }, 10);
                    }, { passive: true });
                }
                
                function updateActiveFromScroll() {
                    if (headings.length === 0) return;
                    
                    let activeHeading = null;
                    let minDistance = Infinity;
                    
                    // 遍历所有标题，找到距离激活位置最近的标题
                    headings.forEach(heading => {
                        const rect = heading.getBoundingClientRect();
                        const headingTop = rect.top;
                        
                        // 计算标题距离激活位置的距离
                        const distance = Math.abs(headingTop - ACTIVATION_POSITION);
                        
                        // 只考虑在激活位置之上或刚好经过激活位置的标题
                        if (headingTop <= ACTIVATION_POSITION + 50 && distance < minDistance) {
                            minDistance = distance;
                            activeHeading = heading;
                        }
                    });
                    
                    // 特殊处理：如果没有找到合适的标题
                    if (!activeHeading) {
                        // 检查是否在页面顶部 - 激活第一个标题
                        const scrollTop = window.pageYOffset || document.documentElement.scrollTop;
                        if (scrollTop < 100 && headings.length > 0) {
                            activeHeading = headings[0];
                        }
                        
                        // 检查是否在页面底部 - 激活最后一个标题
                        const documentHeight = Math.max(
                            document.body.scrollHeight,
                            document.body.offsetHeight,
                            document.documentElement.clientHeight,
                            document.documentElement.scrollHeight,
                            document.documentElement.offsetHeight
                        );
                        
                        if (scrollTop + window.innerHeight >= documentHeight - 50 && headings.length > 0) {
                            activeHeading = headings[headings.length - 1];
                        }
                    }
                    
                    // 更新激活状态
                    if (activeHeading) {
                        updateActiveLink(activeHeading.id);
                    } else {
                        // 如果没有找到任何合适的标题，清除激活状态
                        if (currentActiveLink) {
                            currentActiveLink.classList.remove('is-active');
                            currentActiveLink = null;
                        }
                    }
                }
                
                function updateActiveLink(targetId) {
                    // 如果目标ID与当前激活的相同，不需要更新
                    if (currentActiveLink && currentActiveLink.getAttribute('data-target') === targetId) {
                        return;
                    }
                    
                    // 移除当前激活状态
                    if (currentActiveLink) {
                        currentActiveLink.classList.remove('is-active');
                    }
                    
                    // 找到对应的TOC链接并激活
                    const newActiveLink = tocLinks.find(link => 
                        link.getAttribute('data-target') === targetId
                    );
                    
                    if (newActiveLink) {
                        newActiveLink.classList.add('is-active');
                        currentActiveLink = newActiveLink;
                        
                        // 滚动TOC容器以确保激活链接可见
                        scrollTocToActive(newActiveLink);
                    }
                }
                
                function scrollTocToActive(activeLink) {
                    const tocContent = document.querySelector('.toc-content');
                    if (!tocContent || !activeLink) return;
                    
                    const tocRect = tocContent.getBoundingClientRect();
                    const linkRect = activeLink.getBoundingClientRect();
                    
                    // 计算链接相对于TOC容器的位置
                    const linkOffsetTop = activeLink.offsetTop;
                    const containerHeight = tocContent.clientHeight;
                    
                    // 如果链接不在可视区域内，则滚动到合适位置
                    if (linkRect.top < tocRect.top + 20 || linkRect.bottom > tocRect.bottom - 20) {
                        const targetScrollTop = linkOffsetTop - containerHeight / 2;
                        
                        tocContent.scrollTo({
                            top: Math.max(0, targetScrollTop),
                            behavior: 'smooth'
                        });
                    }
                }
                
                // 防抖函数
                function debounce(func, wait) {
                    let timeout;
                    return function executedFunction(...args) {
                        const later = () => {
                            clearTimeout(timeout);
                            func(...args);
                        };
                        clearTimeout(timeout);
                        timeout = setTimeout(later, wait);
                    };
                }
                
                // 页面加载完成后初始化
                if (document.readyState === 'loading') {
                    document.addEventListener('DOMContentLoaded', initTocTracking);
                } else {
                    initTocTracking();
                }
                
                // 处理页面尺寸变化
                window.addEventListener('resize', debounce(() => {
                    updateActiveFromScroll();
                }, 250));
                
                // 清理函数
                window.addEventListener('beforeunload', () => {
                    if (observer) {
                        observer.disconnect();
                    }
                });
            })();
        </script></div></div><!--!--><style>.column.column-left,.column.column-right{display:block}</style></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><a class="footer-logo is-block mb-2" href="/"><img class="logo-img" src="/img/JIELY.png" alt="霸王龙的小窝🦖" height="28"><img class="logo-img-dark" src="/img/JIELY.png" alt="霸王龙的小窝🦖" height="28"></a><p class="is-size-7"><span>&copy; 2025 Jiely</span>  Powered by <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a> &amp; <a href="https://github.com/imaegoo/hexo-theme-icarus" target="_blank" rel="noopener">Icarus</a><br><span id="busuanzi_container_site_uv">总访问量&nbsp;<span id="busuanzi_value_site_pv">-</span>&nbsp;次&nbsp;&nbsp;总访客数&nbsp;<span id="busuanzi_value_site_uv">-</span>&nbsp;人</span></p></div><div class="level-item has-text-centered"><img src="/img/animals.png" alt="Footer Photo" style="max-width: 500px; height: auto;"></div><div class="level-end"><div class="field has-addons"><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Attribution 4.0 International" href="https://creativecommons.org/licenses/by/4.0/deed.zh"><i class="fab fa-creative-commons-by"></i></a></p></div></div></div></div></footer><script src="/js/imaegoo/jquery/3.3.1/dist/jquery.min.js"></script><script src="/js/imaegoo/moment/2.22.2/min/moment-with-locales.min.js"></script><script src="https://cdn.jsdelivr.net/npm/twikoo@1.6.44/dist/twikoo.all.min.js"></script><script src="/js/imaegoo/clipboard/2.0.4/dist/clipboard.min.js" defer></script><script>moment.locale("zh-cn");</script><script>var IcarusThemeSettings = {
            article: {
                highlight: {
                    clipboard: true,
                    fold: 'unfolded'
                }
            }
        };</script><script data-pjax src="/js/column.js"></script><a id="back-to-top" title="回到顶端" href="javascript:;"><i class="fas fa-chevron-up"></i></a><script data-pjax src="/js/back_to_top.js" defer></script><!--!--><!--!--><script src="/js/imaegoo/lightgallery/1.10.0/dist/js/lightgallery.min.js" defer></script><script src="/js/imaegoo/justifiedGallery/3.8.1/dist/js/jquery.justifiedGallery.min.js" defer></script><script>window.addEventListener("load", () => {
            if (typeof $.fn.lightGallery === 'function') {
                $('.article').lightGallery({ selector: '.gallery-item' });
            }
            if (typeof $.fn.justifiedGallery === 'function') {
                if ($('.justified-gallery > p > .gallery-item').length) {
                    $('.justified-gallery > p > .gallery-item').unwrap();
                }
                $('.justified-gallery').justifiedGallery();
            }
        });</script><!--!--><!--!--><script src="/js/imaegoo/cookieconsent/3.1.1/build/cookieconsent.min.js" defer></script><script>window.addEventListener("load", () => {
      window.cookieconsent.initialise({
        type: "info",
        theme: "edgeless",
        static: false,
        position: "bottom-right",
        content: {
          message: "此网站使用 Cookie，以启用评论系统和分析功能。",
          dismiss: "知道了",
          allow: "允许使用Cookie",
          deny: "拒绝",
          link: "了解更多",
          policy: "Cookie政策",
          href: "/cookies/",
        },
        palette: {
          popup: {
            background: "#edeff5",
            text: "#838391"
          },
          button: {
            background: "#4b81e8"
          },
        },
      });
    });</script><script data-pjax src="/js/main.js" defer></script><div class="searchbox"><div class="searchbox-container"><div class="searchbox-header"><div class="searchbox-input-container"><input class="searchbox-input" type="text" placeholder="想要查找什么..."></div><div class="searchbox-pinyin"><label class="checkbox"><input id="search-by-pinyin" type="checkbox" checked="checked"><span> 拼音检索</span></label></div><a class="searchbox-close" href="javascript:;">×</a></div><div class="searchbox-body"></div></div></div><script src="/js/imaegoo/pinyin.js" defer></script><script src="/js/insight.js" defer></script><script>document.addEventListener('DOMContentLoaded', function () {
            loadInsight({"contentUrl":"/content.json"}, {"hint":"想要查找什么...","untitled":"(无标题)","posts":"文章","pages":"页面","categories":"分类","tags":"标签"});
        });</script><script type="text/javascript" src="/js/imaegoo/imaegoo.js"></script><script type="text/javascript" src="/js/imaegoo/universe.js"></script><script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js"></script><script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.min.js">
                            document.addEventListener("DOMContentLoaded", function() {
                                renderMathInElement(document.body, {
                                    delimiters: [
                                        {left: "$$", right: "$$", display: true},
                                        {left: "$", right: "$", display: false}
                                    ]
                                });
                            });
                        </script></body></html>