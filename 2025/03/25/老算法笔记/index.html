<!doctype html>
<html lang="zh"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta><title>è€ç®—æ³•ç¬”è®° - ğŸ¦–</title><link rel="manifest" href="/manifest.json"><meta name="application-name" content="ğŸ¦–"><meta name="msapplication-TileImage" content="/img/Whale.png"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-title" content="ğŸ¦–"><meta name="apple-mobile-web-app-status-bar-style" content="default"><meta name="description" content="ä»£ç çš„å¼€å§‹ï¼Œç®—æ³•å­¦ä¹ çš„å¼€å§‹"><meta property="og:type" content="blog"><meta property="og:title" content="Jiely"><meta property="og:url" content="https://github.com/pa-her0"><meta property="og:site_name" content="Jiely"><meta property="og:description" content="ä»£ç çš„å¼€å§‹ï¼Œç®—æ³•å­¦ä¹ çš„å¼€å§‹"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="https://github.com/img/ACM1.png"><meta property="article:published_time" content="2025-03-25T14:11:52.000Z"><meta property="article:modified_time" content="2025-06-10T08:28:47.040Z"><meta property="article:author" content="removeif"><meta property="article:tag" content="çƒ­çˆ±"><meta property="twitter:card" content="summary"><meta property="twitter:image:src" content="https://github.com/img/ACM1.png"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"http://whalefall.fun/2025/03/25/%E8%80%81%E7%AE%97%E6%B3%95%E7%AC%94%E8%AE%B0/"},"headline":"ğŸ¦–","image":["http://whalefall.fun/img/ACM1.png"],"datePublished":"2025-03-25T14:11:52.000Z","dateModified":"2025-06-10T08:28:47.040Z","author":{"@type":"Person","name":"Jiely"},"publisher":{"@type":"Organization","logo":{"@type":"ImageObject"}},"description":"ä»£ç çš„å¼€å§‹ï¼Œç®—æ³•å­¦ä¹ çš„å¼€å§‹"}</script><link rel="canonical" href="http://whalefall.fun/2025/03/25/%E8%80%81%E7%AE%97%E6%B3%95%E7%AC%94%E8%AE%B0/"><link rel="icon" href="/img/Whale.png"><meta name="referrer" content="no-referrer-when-downgrade"><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/font-awesome/6.0.0/css/all.min.css"><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/highlight.js/11.7.0/styles/tokyo-night-dark.min.css"><link rel="stylesheet" href="https://fonts.loli.net/css2?family=Ubuntu:wght@400;600&amp;family=Source+Code+Pro"><link rel="stylesheet" href="/css/default.css"><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/font-awesome/5.12.0/css/all.min.css"><link rel="stylesheet" href="https://fonts.loli.net/css?family=Ubuntu:400,600|Source+Code+Pro|Monda:300,300italic,400,400italic,700,700italic|Roboto Slab:300,300italic,400,400italic,700,700italic|Microsoft YaHei:300,300italic,400,400italic,700,700italic|PT Mono:300,300italic,400,400italic,700,700italic&amp;amp;subset=latin,latin-ext|Inconsolata|Itim|Lobster.css"><script src="https://cdnjs.loli.net/ajax/libs/jquery/3.3.1/jquery.min.js"></script><script src="/js/globalUtils.js"></script><style>body>.footer,body>.navbar,body>.section{opacity:0}</style><!--!--><!--!--><script src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" defer></script><!--!--><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/lightgallery/1.10.0/css/lightgallery.min.css"><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/justifiedGallery/3.8.1/css/justifiedGallery.min.css"><!--!--><!--!--><!--!--><!--!--><style>.pace{-webkit-pointer-events:none;pointer-events:none;-webkit-user-select:none;-moz-user-select:none;user-select:none}.pace-inactive{display:none}.pace .pace-progress{background:#3273dc;position:fixed;z-index:2000;top:0;right:100%;width:100%;height:2px}</style><script src="https://cdnjs.loli.net/ajax/libs/pace/1.2.4/pace.min.js"></script><!-- hexo injector head_end start --><script>
  (function () {
      function switchTab() {
          if (!location.hash) {
            return;
          }

          const id = '#' + CSS.escape(location.hash.substring(1));
          const $tabMenu = document.querySelector(`.tabs a[href="${id}"]`);
          if (!$tabMenu) {
            return;
          }

          const $tabMenuContainer = $tabMenu.parentElement.parentElement;
          Array.from($tabMenuContainer.children).forEach($menu => $menu.classList.remove('is-active'));
          Array.from($tabMenuContainer.querySelectorAll('a'))
              .map($menu => document.getElementById($menu.getAttribute("href").substring(1)))
              .forEach($content => $content.classList.add('is-hidden'));

          if ($tabMenu) {
              $tabMenu.parentElement.classList.add('is-active');
          }
          const $activeTab = document.querySelector(id);
          if ($activeTab) {
              $activeTab.classList.remove('is-hidden');
          }
      }
      switchTab();
      window.addEventListener('hashchange', switchTab, false);
  })();
  </script><!-- hexo injector head_end end --><meta name="generator" content="Hexo 7.3.0"></head><body class="is-3-column has-navbar-fixed-top"><nav class="navbar navbar-main is-fixed-top"><div class="container navbar-container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/"><img src="/img/Y1.png" alt="ğŸ¦–" height="28"></a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item" href="/">ä¸»é¡µ</a><a class="navbar-item" href="/archives">å½’æ¡£</a><a class="navbar-item" href="/categories">åˆ†ç±»</a><a class="navbar-item" href="/tags">æ ‡ç­¾</a><a class="navbar-item" href="/about">å…³äº</a></div><div class="navbar-end"><a class="navbar-item" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/pa-her0"><i class="fab fa-github"></i></a><a class="navbar-item is-hidden-tablet catalogue" title="ç›®å½•" href="javascript:;"><i class="fas fa-list-ul"></i></a><a class="navbar-item search" title="æœç´¢" href="javascript:;"><i class="fas fa-search"></i></a><a class="navbar-item" id="night-nav" title="Night Mode" href="javascript:;"><i class="fas fa-moon" id="night-icon"></i></a></div></div></div></nav><script type="text/javascript" src="/js/theme-setting.js"></script><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-8-tablet is-8-desktop is-9-widescreen"><!--!--><div class="card"><article class="card-content article " role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><i class="far fa-calendar-plus"></i>Â 2025-03-25</span><span class="level-item"><i class="far fa-calendar-check"></i>Â æœ€åä¿®æ”¹:<time datetime="2025-06-10T08:28:47.040Z" title="2025-06-10T08:28:47.040Z">2025-06-10</time></span><span class="level-item"><i class="far fa-clock"></i>Â 44 åˆ†é’ŸÂ <i class="fas fa-pencil-alt"></i>Â 6.6k</span><span class="level-item" id="busuanzi_container_page_pv"><span id="busuanzi_value_page_pv">0</span>æ¬¡è®¿é—®</span></div></div><h1 class="title is-3 is-size-4-mobile">è€ç®—æ³•ç¬”è®°</h1><div class="content"><blockquote>
<p><strong>ä»£ç çš„å¼€å§‹ï¼Œç®—æ³•å­¦ä¹ çš„å¼€å§‹</strong></p>
</blockquote>
<span id="more"></span>
<h1>å·¦ç¥è¯¾ç¨‹ç¬”è®°</h1>
<h1>å‰ç½®åŸºæœ¬é—®é¢˜ï¼š</h1>
<h2 id="1-å½’å¹¶åˆ†æ²»ç®—æ³•">1. å½’å¹¶åˆ†æ²»ç®—æ³•</h2>
<h3 id="å¤§èŒƒå›´çš„ç­”æ¡ˆ-ç­‰ä¸ç­‰äº-å·¦è¾¹éƒ¨åˆ†-å³è¾¹éƒ¨åˆ†-è·¨è¶Šå·¦å³ä¸¤è¾¹çš„ç­”æ¡ˆ">å¤§èŒƒå›´çš„ç­”æ¡ˆ  ç­‰ä¸ç­‰äº å·¦è¾¹éƒ¨åˆ† + å³è¾¹éƒ¨åˆ† + è·¨è¶Šå·¦å³ä¸¤è¾¹çš„ç­”æ¡ˆ</h3>
<p>ğŸ’¡è€ƒè™‘è·¨å·¦å³ <strong>æœ‰åº</strong>æ˜¯å¦èƒ½æå‡ä¾¿æ·æ€§ã€‚</p>
<ul class="lvl-0">
<li class="lvl-2">
<p><strong>å½’å¹¶æ’åºï¼š</strong></p>
</li>
</ul>
<p>ğŸ’¡å½’å¹¶æ’åºæ˜¯ä¸€ä¸ªç¨³å®šçš„æ’åºã€‚</p>
<p><strong>åˆ†æˆå·¦å³ï¼Œmergeæ’åº</strong></p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">1e5</span><span class="number">+10</span>;</span><br><span class="line"><span class="type">int</span> a[N];</span><br><span class="line"><span class="type">int</span> help[N];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">merge</span><span class="params">(<span class="type">int</span> l,<span class="type">int</span> r)</span></span>&#123;</span><br><span class="line">    <span class="type">int</span> i = l, j = ((l + r) &gt;&gt; <span class="number">1</span>) + <span class="number">1</span>, t1 = <span class="number">0</span>;</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">while</span>(i &lt;= ((l + r)&gt;&gt; <span class="number">1</span>) &amp;&amp; j &lt;= r)&#123;</span><br><span class="line">          help[t1++] = (a[i] &lt;= a[j]) ? a[i++] : a[j++];&#125;</span><br><span class="line">    <span class="keyword">while</span>(i &lt;= ((l + r)&gt;&gt; <span class="number">1</span>) )&#123;. help[t1++] = a[i++];  &#125;</span><br><span class="line">    <span class="keyword">while</span>(j &lt;= r)&#123;. help[t1++] = a[j++];  &#125;</span><br><span class="line">   </span><br><span class="line">    <span class="keyword">for</span>(i = r; i &gt;=l; i--)&#123;. a[i] = help[--t1];  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">guibin</span><span class="params">(<span class="type">int</span> l, <span class="type">int</span> r,<span class="type">int</span> n)</span></span>&#123;</span><br><span class="line">     <span class="keyword">if</span>(l &gt;= r) <span class="keyword">return</span> ;</span><br><span class="line"> </span><br><span class="line">     <span class="built_in">guibin</span>(l, (l + r) &gt;&gt; <span class="number">1</span>, n);</span><br><span class="line">     <span class="built_in">guibin</span>(((l + r) &gt;&gt; <span class="number">1</span>)<span class="number">+1</span>, r, n);</span><br><span class="line">     <span class="built_in">merge</span>(l, r);</span><br><span class="line">&#125;</span><br><span class="line">  </span><br></pre></td></tr></table></figure>
<ul class="lvl-0">
<li class="lvl-2">
<p><strong>å½’å¹¶åˆ†æ²»</strong></p>
</li>
</ul>
<p>ğŸ’¡</p>
<p>å½’å¹¶åˆ†æ²»æ˜¯åŸºäºå½’å¹¶æ’åºï¼Œåœ¨å½’å¹¶æ’åºçš„åŸºç¡€ä¸Šè¿›è¡Œåˆ† <strong>å·¦å³ + å·¦å³ä¸­çš„è¿‡æ¸¡</strong>ï¼Œä¸»è¦æ˜¯<strong>åˆ†æå·¦å³ä¸­çš„è¿‡æ¸¡è¿‡ç¨‹æ˜¯å¦è·Ÿå·¦å³éƒ¨åˆ†çš„æœ‰åºæ€§ç›¸å…³ã€‚</strong></p>
<h2 id="2-éšæœºå¿«é€Ÿæ’åº">2. éšæœºå¿«é€Ÿæ’åº</h2>
<p><strong>åŸºæœ¬å†…å®¹ä¸å¿«é€Ÿæ’åºä¿æŒä¸€è‡´ï¼Œåªæ˜¯åœ¨é€‰æ‹©pivotçš„æ—¶å€™æ˜¯éšæœºé€‰æ‹©ã€‚</strong></p>
<aside>
ğŸ’¡
<p>pivotçš„éšæœºé€‰æ‹©æ˜¯ä»æ¦‚ç‡ä¸Šè®²å¿«é€Ÿæ’åºçš„æ—¶é—´å¤æ‚åº¦é™ä½åˆ°<strong>O(nlogn)</strong></p>
<p><strong>å¿«æ’çš„é‡è¦éƒ¨åˆ†æ˜¯ partitionå‡½æ•° éƒ¨åˆ†</strong></p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">1e5</span><span class="number">+10</span>;</span><br><span class="line"><span class="type">int</span> nums[N];</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> a,b;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">swap</span><span class="params">(<span class="type">int</span> i, <span class="type">int</span> j)</span></span>&#123;</span><br><span class="line">    <span class="type">int</span> temp;</span><br><span class="line">    temp = nums[i];</span><br><span class="line">    nums[i] = nums[j];</span><br><span class="line">    nums[j] = temp;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">part</span><span class="params">(<span class="type">int</span> l, <span class="type">int</span> r, <span class="type">int</span> x)</span></span>&#123;</span><br><span class="line">    <span class="type">int</span>  i = l; <span class="comment">// å°äºåŒºåŸŸ a å¤§äºåŒºåŸŸ b</span></span><br><span class="line">    a = l, b = r;</span><br><span class="line">    <span class="keyword">while</span>(i &lt;= b)&#123;</span><br><span class="line">         <span class="keyword">if</span>(nums[i] &lt; x)&#123;</span><br><span class="line">            <span class="built_in">swap</span>(i++,a++);</span><br><span class="line">         &#125;<span class="keyword">else</span> <span class="keyword">if</span>(nums[i] &gt; x)&#123;</span><br><span class="line">            <span class="built_in">swap</span>(i, b--);</span><br><span class="line">         &#125;<span class="keyword">else</span> i++;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">quick__sort</span><span class="params">(<span class="type">int</span> l, <span class="type">int</span> r)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(l &gt;= r)&#123;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">int</span> pivot = nums[l];</span><br><span class="line">    <span class="built_in">part</span>(l, r, pivot);</span><br><span class="line">    <span class="built_in">quick__sort</span>(l,a<span class="number">-1</span>);</span><br><span class="line">    <span class="built_in">quick__sort</span>(b<span class="number">+1</span>,r);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="å¯ä»¥ç”¨-partition-æ¥å¯»æ‰¾-ç¬¬kå¤§-ç¬¬kå°-è·å…°å›½æ——é—®é¢˜">å¯ä»¥ç”¨ partition æ¥å¯»æ‰¾ ç¬¬kå¤§ ç¬¬kå° (è·å…°å›½æ——é—®é¢˜)</h3>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">1e5</span><span class="number">+10</span>;</span><br><span class="line"><span class="type">int</span> nums[N];</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> a, b;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">swap</span><span class="params">(<span class="type">int</span> i, <span class="type">int</span> j)</span></span>&#123;</span><br><span class="line">    <span class="type">int</span> temp = nums[i];</span><br><span class="line">    nums[i] = nums[j];</span><br><span class="line">    nums[j] = temp;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">partition</span><span class="params">(<span class="type">int</span> l, <span class="type">int</span> r, <span class="type">int</span> x)</span></span>&#123;</span><br><span class="line">    <span class="type">int</span> i = l;</span><br><span class="line">    a = l, b = r;</span><br><span class="line">    <span class="keyword">while</span>(i &lt;= b)&#123;</span><br><span class="line">          <span class="keyword">if</span>(nums[i] &lt; x)&#123;</span><br><span class="line">            <span class="built_in">swap</span>(i++,a++);</span><br><span class="line">          &#125;<span class="keyword">else</span> <span class="keyword">if</span>(nums[i] &gt; x)&#123;</span><br><span class="line">            <span class="built_in">swap</span>(i, b--);</span><br><span class="line">          &#125;<span class="keyword">else</span> i++;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">find</span><span class="params">(<span class="type">int</span> k, <span class="type">int</span> n)</span></span>&#123;</span><br><span class="line">    <span class="type">int</span> ans = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> l = <span class="number">0</span>, r = n; l &lt;= r;)&#123;</span><br><span class="line">        <span class="built_in">partition</span>(l, r, nums[l]);</span><br><span class="line">        <span class="keyword">if</span>(k &lt; a)&#123;</span><br><span class="line">            r = a <span class="number">-1</span>;</span><br><span class="line">        &#125;<span class="keyword">else</span> <span class="keyword">if</span>(k &gt; b)&#123;</span><br><span class="line">            l = b + <span class="number">1</span>;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            ans = nums[k];</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h2 id="æ„å»ºå‰ç¼€ä¿¡æ¯ï¼ˆ46ï¼‰">æ„å»ºå‰ç¼€ä¿¡æ¯ï¼ˆ46ï¼‰</h2>
<p>å¸¸è§æ„å»º</p>
<ul class="lvl-0">
<li class="lvl-2">
<p>æ„å»ºå‰ç¼€ä¿¡æ¯ ï¼ˆ<strong>æœ€æ—© æœ€æ™šï¼‰ å‡ºç°çš„ä½ç½®</strong></p>
</li>
</ul>
<ol>
<li class="lvl-3">
<p>å‰ç¼€å’Œæ¥ æ±‚åŒºé—´å’Œ</p>
</li>
</ol>
<ul class="lvl-0">
<li class="lvl-2">
<p>sum[i] = sum[i-1] + a[i]</p>
</li>
<li class="lvl-2">
<p>{l , r} â†’ sum[r + 1] - sum[l]</p>
<ol start="2">
<li class="lvl-6">æ±‚ åŒºé—´ç´¯åŠ å’Œ ä¸ºç¡®å®šå€¼çš„ æœ€é•¿é•¿åº¦ï¼ˆå­æ•°ç»„ä¸ªæ•°ï¼‰</li>
</ol>
</li>
<li class="lvl-2">
<p>è®°å½• t = sum[i] - aim çš„æœ€æ—©å‡ºç°æ¬¡æ•°ï¼ˆi ä¹‹å‰çš„ t çš„å‡ºç°ä¸ªæ•°ï¼‰</p>
<ol start="3">
<li class="lvl-5">æ­£æ•° å’Œ è´Ÿæ•° ç›¸ç­‰çš„ æœ€é•¿æ•°ç»„é•¿åº¦</li>
</ol>
</li>
<li class="lvl-2">
<p>æ­£æ•°ç›¸å½“äº 1 è´Ÿæ•°ç›¸å½“äº -1 æ±‚åŒºé—´ä¸º 0 1çš„å­æ•°ç»„æœ€é•¿é•¿åº¦</p>
</li>
</ul>
<ol start="4">
<li class="lvl-4">
<p>åŒºé—´å¤§äº 0 çš„æœ€é•¿æ•°ç»„é•¿åº¦ ï¼ˆå€¼åªæœ‰ -1, 1ï¼‰</p>
</li>
</ol>
<ul class="lvl-0">
<li class="lvl-2">
<p>aim = sum[i] - sum[j] â‰¥ 0</p>
</li>
<li class="lvl-2">
<p><input type="checkbox" id="checkbox1"><label for="checkbox1"> if sum[i] &gt; 0 â†’ ans = i</label></p>
</li>
<li class="lvl-2">
<p><input type="checkbox" id="checkbox2"><label for="checkbox2"> if sum[i] â‰¤ 0 â†’ sum[i] -1 æœ€æ—©å‡ºç°çš„ä½ç½®</label></p>
</li>
</ul>
<ol start="5">
<li class="lvl-4">
<p>ç§»é™¤æœ€çŸ­çš„æ•°ç»„å­æ•°ç»„é•¿åº¦ sum èƒ½è¢« p æ•´æ•°</p>
</li>
</ol>
<ul class="lvl-0">
<li class="lvl-2">
<p>ä¸ ä½™æ•°ç›¸å…³</p>
</li>
<li class="lvl-2">
<p>sum1 %  p = a  // sum2 % p = b</p>
</li>
<li class="lvl-2">
<p>if(a + b % p == 0)  (sum1 + sum2) % p == 0</p>
</li>
<li class="lvl-2">
<p>æ•´ä½“ aim = sum(æ€») % p â†’ çœ‹å“ªä¸ªåŒºé—´çš„ çš„ä½™æ•° (t + aim) % p == 0</p>
</li>
<li class="lvl-2">
<p>find = (t + p - aim) % p <strong>(åŒä½™åŸç†) â†’ ä¸ç¯ä¹Ÿæœ‰å…³</strong></p>
</li>
<li class="lvl-2">
</li>
</ul>
<p>ğŸ’¡</p>
<p>å•è°ƒé˜Ÿåˆ— å’Œ å•è°ƒæ ˆ ä¸€æ ·ï¼Œä¿å­˜ç€å¯¹äºç­”æ¡ˆçš„å¯èƒ½æ€§ï¼Œå¹¶ä¸”ä»æ ˆä¸­å¼¹å‡ºçš„æ—¶å€™ï¼Œè¿›è¡Œè®¡ç®—ï¼Œä¸è¿›è¡Œåç»­çš„è®¡ç®—ï¼Œä¸€èˆ¬åº”ç”¨äº åŒºé—´é—®é¢˜ã€‚</p>
<p><strong>æ ¸å¿ƒæ€æƒ³ ï¼š è¶Šå¾€åçš„ æ»¡è¶³è¦æ±‚æ›´å¥½çš„é€‰æ‹© æ›´å¥½</strong></p>
<h2 id="å•è°ƒé˜Ÿåˆ—">å•è°ƒé˜Ÿåˆ—</h2>
<p>å•è°ƒé˜Ÿåˆ—åŸºæœ¬ç”¨æ³• â†’ ç”¨æ¥ç»´æŠ¤ä¸€ä¸ª<strong>çª—å£é‡Œé¢çš„æœ€å€¼ï¼ˆå·¦é—­å³å¼€ï¼‰</strong></p>
<aside>
ğŸ’¡
å› ä¸ºä»å·¦å¼¹å‡ºçš„æ—¶å€™ï¼Œè¿™ä¸ªé˜Ÿåˆ—æ— è®ºå¦‚ä½•æ˜¯æ²¡æœ‰è¿‡æœŸä¸‹æ ‡çš„ï¼ˆè¦ä¸ä¸€å¼€å§‹è¢«æœ€å€¼ä»å³è¾¹é¡¶å‡ºå»äº†ï¼Œè¦ä¸è¶Šç•Œè¢«å·¦è¾¹å¼¹å‡ºå»äº†ï¼‰
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">deque&lt;<span class="type">int</span>&gt; q;</span><br><span class="line">    <span class="keyword">for</span> (l = r = <span class="number">0</span>; r &lt; n; r++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">while</span> (!q.<span class="built_in">empty</span>() &amp;&amp; a[r] &gt;= a[q.<span class="built_in">back</span>()])</span><br><span class="line">        &#123;</span><br><span class="line">            q.<span class="built_in">pop_back</span>();</span><br><span class="line">        &#125;</span><br><span class="line">        q.<span class="built_in">push_back</span>(r);</span><br><span class="line">        <span class="keyword">if</span> (q.<span class="built_in">size</span>() == limit + <span class="number">1</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (l++ == q.<span class="built_in">front</span>())</span><br><span class="line">            &#123;</span><br><span class="line">                q.<span class="built_in">pop_front</span>();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<h3 id="ä¼˜å…ˆé˜Ÿåˆ—æ‰©å±•">ä¼˜å…ˆé˜Ÿåˆ—æ‰©å±•</h3>
<ol>
<li class="lvl-3">
<p>åŒºé—´å’Œ å°äº å®šå€¼çš„ æœ€çŸ­é•¿åº¦</p>
</li>
</ol>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> <span class="title">shortestSubarray</span><span class="params">(vector&lt;<span class="type">int</span>&gt;&amp; nums, <span class="type">int</span> k)</span> </span>&#123;</span><br><span class="line">   <span class="type">int</span> n = nums.<span class="built_in">size</span>();</span><br><span class="line">   <span class="function">vector&lt;<span class="type">long</span> <span class="type">long</span>&gt; <span class="title">sum</span><span class="params">(n + <span class="number">1</span>, <span class="number">0</span>)</span></span>;</span><br><span class="line">   deque&lt;<span class="type">int</span>&gt; q; <span class="comment">// å° -&gt; å¤§</span></span><br><span class="line">   <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++)&#123;</span><br><span class="line">       sum[i] = sum[i<span class="number">-1</span>] + nums[i<span class="number">-1</span>];</span><br><span class="line">   &#125;</span><br><span class="line">   <span class="type">int</span> ans = INT_MAX;</span><br><span class="line">   q.<span class="built_in">push_back</span>(<span class="number">0</span>);</span><br><span class="line">   <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++)&#123;</span><br><span class="line">       <span class="keyword">while</span>(!q.<span class="built_in">empty</span>() &amp;&amp; sum[i] - sum[q.<span class="built_in">front</span>()] &gt;= k)&#123;</span><br><span class="line">           <span class="comment">//cout &lt;&lt; ans &lt;&lt; &quot; &quot; &lt;&lt; i - q.front() &lt;&lt; endl;</span></span><br><span class="line">           ans = <span class="built_in">min</span>(ans,i - q.<span class="built_in">front</span>());</span><br><span class="line">           q.<span class="built_in">pop_front</span>();</span><br><span class="line">       &#125;           </span><br><span class="line">       <span class="keyword">while</span>(!q.<span class="built_in">empty</span>() &amp;&amp; sum[i] &lt;= sum[q.<span class="built_in">back</span>()])&#123;</span><br><span class="line">           q.<span class="built_in">pop_back</span>();</span><br><span class="line">       &#125;</span><br><span class="line">       q.<span class="built_in">push_back</span>(i);</span><br><span class="line">   &#125;</span><br><span class="line">   <span class="keyword">return</span> ans == INT_MAX ? <span class="number">-1</span> : ans;</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>
<h3 id="åŒç«¯é˜Ÿåˆ—åƒè¯ä»»åŠ¡å®‰æ’">åŒç«¯é˜Ÿåˆ—åƒè¯ä»»åŠ¡å®‰æ’</h3>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="type">int</span> n, s;</span><br><span class="line">cin &gt;&gt; n &gt;&gt;s;</span><br><span class="line"><span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">a</span><span class="params">(n)</span></span>;</span><br><span class="line"><span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">b</span><span class="params">(n)</span></span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; i++) cin &gt;&gt; a[i]; <span class="comment">// äººçš„ä½“åŠ›</span></span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; i++) cin &gt;&gt; b[i]; <span class="comment">// ä»»åŠ¡çš„éœ€æ±‚</span></span><br><span class="line"><span class="built_in">sort</span>(a.<span class="built_in">begin</span>(),a.<span class="built_in">end</span>());</span><br><span class="line"><span class="built_in">sort</span>(b.<span class="built_in">begin</span>(),b.<span class="built_in">end</span>());</span><br><span class="line"><span class="type">int</span> ans = <span class="number">0</span>; <span class="comment">// æœ€å°‘çš„è¯ä¸¸æ¬¡æ•°</span></span><br><span class="line">deque&lt;<span class="type">int</span>&gt; q;    </span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">      å…ˆçœ‹æ¯ä¸€ä¸ªçš„åŠ›æ‰€èƒ½åŠ æ”¾å…¥é˜Ÿåˆ—ä¸­</span></span><br><span class="line"><span class="comment">  */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>, p = <span class="number">0</span>; i &lt; n; i++)&#123;</span><br><span class="line">    <span class="keyword">while</span>(p &lt; n &amp;&amp; b[p] &lt;= a[i])&#123;</span><br><span class="line">        q.<span class="built_in">push_back</span>(b[p++]); </span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(!q.<span class="built_in">empty</span>() &amp;&amp; a[i] &gt;= q.<span class="built_in">front</span>())&#123;</span><br><span class="line">       q.<span class="built_in">pop_front</span>();</span><br><span class="line">    &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">while</span>(p &lt; n &amp;&amp; b[p] &lt; a[i] + s)&#123;</span><br><span class="line">            q.<span class="built_in">push_back</span>(b[p++]);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(q.<span class="built_in">empty</span>())&#123;</span><br><span class="line">            cout &lt;&lt; <span class="string">&quot;can&#x27;t do it&quot;</span> &lt;&lt; endl;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            ans++;</span><br><span class="line">            q.<span class="built_in">pop_back</span>(); <span class="comment">// åƒè¯å–æœ€å¤§</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">cout &lt;&lt; ans &lt;&lt; endl;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br></pre></td></tr></table></figure>
<h2 id="å•è°ƒæ ˆ">å•è°ƒæ ˆ</h2>
<ul class="lvl-0">
<li class="lvl-2">
<p>åŸºæœ¬ä½¿ç”¨æ–¹æ³• ç»´æŠ¤ <strong>å·¦å³ä¾§</strong> æ¯” å½“å‰å…ƒç´  <strong>å¤§æˆ–è€…å°</strong> çš„æœ€è¿‘ä½ç½®</p>
</li>
</ul>
<aside>
ğŸ’¡
<p>æ„å»ºä¸€ä¸ª æ ˆ â†’ è¶Šåå‡ºç°çš„å€¼ æœ‰æ›´å¤§çš„<strong>å½±å“åŠ›</strong></p>
<p><strong>æ‰¾å‡º ä»¥æŸä¸ªå€¼ä¸ºæœ€å€¼çš„ å­æ•°ç»„ï¼ˆæœ€é•¿ æˆ–è€… å¯¹è¿™ä¸ªå­æ•°ç»„è¿›è¡Œä¸€äº›è®¡ç®—ï¼‰</strong></p>
<p><strong>åŒæ—¶é—´ç»´æŠ¤å·¦å³çš„ æœ€è¿‘çš„ æœ€å€¼</strong></p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">stack&lt;<span class="type">int</span>&gt; s; <span class="comment">// è®°å½•ä¸‹æ ‡</span></span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; i++)&#123;</span><br><span class="line">    <span class="keyword">while</span>(!s.<span class="built_in">empty</span>() &amp;&amp; a[s.<span class="built_in">top</span>()] &gt;= a[i])&#123;</span><br><span class="line">        <span class="comment">// i ä¸ºå³è¾¹</span></span><br><span class="line">        <span class="type">int</span> cur = s.<span class="built_in">top</span>(); s.<span class="built_in">pop</span>(); <span class="comment">// ä¸­é—´</span></span><br><span class="line">        <span class="type">int</span> l = s.<span class="built_in">empty</span>() ? <span class="number">-1</span> : s.<span class="built_in">top</span>(); <span class="comment">// å·¦è¾¹</span></span><br><span class="line">    &#125;</span><br><span class="line">    s.<span class="built_in">push</span>(i);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">while</span>(!s.<span class="built_in">empty</span>())&#123;</span><br><span class="line">    <span class="type">int</span> cur = s.<span class="built_in">top</span>(); s.<span class="built_in">pop</span>();</span><br><span class="line">    <span class="type">int</span> l = s.<span class="built_in">empty</span>() ? <span class="number">-1</span> : s.<span class="built_in">top</span>();</span><br><span class="line">    ans += (cur - l) * (n - cur) * a[cur];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>åˆ›æ–° ï¼š</p>
<p>æ±‚ <strong>å­æ•°ç»„ä¸­çš„æœ€å°å€¼çš„å’Œ</strong></p>
<aside>
ğŸ’¡
<p>ç”¨ å•è°ƒæ ˆ â†’ æ±‚å‡ºå·¦å³ä¸¤è¾¹ å°äº(å¤§äº) è¿™ä¸ªå€¼çš„ä½ç½® â†’ åœ¨è¿™ä¸ªä¸­é—´ iä½ç½®çš„å€¼ä¾¿æ˜¯æœ€å€¼</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="type">int</span> n;</span><br><span class="line">    cin &gt;&gt; n;</span><br><span class="line">    <span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">a</span><span class="params">(n)</span></span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; i++)&#123;</span><br><span class="line">        cin &gt;&gt; a[i];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// åœ¨å­æ•°ç»„ä¸­ cur ä½ç½®ä¸ºæœ€å° i ä¸º å³è¾¹</span></span><br><span class="line">    stack&lt;<span class="type">int</span>&gt; s; <span class="comment">// è®°å½•ä¸‹æ ‡</span></span><br><span class="line">    <span class="type">long</span> <span class="type">long</span> ans = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; i++)&#123;</span><br><span class="line">        <span class="keyword">while</span>(!s.<span class="built_in">empty</span>() &amp;&amp; a[s.<span class="built_in">top</span>()] &gt;= a[i])&#123;</span><br><span class="line">            <span class="type">int</span> cur = s.<span class="built_in">top</span>(); s.<span class="built_in">pop</span>(); <span class="comment">// ä¸­é—´</span></span><br><span class="line">            <span class="type">int</span> l = s.<span class="built_in">empty</span>() ? <span class="number">-1</span> : s.<span class="built_in">top</span>(); <span class="comment">// å·¦è¾¹</span></span><br><span class="line">            ans += (cur - l) * (i - cur) * a[cur];</span><br><span class="line">        &#125;</span><br><span class="line">        s.<span class="built_in">push</span>(i);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(!s.<span class="built_in">empty</span>())&#123;</span><br><span class="line">        <span class="type">int</span> cur = s.<span class="built_in">top</span>(); s.<span class="built_in">pop</span>();</span><br><span class="line">        <span class="type">int</span> l = s.<span class="built_in">empty</span>() ? <span class="number">-1</span> : s.<span class="built_in">top</span>();</span><br><span class="line">        ans += (cur - l) * (n - cur) * a[cur];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="å®ç°æœ€å°å­—å…¸åºï¼ˆå•è°ƒæ ˆï¼‰">å®ç°æœ€å°å­—å…¸åºï¼ˆå•è°ƒæ ˆï¼‰</h3>
<aside>
ğŸ’¡
<p>åˆ©ç”¨å•è°ƒæ ˆæ¥ç»´æŠ¤ä¸€ä¸ªä»å°åˆ°å¤§çš„ stack</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; a.<span class="built_in">size</span>(); i++)&#123;</span><br><span class="line">     in[a[i] - <span class="string">&#x27;a&#x27;</span>]++;</span><br><span class="line"> &#125;</span><br><span class="line"></span><br><span class="line"> stack&lt;pair&lt;<span class="type">char</span>,<span class="type">int</span>&gt;&gt; s;</span><br><span class="line"> <span class="function">vector&lt;<span class="type">bool</span>&gt; <span class="title">vis</span><span class="params">(<span class="number">26</span>,<span class="literal">false</span>)</span></span>;</span><br><span class="line"></span><br><span class="line"> <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; a.<span class="built_in">size</span>(); i++)&#123;</span><br><span class="line"> <span class="keyword">if</span>(!vis[a[i] - <span class="string">&#x27;a&#x27;</span>])&#123;</span><br><span class="line"> <span class="keyword">while</span>(!s.<span class="built_in">empty</span>() &amp;&amp; s.<span class="built_in">top</span>().first &gt; a[i] &amp;&amp; in[s.<span class="built_in">top</span>().first - <span class="string">&#x27;a&#x27;</span>] &gt;= <span class="number">1</span>)&#123;</span><br><span class="line">         vis[s.<span class="built_in">top</span>().first- <span class="string">&#x27;a&#x27;</span>] = <span class="literal">false</span>;</span><br><span class="line">         s.<span class="built_in">pop</span>();</span><br><span class="line">     &#125;</span><br><span class="line"> vis[a[i] - <span class="string">&#x27;a&#x27;</span>] = <span class="literal">true</span>;</span><br><span class="line"> s.<span class="built_in">push</span>(&#123;a[i], i&#125;);</span><br><span class="line"> &#125;</span><br><span class="line"> in[a[i] - <span class="string">&#x27;a&#x27;</span>]--;</span><br><span class="line"> &#125;</span><br><span class="line"> string ans = <span class="string">&quot;&quot;</span>;</span><br><span class="line"> </span><br><span class="line"> <span class="keyword">while</span>(!s.<span class="built_in">empty</span>())&#123;</span><br><span class="line">     ans = s.<span class="built_in">top</span>().first + ans;</span><br><span class="line">     s.<span class="built_in">pop</span>();</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure>
<h2 id="æ»‘åŠ¨çª—å£-åŒæŒ‡é’ˆï¼ˆè§†é¢‘ï¼‰">æ»‘åŠ¨çª—å£ + åŒæŒ‡é’ˆï¼ˆè§†é¢‘ï¼‰</h2>
<h1>æ•°æ®ç»“æ„</h1>
<h2 id="å‰ç¼€æ ‘ï¼ˆå­—å…¸æ ‘ï¼‰">å‰ç¼€æ ‘ï¼ˆå­—å…¸æ ‘ï¼‰</h2>
<aside>
ğŸ’¡
<p>å‰ç¼€æ ‘æœ‰ç‚¹åƒé“¾å¼å‰å‘æ˜Ÿï¼Œæ˜¯ä¸€ä¸ªç”¨é™æ€æ•°ç»„æ¥è¿æ¥ã€‚</p>
<p><strong>é‡ç‚¹éƒ¨åˆ†</strong></p>
<p><strong>cntï¼šç”¨åºå·è¡¨ç¤ºè¿æ¥ï¼Œå¦‚æœè¿™ä¸ªèŠ‚ç‚¹æ²¡æœ‰ä½¿ç”¨è¿‡ï¼Œä»–æŠŠè¿™ä¸ªèŠ‚ç‚¹ç”¨cntæ¥ç¼–å·ï¼Œç„¶åcurä¼šä½¿ç”¨å®ƒæ¥è·³è½¬ï¼Œä¼šåˆ°è¾¾ä¸€ä¸ªæ²¡æœ‰å»è¿‡çš„å±‚æ¬¡ã€‚</strong></p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> cnt = <span class="number">1</span>; <span class="comment">// å±‚æ¬¡ç¼–å·</span></span><br><span class="line"><span class="comment">// æ’å…¥å•è¯</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">insert</span><span class="params">(<span class="type">const</span> string&amp; word)</span> </span>&#123;</span><br><span class="line">    <span class="type">int</span> cur = <span class="number">1</span>;</span><br><span class="line">    pass[cur]++;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">char</span> ch : word) &#123;</span><br><span class="line">        <span class="type">int</span> path = ch - <span class="string">&#x27;a&#x27;</span>;</span><br><span class="line">        <span class="keyword">if</span> (tree[cur][path] == <span class="number">0</span>) &#123;</span><br><span class="line">            tree[cur][path] = ++cnt;</span><br><span class="line">        &#125;</span><br><span class="line">         cur = tree[cur][path];</span><br><span class="line">        pass[cur]++;</span><br><span class="line">    &#125;</span><br><span class="line">    end[cur]++;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// æŸ¥è¯¢å‰ç¼€çš„æ•°é‡</span></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">prefixNumber</span><span class="params">(<span class="type">const</span> string&amp; prefix)</span> </span>&#123;</span><br><span class="line">    <span class="type">int</span> cur = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">char</span> ch : prefix) &#123;</span><br><span class="line">        <span class="type">int</span> path = ch - <span class="string">&#x27;a&#x27;</span>;</span><br><span class="line">        <span class="keyword">if</span> (tree[cur][path] == <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        cur = tree[cur][path];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> pass[cur];</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// åˆ é™¤å•è¯</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">deleteWord</span><span class="params">(<span class="type">const</span> string&amp; word)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">prefixNumber</span>(word) &gt; <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="type">int</span> cur = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">char</span> ch : word) &#123;</span><br><span class="line">            <span class="type">int</span> path = ch - <span class="string">&#x27;a&#x27;</span>;</span><br><span class="line">            <span class="keyword">if</span> (--pass[tree[cur][path]] == <span class="number">0</span>) &#123;</span><br><span class="line">                tree[cur][path] = <span class="number">0</span>;</span><br><span class="line">                <span class="keyword">return</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            cur = tree[cur][path];</span><br><span class="line">        &#125;</span><br><span class="line">        end[cur]--;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// æ¸…ç©ºå‰ç¼€æ ‘</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">clear</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">memset</span>(tree, <span class="number">0</span>, <span class="built_in">sizeof</span>(tree));</span><br><span class="line">    <span class="built_in">memset</span>(pass, <span class="number">0</span>, <span class="built_in">sizeof</span>(pass));</span><br><span class="line">    <span class="built_in">memset</span>(end, <span class="number">0</span>, <span class="built_in">sizeof</span>(end));</span><br><span class="line">    cnt = <span class="number">1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="ä»¥ä¸‹æ˜¯å…³äº-å­—å…¸æ ‘-äºŒè¿›åˆ¶è¿ç®—ï¼š">ä»¥ä¸‹æ˜¯å…³äº <strong>å­—å…¸æ ‘ + äºŒè¿›åˆ¶</strong>è¿ç®—ï¼š</h3>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">1e3</span><span class="number">+10</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> M = <span class="number">2</span>;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> pass[N];</span><br><span class="line"><span class="type">int</span> End[N];</span><br><span class="line"><span class="type">int</span> tree[N][M];</span><br><span class="line"><span class="type">int</span> cnt = <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">insert</span><span class="params">(<span class="type">int</span> s)</span></span>&#123;</span><br><span class="line">     <span class="type">int</span> cur = <span class="number">1</span>;</span><br><span class="line">     <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">63</span>; i &gt;= <span class="number">0</span>; i--)&#123;</span><br><span class="line">         <span class="type">int</span> temp = ((<span class="number">1</span> &lt;&lt; i) &amp; s) &gt;&gt;i;</span><br><span class="line">         <span class="comment">//cout &lt;&lt; temp &lt;&lt; endl;</span></span><br><span class="line">        <span class="keyword">if</span>(tree[cur][temp] == <span class="number">0</span>)&#123;</span><br><span class="line">            tree[cur][temp] = ++cnt;</span><br><span class="line">        &#125;</span><br><span class="line">        cur = tree[cur][temp];</span><br><span class="line">     &#125;</span><br><span class="line">     <span class="comment">// æˆ‘å¦‚ä½•å–åˆ°è¿™ä¸ªäºŒè¿›åˆ¶ä¸Šé¢çš„å€¼</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">exam</span><span class="params">(<span class="type">int</span> t)</span></span>&#123;</span><br><span class="line">    <span class="type">int</span> cur = <span class="number">1</span>;</span><br><span class="line">    <span class="type">int</span> Max = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">63</span>; i &gt;= <span class="number">0</span>; i--)&#123;</span><br><span class="line">        <span class="type">int</span> temp = (t &gt;&gt; i) &amp; <span class="number">1</span>;</span><br><span class="line">        <span class="comment">// æœ€å¥½ temp ^ aim == 1 aim == 1 ^ temp</span></span><br><span class="line">        <span class="type">int</span> aim = <span class="number">1</span> ^ temp;</span><br><span class="line">        <span class="keyword">if</span>(tree[cur][aim] == <span class="number">0</span>)&#123;</span><br><span class="line">           aim ^= <span class="number">1</span>; </span><br><span class="line">        &#125;</span><br><span class="line">        Max |= ((temp ^ aim) &lt;&lt; i);</span><br><span class="line">        cur = tree[cur][aim];</span><br><span class="line">    &#125; </span><br><span class="line">    <span class="keyword">return</span> Max;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="å•è°ƒæ ˆ-å•è°ƒé˜Ÿåˆ—">å•è°ƒæ ˆ + å•è°ƒé˜Ÿåˆ—</h2>
<p>stack<int> st ä¾¿æ˜¯å•è°ƒæ ˆçš„å½¢å¼ï¼Œåªæ˜¯æ ˆä¸­çš„å…ƒç´ æ˜¯å•è°ƒçš„ã€‚</p>
<p>priority_queue<int> q ä¾¿æ˜¯å•è°ƒé˜Ÿåˆ—ï¼ˆä¼˜å…ˆé˜Ÿåˆ—ï¼‰çš„å½¢å¼ï¼Œåœ¨ä¼˜å…ˆé˜Ÿåˆ—ä¸­çš„å…ƒç´ æ˜¯å•è°ƒçš„ã€‚</p>
<h2 id="å¹¶æŸ¥é›†ï¼ˆæ¨¡ç‰ˆï¼‰">å¹¶æŸ¥é›†ï¼ˆæ¨¡ç‰ˆï¼‰</h2>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">1e5</span> + <span class="number">10</span>;</span><br><span class="line"><span class="type">int</span> father[N];</span><br><span class="line"><span class="comment">// åˆå§‹åŒ–å¹¶æŸ¥é›†</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">build</span><span class="params">(<span class="type">int</span> n)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">        father[i] = i;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// æŸ¥æ‰¾å…ƒç´ çš„æ ¹ï¼Œå¹¶è¿›è¡Œè·¯å¾„å‹ç¼©</span></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">find</span><span class="params">(<span class="type">int</span> i)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (i != father[i]) &#123;</span><br><span class="line">        father[i] = <span class="built_in">find</span>(father[i]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> father[i];</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// åˆ¤æ–­ä¸¤ä¸ªå…ƒç´ æ˜¯å¦å±äºåŒä¸€ä¸ªé›†åˆ</span></span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">isSameSet</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> y)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">find</span>(x) == <span class="built_in">find</span>(y);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// åˆå¹¶ä¸¤ä¸ªé›†åˆ</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">unite</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> y)</span> </span>&#123;</span><br><span class="line">    father[<span class="built_in">find</span>(x)] = <span class="built_in">find</span>(y);</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="åŸºæœ¬å»ºå›¾æ–¹æ³•">åŸºæœ¬å»ºå›¾æ–¹æ³•</h3>
<ul class="lvl-0">
<li class="lvl-2">
<p>vector <strong>æ•°ç»„å»ºå›¾</strong></p>
</li>
</ul>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vector&lt;pair&lt;<span class="type">int</span>,<span class="type">int</span>&gt;&gt;a[<span class="number">10005</span>];</span><br></pre></td></tr></table></figure>
<ul class="lvl-0">
<li class="lvl-2">
<p><strong>é“¾å¼å‰å‘æ˜Ÿ</strong></p>
</li>
</ul>
<aside>
ğŸ’¡     **åˆå§‹çš„ cnt æ˜¯æ²¡æœ‰ä½¿ç”¨è¿‡çš„
    ç„¶åå°†è¿™ä¸ª cnt å¯¹åº” vèŠ‚ç‚¹
    next è¡¨ç¤º ä¸‹ä¸€æ¡è¾¹çš„ç¼–å·
    head[u] èŠ‚ç‚¹çš„ å¤´éƒ¨è¾¹çš„ç¼–å·**
---
<p><strong>u -&gt; new -&gt; old<br>
ä¸€å¼€å§‹çš„ head[u] -&gt; old<br>
ç°åœ¨å°† head[u] -&gt; new å°† new çš„ next -&gt; old</strong></p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">1e5</span><span class="number">+10</span>;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> cnt = <span class="number">0</span>;</span><br><span class="line"><span class="type">int</span> head[N];</span><br><span class="line"><span class="keyword">struct</span>&#123;</span><br><span class="line">    <span class="type">int</span> to, next, w;</span><br><span class="line">&#125;edge[N];</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">init</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; N; i++)&#123;</span><br><span class="line">        head[i] = <span class="number">-1</span>;</span><br><span class="line">        edge[i].next = <span class="number">-1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    cnt = <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">add</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> v, <span class="type">int</span> w)</span></span>&#123;</span><br><span class="line">    edge[cnt].to = v;</span><br><span class="line">    edge[cnt].w = w;</span><br><span class="line">    edge[cnt].next = head[u];</span><br><span class="line">    head[u] = cnt++;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// éå†æ–¹æ³•</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">ex</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="type">int</span> u ;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> e = head[u]; e &gt; <span class="number">0</span>; e = edge[e].next)&#123;</span><br><span class="line">        <span class="type">int</span> v = edge[e].to;</span><br><span class="line">     &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="æ‹“æ‰‘æ’åº">æ‹“æ‰‘æ’åº</h2>
<aside>
ğŸ’¡ æ‰€è°“çš„æ‹“æ‰‘æ’åºï¼Œå…¶å®æ˜¯å›¾è®ºé‡Œé¢çš„ä¸€ä¸ªå¸¸è§æ‰‹æ®µï¼Œå¸¸ç”¨äºæœ‰å‰åå…³ç³»çš„èŠ‚ç‚¹çŠ¶æ€é—®é¢˜ã€‚
<p>å¸¸ä» <strong>å…¥åº¦ä¸º0</strong> çš„èŠ‚ç‚¹å¼€å§‹è®¿é—®**ã€‚ï¼ˆä¸ priority_queue<int> å°æ ¹å †ç»“åˆåº”ç”¨ï¼‰**</p>
<p><em>å¦‚æœæ— æ³•æŠŠæ‰€æœ‰çš„ç‚¹éƒ½åˆ æ‰ï¼Œè¯´æ˜æœ‰å‘å›¾é‡Œæœ‰ç¯</em></p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">1e5</span><span class="number">+10</span>;</span><br><span class="line"><span class="type">int</span> queue[N]; <span class="comment">// å¯ä»¥ç”¨ STL ä»£æ›¿ ï¼ˆqueueï¼‰</span></span><br><span class="line"><span class="type">int</span> indegree[N];</span><br></pre></td></tr></table></figure>
<h3 id="æ‹“æ‰‘æ’åºæ‰©å±•çŸ¥è¯†ï¼ˆç±»ä¼¼æ ‘å‹dpï¼‰">æ‹“æ‰‘æ’åºæ‰©å±•çŸ¥è¯†ï¼ˆç±»ä¼¼æ ‘å‹dpï¼‰</h3>
<aside>
ğŸ’¡
<p>å°† ä¸Šæ¸¸èŠ‚ç‚¹çš„ä¿¡æ¯ â†’ æ¨é€åˆ°ä¸‹æ¸¸èŠ‚ç‚¹</p>
<h2 id="å€å¢ç®—æ³•-STè¡¨ï¼ˆç”¨äºåŒºé—´æŸ¥è¯¢æœ€å€¼ï¼Œgcdï¼‰-å…ˆçœ‹-åŸºç¡€dp">å€å¢ç®—æ³• + STè¡¨ï¼ˆç”¨äºåŒºé—´æŸ¥è¯¢æœ€å€¼ï¼Œgcdï¼‰(å…ˆçœ‹ åŸºç¡€dp )</h2>
<aside>
ğŸ’¡
<p>åŸç†ï¼š<strong>æ¯ä¸€ä¸ªæ•°å­— éƒ½èƒ½ç”¨ äºŒè¿›æ•° æ¥è¡¨ç¤º //  å°½é‡é€¼è¿› ç›®æ ‡å€¼</strong></p>
<p>åº”ç”¨: å¯é‡å¤è´¡çŒ®é—®é¢˜</p>
<p>å‰æï¼šåé¢çš„ç‚¹ è·³çš„è·ç¦» ä¼š å¤§äºç­‰äº å‰é¢çš„ç‚¹</p>
<p>è·³è·ƒå…¬å¼ï¼š<strong>ST[ i ][ p ] = ST[ ST[ i ][ p-1 ] ][ p-1]</strong>    p â†’ è·³ 2 çš„ p æ¬¡æ–¹</p>
<p>ä» <strong>å¤§ â†’ å°</strong> å°è¯•</p>
<p>ä»…éœ€ åˆå§‹åŒ– ST[ i ][ 0 ] ï¼Œå…¶ä½™ å¯ä»¥ç”¨ è·³è·ƒå…¬å¼ è§£å†³ //  ä»åˆ—å¼€å§‹å¡«</p>
<aside>
ğŸ’¡
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">ST[i][p] = <span class="built_in">max</span>(ST[i][p<span class="number">-1</span>], ST[i + <span class="number">2</span> ^ p<span class="number">-1</span>][p<span class="number">-1</span>])</span><br><span class="line">ST[i][p] = <span class="built_in">min</span>(ST[i][p<span class="number">-1</span>], ST[i + <span class="number">2</span> ^ p<span class="number">-1</span>][p<span class="number">-1</span>])</span><br><span class="line">ST[i][p] = <span class="built_in">gcd</span>(ST[i][p<span class="number">-1</span>], ST[i + <span class="number">2</span> ^ p<span class="number">-1</span>][p<span class="number">-1</span>])</span><br><span class="line">     </span><br><span class="line">(i , j) -&gt; <span class="built_in">max</span>(ST[i][p], ST[j - <span class="number">2</span> ^ p + <span class="number">1</span>][p])  </span><br><span class="line">        <span class="comment">// p == log2(i - j + 1)</span></span><br></pre></td></tr></table></figure>
</aside>
<p>Maxï¼ŒMinçš„åŸºæœ¬ä»£ç </p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">1e3</span> + <span class="number">10</span>;</span><br><span class="line"><span class="type">int</span> Log2[N];</span><br><span class="line"><span class="type">int</span> stmax[N][N];</span><br><span class="line"><span class="type">int</span> stmin[N][N];</span><br><span class="line"><span class="type">int</span> num[N];</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">bulid</span><span class="params">(<span class="type">int</span> n)</span></span>&#123;</span><br><span class="line">    Log2[<span class="number">0</span>] = <span class="number">-1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++)&#123;</span><br><span class="line">        Log2[i] = Log2[i &gt;&gt; <span class="number">1</span>] + <span class="number">1</span>;</span><br><span class="line">        stmax[i][<span class="number">0</span>] = num[i];</span><br><span class="line">        stmin[i][<span class="number">0</span>] = num[i]; </span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> p = <span class="number">1</span>; p &lt;= Log2[n]; p ++)&#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++)&#123;</span><br><span class="line">            stmax[i][p] = <span class="built_in">max</span>(stmax[i][p<span class="number">-1</span>],stmax[i + (<span class="number">1</span> &lt;&lt; (p<span class="number">-1</span>))][ p<span class="number">-1</span> ]);</span><br><span class="line">            stmin[i][p] = <span class="built_in">min</span>(stmin[i][p<span class="number">-1</span>],stmin[i + (<span class="number">1</span> &lt;&lt; p<span class="number">-1</span>)][p<span class="number">-1</span>]); </span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æ‰©å±•çš„å¯é‡å¤è´¡çŒ®åŒºé—´é—®é¢˜:</p>
<p><strong>åŒºé—´ä¸ åŒºé—´æˆ– (ä¸¤ä¸ªç›¸åŒçš„æ•°å­— ä¸ æˆ– ä¸ä¼šå½±å“ç»“æœ)</strong></p>
<h2 id="æ ‘ä¸Šé—®é¢˜">æ ‘ä¸Šé—®é¢˜</h2>
<h3 id="æ ‘ä¸Šå€å¢-LCA">æ ‘ä¸Šå€å¢ + LCA</h3>
<ol>
<li class="lvl-3">
<p>tarjianç®—æ³•</p>
</li>
</ol>
<aside>
ğŸ’¡
<p>æ‰¹é‡ ç¦»çº¿ æŸ¥è¯¢</p>
<p>å¦‚æœè®¿é—®çš„ ans -&gt; u çš„å¯¹åº”èŠ‚ç‚¹v è®¿é—®è¿‡ ans = v çš„ä»£è¡¨èŠ‚ç‚¹</p>
<p>ç†è§£ï¼š</p>
<pre><code>      å› ä¸º ä½ åˆ°è¿™ä¸ªèŠ‚ç‚¹çš„æ—¶å€™ï¼Œå¯¹åº”çš„èŠ‚ç‚¹è®¿é—®è¿‡äº†çš„è¯ï¼Œé‚£äº›èŠ‚ç‚¹æ˜¯åœ¨ä¸€ä¸ªé›†åˆé‡Œé¢çš„ï¼Œç„¶å èŠ‚ç‚¹éå†æ˜¯ å±äº DFSï¼Œæ‰€ä»¥éƒ½æ˜¯ åˆ†æ”¯è®¿é—®ï¼Œè®¿é—®å®Œè¿™ä¸ª åˆ†æ”¯ï¼Œ èŠ‚ç‚¹è¿›è¡Œæ±‡æ€»é›†åˆã€‚
</code></pre>
</aside>
<p><img src="%E5%B7%A6%E7%A5%9E%E8%AF%BE%E7%A8%8B%E7%AC%94%E8%AE%B0%2017ae0092222580e58afce9620b5d2463/image.png" alt="image.png"></p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">tarjan</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> f)</span></span>&#123;</span><br><span class="line">    vis[u] = <span class="literal">true</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> e = head[u]; e != <span class="number">0</span>; e = ed[e].next)&#123;</span><br><span class="line">        <span class="type">int</span> v = ed[e].to;</span><br><span class="line">        <span class="keyword">if</span>(v != f)&#123;</span><br><span class="line">            <span class="built_in">tarjan</span>(v, u);</span><br><span class="line">            father[v] = u;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> e = q_head[u]; e != <span class="number">0</span>; e = que[e].next)&#123;</span><br><span class="line">        <span class="type">int</span> v = que[e].to;</span><br><span class="line">        <span class="keyword">if</span>(vis[v])&#123;</span><br><span class="line">            ans[que[e].w] = <span class="built_in">find</span>(v);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ol>
<li class="lvl-3">
<p>STè¡¨</p>
</li>
</ol>
<aside>
ğŸ’¡
<p>å½“ Deep æ·±åº¦æ•°ç»„ åˆ°è¾¾åŒä¸€å±‚çš„æ—¶å€™ æ‰€å¯¹åº”çš„ èŠ‚ç‚¹ æ˜¯å¦ç›¸åŒ</p>
<p>ç›¸åŒ ï¼š LCA = Deep å°çš„</p>
<p>ä¸ç›¸åŒï¼š</p>
<p>å†æ¬¡åŒæ—¶é—´è·³ï¼ˆonly ä¸è·³åˆ°åŒä¸€èŠ‚ç‚¹æˆ‘ä»¬æ‰è·³ï¼‰</p>
<p>STè¡¨å®ç°çš„é—®é¢˜ ï¼š åŠ å¿« Deepæ•°ç»„çš„è·³è·ƒè¿‡ç¨‹</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">LCA</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> v)</span></span>&#123;</span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">        uåœ¨ä¸‹é¢    </span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">if</span>(Deep[u] &lt; Deep[v])&#123;</span><br><span class="line">        <span class="type">int</span> t = u;</span><br><span class="line">        u = v;</span><br><span class="line">        v = t;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = power; i &gt;= <span class="number">0</span>; i--)&#123;</span><br><span class="line">        <span class="keyword">if</span>(Deep[ST[u][i]] &gt;= Deep[v])&#123;</span><br><span class="line">            u = ST[u][i];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(u == v)&#123;</span><br><span class="line">        <span class="keyword">return</span> v;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = power; i &gt;= <span class="number">0</span>; i--)&#123;</span><br><span class="line">        <span class="keyword">if</span>(ST[u][i] != ST[v][i])&#123;</span><br><span class="line">            u = ST[u][i];</span><br><span class="line">            v = ST[v][i];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ST[v][<span class="number">0</span>];</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="æ ‘çš„é‡å¿ƒï¼ˆæœ‰ä¸€ä¸ªæˆ–è€…ä¸¤ä¸ªï¼‰">æ ‘çš„é‡å¿ƒï¼ˆæœ‰ä¸€ä¸ªæˆ–è€…ä¸¤ä¸ªï¼‰</h3>
<p>æ ‘çš„é‡å¿ƒçš„åŸºæœ¬å®šä¹‰ï¼š</p>
<ul class="lvl-0">
<li class="lvl-2">
<p>æœ€å¤§å­æ ‘çš„èŠ‚ç‚¹æ•° è¶³å¤Ÿå°</p>
</li>
<li class="lvl-2">
<p>æ¯æ£µå­æ ‘çš„èŠ‚ç‚¹æ•° ä¸è¶…è¿‡ æ€»èŠ‚ç‚¹æ•°çš„ä¸€åŠ</p>
</li>
<li class="lvl-2">
<p>æ‰€æœ‰èŠ‚ç‚¹ æ±‡èšåˆ° é‡å¿ƒçš„ æ­¥æ•°æœ€å°‘</p>
</li>
</ul>
<p>è¡¥å……æ€§è´¨ï¼š</p>
<ul class="lvl-0">
<li class="lvl-2">
<p>ä¸€æ£µæ ‘æœ€å¤šæœ‰ä¸¤ä¸ªé‡å¿ƒï¼Œä¸¤ä¸ªé‡å¿ƒä¸€å®šç›¸é‚»</p>
</li>
<li class="lvl-2">
<p>å¦‚æœæ ‘ä¸Šå¢åŠ æˆ–è€…åˆ é™¤ä¸€ä¸ªå¶èŠ‚ç‚¹ï¼Œé‡å¿ƒæœ€å¤šç§»åŠ¨ä¸€æ¡è¾¹</p>
</li>
<li class="lvl-2">
<p>å°†ä¸¤æ£µæ ‘è¿èµ·æ¥ï¼Œæ–°æ ‘çš„é‡å¿ƒä¸€å®šåœ¨ä¸¤ä¸ªåŸæ¥é‡å¿ƒçš„è¿çº¿ä¸Š</p>
</li>
<li class="lvl-2">
<p>å¦‚æœè¾¹æƒä¸ºæ­£ï¼Œæ‰€æœ‰èŠ‚ç‚¹èµ°å‘é‡å¿ƒçš„ æ€»è·ç¦»å’Œ æœ€å°</p>
</li>
</ul>
<ol>
<li class="lvl-3">
<p>æ±‚æ³•ä¸€ : æœ€å¤§å­æ ‘ è¶³å¤Ÿå°</p>
</li>
</ol>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> ans = <span class="number">0</span>, best = INT_MAX;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">  é‡å¿ƒï¼š</span></span><br><span class="line"><span class="comment">   ä»¥å½“å‰èŠ‚ç‚¹ä¸º é‡å¿ƒï¼Œæ‰€æœ‰å­æ ‘ä¸­ æœ€å¤§æ•°é‡çš„å­æ ‘çš„ æ•°é‡è¶³å¤Ÿå°</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">dfs</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> f)</span></span>&#123;</span><br><span class="line">    Size[u] = <span class="number">1</span>;</span><br><span class="line">    <span class="type">int</span> mx = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> v = head[u]; v != <span class="number">0</span>; v = edge[v].next)&#123;</span><br><span class="line">        <span class="type">int</span> e = edge[v].to;</span><br><span class="line">        <span class="keyword">if</span>(e != f)&#123;</span><br><span class="line">            <span class="built_in">dfs</span>(e,u);</span><br><span class="line">            Size[u] += Size[e];</span><br><span class="line">            mx = <span class="built_in">max</span>(mx, Size[e]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    mx = <span class="built_in">max</span>(mx, n - Size[u]);</span><br><span class="line">    <span class="keyword">if</span>(mx &lt; best || (mx  == best &amp;&amp; u &lt; ans))&#123;</span><br><span class="line">        ans = u;</span><br><span class="line">        mx = best;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ol>
<li class="lvl-3">
<p>æ±‚æ³•äºŒ ï¼šæ¯æ£µå­æ ‘çš„èŠ‚ç‚¹æ•° ä¸è¶…è¿‡æ€»èŠ‚ç‚¹çš„ä¸€åŠ</p>
</li>
</ol>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> Size[N];</span><br><span class="line">vector&lt;<span class="type">int</span>&gt; ans;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">dfs</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> f)</span></span>&#123;</span><br><span class="line">    Size[u] = <span class="number">1</span>;</span><br><span class="line">    <span class="type">int</span> Mx = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> e = head[u]; e != <span class="number">0</span>; e =edge[e].next)&#123;</span><br><span class="line">        <span class="type">int</span> v = edge[e].to;</span><br><span class="line">        <span class="keyword">if</span>(v != f)&#123;</span><br><span class="line">            <span class="built_in">dfs</span>(v,u);</span><br><span class="line">            Size[u] += Size[v];</span><br><span class="line">            Mx = <span class="built_in">max</span>(Size[v], Mx);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    Mx = <span class="built_in">max</span>(Mx, n - Size[u]);</span><br><span class="line">    <span class="keyword">if</span>(Mx &lt;= n / <span class="number">2</span>)&#123;</span><br><span class="line">        ans.<span class="built_in">push_back</span>(u);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æ‰©å±•ï¼š å¸¦ ç‚¹æƒçš„æ ‘ å¦‚ä½•æ±‚é‡å¿ƒ</p>
<p>ä»… ä¿®æ”¹ä¸€ä¸ª â†’ Size[u] çš„åˆå§‹å€¼ å˜æˆäº† ç‚¹æƒé‡ 56åˆ†ä»¥ä¸Š</p>
<aside>
ğŸ’¡
<p>é¦–å…ˆï¼šé‡å¿ƒ æ˜¯ä¸ è¾¹æƒ æ²¡æœ‰å…³ç³»çš„ï¼Œæ‰€è°“çš„ç‚¹æƒï¼Œå¯ä»¥ç†è§£ä¸ºä¸€ä¸ªç‹¬ç«‹çš„æ ‘ï¼Œæ ‘ä¸­çš„èŠ‚ç‚¹æ•°é‡ å°±æ˜¯ ç‚¹çš„æƒé‡</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> Size[N];</span><br><span class="line"><span class="type">int</span> a[N];</span><br><span class="line">vector&lt;<span class="type">int</span>&gt; ans;</span><br><span class="line"><span class="type">int</span> sum; <span class="comment">// sum æ˜¯æ€»ç‚¹æƒå’Œ</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">dfs</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> f)</span></span>&#123;</span><br><span class="line">    Size[u] = a[u];</span><br><span class="line">    <span class="type">int</span> Mx = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> e = head[u]; e != <span class="number">0</span>; e =edge[e].next)&#123;</span><br><span class="line">        <span class="type">int</span> v = edge[e].to;</span><br><span class="line">        <span class="keyword">if</span>(v != f)&#123;</span><br><span class="line">            <span class="built_in">dfs</span>(v,u);</span><br><span class="line">            Size[u] += Size[v];</span><br><span class="line">            Mx = <span class="built_in">max</span>(Size[v], Mx);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    Mx = <span class="built_in">max</span>(Mx, sum - Size[u]);</span><br><span class="line">    <span class="keyword">if</span>(Mx &lt;= sum / <span class="number">2</span>)&#123;</span><br><span class="line">        ans.<span class="built_in">push_back</span>(u);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="æ ‘çš„ç›´å¾„">æ ‘çš„ç›´å¾„</h3>
<p><strong>æ ‘ä¸Šçš„æœ€é•¿è·¯å¾„</strong></p>
<ul class="lvl-0">
<li class="lvl-2">
<p>ä¸¤æ¬¡ DFSï¼ˆä»…ä½¿ç”¨æ²¡æœ‰ è´Ÿè¾¹æƒï¼‰</p>
</li>
</ul>
<aside>
ğŸ’¡èƒ½å¾—åˆ°è·¯å¾„ä¿¡æ¯
1. ä»æ ¹èŠ‚ç‚¹ æ‰¾ç¦»æ ¹èŠ‚ç‚¹æœ€è¿œçš„ç‚¹
2. åœ¨ä» è¿™ä¸ªèŠ‚ç‚¹æ‰¾ç¦»è¿™ä¸ªèŠ‚ç‚¹æœ€è¿œçš„ç‚¹
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">  æ³•ä¸€ï¼š ä¸¤æ¬¡dfs</span></span><br><span class="line"><span class="comment">  ä¼˜ç‚¹ï¼šèƒ½å¾—åˆ°è·¯å¾„ä¿¡æ¯</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="type">int</span> start, End;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> di[N]; <span class="comment">// è®°å½•ä»è§„å®šèŠ‚ç‚¹åˆ° å½“å‰èŠ‚ç‚¹åˆ°è·ç¦»</span></span><br><span class="line"><span class="type">int</span> la[N]; <span class="comment">// è®°å½•è·¯å¾„</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">dfs</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> f, <span class="type">int</span> w)</span></span>&#123;</span><br><span class="line">      la[u] = f;</span><br><span class="line">      di[u] = di[f] + w;</span><br><span class="line">      <span class="keyword">for</span>(<span class="type">int</span> e = head[u]; e != <span class="number">0</span>; e = ed[e].next)&#123;</span><br><span class="line">        <span class="type">int</span> v = ed[e].to;</span><br><span class="line">        <span class="keyword">if</span>(v != f)&#123;</span><br><span class="line">            <span class="built_in">dfs</span>(v, u, ed[e].w);</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">pair&lt;<span class="type">int</span>,<span class="type">int</span>&gt; <span class="title">find_road</span><span class="params">(<span class="type">int</span> n)</span></span>&#123;</span><br><span class="line">    <span class="built_in">dfs</span>(<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">    start = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++)&#123;</span><br><span class="line">        <span class="keyword">if</span>(di[i] &gt; di[start])&#123;</span><br><span class="line">            start = i;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">dfs</span>(start, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">    End = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++)&#123;</span><br><span class="line">        <span class="keyword">if</span>(di[i] &gt; di[End])&#123;</span><br><span class="line">           End = i;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> &#123;start, End&#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<ul class="lvl-0">
<li class="lvl-2">
<p>æ ‘å‹dp</p>
</li>
</ul>
<aside>
ğŸ’¡
<p>åªèƒ½å¾—åˆ° ç›´å¾„é•¿åº¦</p>
<p><img src="%E5%B7%A6%E7%A5%9E%E8%AF%BE%E7%A8%8B%E7%AC%94%E8%AE%B0%2017ae0092222580e58afce9620b5d2463/image%201.png" alt="image.png"></p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> Max_dia = INT_MIN;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">dp</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> f)</span></span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> e = head[u];  e != <span class="number">0</span>; e = ed[e].next)&#123;</span><br><span class="line">        <span class="type">int</span> v = ed[e].to;</span><br><span class="line">        <span class="keyword">if</span>(v != f)&#123;</span><br><span class="line">            <span class="built_in">dp</span>(v, u);</span><br><span class="line">            Max_dia = <span class="built_in">max</span>(Max_dia, dist[u] + dist[v] + ed[e].w);</span><br><span class="line">            dist[u] = <span class="built_in">max</span>(dist[u], dist[v] + ed[e].w);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ç›¸å…³ç»“è®ºï¼ˆè¾¹æƒä¸ºæ­£ï¼‰</p>
<ol>
<li class="lvl-3">
<p>å¦‚æœæœ‰ å¤šæ¡ç›´å¾„ï¼Œè¿™å¤šæ¡ç›´å¾„ä¸€å®š æœ‰ä¸€ä¸ª <strong>å…¬å…±è·¯æ®µ</strong></p>
</li>
<li class="lvl-3">
<p>æ ‘ä¸Šä»»æ„ä¸€ç‚¹ï¼Œç›¸éš”æœ€è¿œçš„ç‚¹çš„é›†åˆï¼Œ<strong>ç›´å¾„çš„ä¸¤ç«¯ç‚¹è‡³å°‘æœ‰ä¸€ä¸ªåœ¨å…¶ä¸­ã€‚</strong></p>
</li>
</ol>
<h3 id="æ ‘ä¸Šå·®åˆ†">æ ‘ä¸Šå·®åˆ†</h3>
<ol>
<li class="lvl-3">
<p>ç‚¹å·®åˆ†</p>
</li>
</ol>
<p><img src="%E5%B7%A6%E7%A5%9E%E8%AF%BE%E7%A8%8B%E7%AC%94%E8%AE%B0%2017ae0092222580e58afce9620b5d2463/image%202.png" alt="image.png"></p>
<aside>
ğŸ’¡
<p><strong>1.è®¡ç®—å…¬å¼</strong> ï¼ˆå­èŠ‚ç‚¹çš„ å˜åŒ– ä¼š<strong>å‘ä¸Šä¼ é€’</strong>)</p>
<p>(x â†’ y) + v</p>
<pre><code>x += v

y += v
</code></pre>
<p>LCA -= v</p>
<p>LCA_father -= v</p>
<p><strong>2.åˆå¹¶</strong></p>
<p>num[i] += num[æ‰€æœ‰å­©å­]</p>
</aside>
<ol>
<li class="lvl-3">
<p>è¾¹å·®åˆ†</p>
</li>
</ol>
<p><img src="%E5%B7%A6%E7%A5%9E%E8%AF%BE%E7%A8%8B%E7%AC%94%E8%AE%B0%2017ae0092222580e58afce9620b5d2463/image%203.png" alt="image.png"></p>
<aside>
ğŸ’¡
<ol>
<li class="lvl-3">
<p>è®¡ç®—å…¬å¼</p>
</li>
</ol>
<p>ç‚¹æƒå˜åŒ–:</p>
<pre><code>   (x â†’ y) + v

    x += v

    y += v

    LCA -=  2*v
</code></pre>
<ol start="2">
<li class="lvl-6">
<p>æ›´æ–°æƒé‡</p>
</li>
</ol>
<p>num[ i â†’ j è¾¹] += weight[ j ]ï¼ˆç‚¹æƒï¼‰</p>
<p>weight[ i ] += weight[ æ‰€æœ‰å­èŠ‚ç‚¹ ]</p>
<h2 id="æ ‘çŠ¶æ•°ç»„ï¼ˆè§†é¢‘ï¼‰">æ ‘çŠ¶æ•°ç»„ï¼ˆè§†é¢‘ï¼‰</h2>
<p>æ ‘çŠ¶æ•°ç»„ æ˜¯ å¤„ç†åŒºé—´æŸ¥è¯¢ çš„æ–¹æ³•ã€‚</p>
<ul class="lvl-0">
<li class="lvl-2">
<p>ä¸€èˆ¬å¤„ç† <strong>å¯å·®åˆ†ä¿¡æ¯ ï¼ˆæ€»ä½“ æ˜¯ ç”±éƒ¨åˆ†æ„æˆçš„ï¼‰| ä¸‹æ ‡ä¸€å®šä» 1 å¼€å§‹</strong></p>
</li>
<li class="lvl-2">
<p>æ€ä¹ˆå¾—åˆ° æœ€å³è¾¹çš„ 1 â†’ i &amp; -i</p>
</li>
</ul>
<p><strong>å¸¸è§æœ‰ä»¥ä¸‹å››ç§æŸ¥è¯¢ç±»å‹</strong></p>
<ul class="lvl-0">
<li class="lvl-2">
<p>å•ç‚¹å¢åŠ  + èŒƒå›´æŸ¥è¯¢</p>
</li>
</ul>
<p>ç®¡ç†èŒƒå›´                                                     (å»é™¤æœ€å³è¾¹çš„ 1ï¼ˆ lowbit(i) ï¼‰ + 1ï¼Œ è‡ªå·±)</p>
<p><img src="%E5%B7%A6%E7%A5%9E%E8%AF%BE%E7%A8%8B%E7%AC%94%E8%AE%B0%2017ae0092222580e58afce9620b5d2463/image%204.png" alt="image.png"></p>
<aside>
ğŸ’¡
<p>è¾“å…¥çš„æ—¶å€™ treeæ•°ç»„ ç”¨add æ–¹æ³•è¿›è¡Œæ·»åŠ </p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> tree[N];</span><br><span class="line"><span class="comment">// å•ç‚¹å¢åŠ   åŒºé—´æŸ¥è¯¢</span></span><br><span class="line"><span class="type">int</span> n; <span class="comment">//æ•°ç»„é•¿åº¦</span></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">lowbit</span><span class="params">(<span class="type">int</span> i)</span></span>&#123;</span><br><span class="line">    <span class="comment">// å–æœ€å³è¾¹çš„ 1</span></span><br><span class="line">    <span class="keyword">return</span> i &amp; -i;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">add</span><span class="params">(<span class="type">int</span> i, <span class="type">int</span> w)</span></span>&#123;</span><br><span class="line">     <span class="comment">// ä¸‹æ ‡ + æœ€å³è¾¹çš„ 1 çš„åœ°æ–¹ + w</span></span><br><span class="line">     <span class="keyword">while</span>(i &lt;= n)&#123;</span><br><span class="line">        tree[i] += w;</span><br><span class="line">        i += <span class="built_in">lowbit</span>(i);</span><br><span class="line">     &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 1 -- r çš„èŒƒå›´å’Œ</span></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">sum</span><span class="params">(<span class="type">int</span> r)</span></span>&#123;</span><br><span class="line">    <span class="comment">// sum = tree[x] è‡ªå·± ç„¶åä¸æ–­å»é™¤æœ€å³è¾¹çš„ 1</span></span><br><span class="line">    <span class="type">int</span> ans = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(r &gt; <span class="number">0</span>)&#123;</span><br><span class="line">        ans += tree[r];</span><br><span class="line">        r -= <span class="built_in">lowbit</span>(r);</span><br><span class="line">    &#125;               </span><br><span class="line">    <span class="keyword">return</span> ans;                                                              </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul class="lvl-0">
<li class="lvl-2">
<p>èŒƒå›´å¢åŠ  + å•ç‚¹æŸ¥è¯¢ ï¼ˆæ”¹æˆå·®åˆ†æ•°ç»„ï¼‰</p>
</li>
</ul>
<aside>
ğŸ’¡
<p>åŸæ•°ç»„ a[i] = sum(delat[1] + â€¦+ delat[i])</p>
<p>delat[i] = a[i] - a[i - 1]</p>
<p>å·®åˆ†æ•°ç»„ å¯ä»¥ å®ç° åŸæ•°ç»„çš„ åŒºé—´å¢å‡</p>
<p>delat[l] + w, delat[r + 1] - w.</p>
<blockquote>
<p>æ„å»º treeæ•°ç»„çš„æ—¶å€™, add_sum( i , w);</p>
</blockquote>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> tree[N];</span><br><span class="line"><span class="comment">// å•ç‚¹å¢åŠ   åŒºé—´æŸ¥è¯¢</span></span><br><span class="line"><span class="type">int</span> n; <span class="comment">//æ•°ç»„é•¿åº¦</span></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">lowbit</span><span class="params">(<span class="type">int</span> i)</span></span>&#123;</span><br><span class="line">    <span class="comment">// å–æœ€å³è¾¹çš„ 1</span></span><br><span class="line">    <span class="keyword">return</span> i &amp; -i;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">add</span><span class="params">(<span class="type">int</span> i, <span class="type">int</span> w)</span></span>&#123;</span><br><span class="line">     <span class="comment">// ä¸‹æ ‡ + æœ€å³è¾¹çš„ 1 çš„åœ°æ–¹ + w</span></span><br><span class="line">     <span class="keyword">while</span>(i &lt;= n)&#123;</span><br><span class="line">        tree[i] += w;</span><br><span class="line">        i += <span class="built_in">lowbit</span>(i);</span><br><span class="line">     &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// æŸ¥è¯¢ r ä½ç½®çš„å€¼</span></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">sum</span><span class="params">(<span class="type">int</span> r)</span></span>&#123;</span><br><span class="line">    <span class="comment">// sum = tree[x] è‡ªå·± ç„¶åä¸æ–­å»é™¤æœ€å³è¾¹çš„ 1</span></span><br><span class="line">    <span class="type">int</span> ans = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(r &gt; <span class="number">0</span>)&#123;</span><br><span class="line">        ans += tree[r];</span><br><span class="line">        r -= <span class="built_in">lowbit</span>(r);</span><br><span class="line">    &#125;               </span><br><span class="line">    <span class="keyword">return</span> ans;                                                              </span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// å¢åŠ  l -&gt; r çš„å€¼</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">add_sum</span><span class="params">(<span class="type">int</span> l, <span class="type">int</span> r)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="built_in">add</span>(l, w),<span class="built_in">add</span>(r + <span class="number">1</span>, -w);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul class="lvl-0">
<li class="lvl-2">
<p>èŒƒå›´å¢åŠ  + èŒƒå›´æŸ¥è¯¢</p>
</li>
</ul>
<aside>
ğŸ’¡
<p>sum(1 â†’ r)</p>
<p>= r * Sum( delat[1 â†’ r] ) - sum(1 â†’ r)[(i - 1) * delat[i] ]\</p>
<h3 id="ç»´æŠ¤-ä¸¤ä¸ªå·®åˆ†æ•°ç»„-Di-ï¼ˆi-1-Di">ç»´æŠ¤ ä¸¤ä¸ªå·®åˆ†æ•°ç»„ Di  +  ï¼ˆi - 1) * Di</h3>
<p><img src="%E5%B7%A6%E7%A5%9E%E8%AF%BE%E7%A8%8B%E7%AC%94%E8%AE%B0%2017ae0092222580e58afce9620b5d2463/image%205.png" alt="image.png"></p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">1e5</span> + <span class="number">10</span>;</span><br><span class="line"><span class="comment">// Di</span></span><br><span class="line"><span class="type">int</span> tree1[N];</span><br><span class="line"><span class="comment">// (i - 1) * Di</span></span><br><span class="line"><span class="type">int</span> tree2[N];</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> n;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">lowbit</span><span class="params">(<span class="type">int</span> i)</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> i &amp; -i;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">add</span><span class="params">(<span class="type">int</span> i, <span class="type">int</span> w)</span></span>&#123;</span><br><span class="line">    <span class="type">int</span> t = i;</span><br><span class="line">    <span class="keyword">while</span>(t &lt;= n)&#123;</span><br><span class="line">        tree1[t] += w;</span><br><span class="line">        t += <span class="built_in">lowbit</span>(t);</span><br><span class="line">    &#125;</span><br><span class="line">    t = i;</span><br><span class="line">    <span class="type">int</span> W = (i - <span class="number">1</span>) * w;</span><br><span class="line">    <span class="keyword">while</span>(t &lt;= n)&#123;</span><br><span class="line">        tree2[t] += W;</span><br><span class="line">        t += <span class="built_in">lowbit</span>(t);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">Add</span><span class="params">(<span class="type">int</span> l, <span class="type">int</span> r, <span class="type">int</span> w)</span></span>&#123;</span><br><span class="line">    <span class="built_in">add</span>(l, w); <span class="built_in">add</span>(r + <span class="number">1</span>, -w);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 1 -&gt; i çš„å’Œ</span></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">sum</span><span class="params">(<span class="type">int</span> i)</span></span>&#123;</span><br><span class="line">    <span class="type">int</span> ans = <span class="number">0</span>, t = i;</span><br><span class="line">    <span class="keyword">while</span>(t &gt; <span class="number">0</span>)&#123;</span><br><span class="line">        ans += (tree1[t] * i);</span><br><span class="line">        ans -= tree2[t];</span><br><span class="line">        t = t - <span class="built_in">lowbit</span>(t);</span><br><span class="line">    &#125;  </span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul class="lvl-0">
<li class="lvl-2">
<p>äºŒç»´çš„å•ç‚¹å¢åŠ  + èŒƒå›´æŸ¥è¯¢</p>
</li>
</ul>
<p>è¦ä» 1 1å¼€å§‹</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">1e3</span> + <span class="number">10</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> M = <span class="number">1e3</span> + <span class="number">10</span>;</span><br><span class="line"><span class="type">int</span> tree[N][M];</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> n, m;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">lowbit</span><span class="params">(<span class="type">int</span> i)</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> i &amp; -i;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">add</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> y, <span class="type">int</span> w)</span></span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = x; i += <span class="built_in">lowbit</span>(i); i &lt;= n)&#123;</span><br><span class="line">       <span class="keyword">for</span>(<span class="type">int</span> j = y; j += <span class="built_in">lowbit</span>(j); j &lt;= m)&#123;</span><br><span class="line">        tree[i][j] += w;</span><br><span class="line">       &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 1 -&gt; x 1 -&gt; y</span></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">sum</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> y)</span></span>&#123;</span><br><span class="line">     <span class="type">int</span> ans = <span class="number">0</span>;</span><br><span class="line">     <span class="keyword">for</span>(<span class="type">int</span> i = x; i &gt; <span class="number">0</span>; i -= <span class="built_in">lowbit</span>(i))&#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> j = y; j &gt; <span class="number">0</span>; j-= <span class="built_in">lowbit</span>(j))&#123;</span><br><span class="line">            ans += tree[i][j];</span><br><span class="line">        &#125;</span><br><span class="line">     &#125;</span><br><span class="line">     <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul class="lvl-0">
<li class="lvl-2">
<p>äºŒç»´æ•°ç»„çš„ èŒƒå›´å¢åŠ  + èŒƒå›´æŸ¥è¯¢</p>
</li>
</ul>
<aside>
ğŸ’¡
<p>delat[i] = a[i][j] - a[i-1][j] - a[i][j-1] + a[i-1][j-1]</p>
<p>a[i][j] =  (1, 1) â†’ (i, j) çš„ delat ç´¯åŠ å’Œ</p>
</aside>
<p><img src="%E5%B7%A6%E7%A5%9E%E8%AF%BE%E7%A8%8B%E7%AC%94%E8%AE%B0%2017ae0092222580e58afce9620b5d2463/image%206.png" alt="image.png"></p>
<h3 id="é€†åºé˜Ÿé—®é¢˜">é€†åºé˜Ÿé—®é¢˜</h3>
<h2 id="çº¿æ®µæ ‘">çº¿æ®µæ ‘</h2>
<p>åŸºæœ¬çº¿æ®µæ ‘</p>
<h1>åŠ¨æ€è§„åˆ’ï¼ˆå…ˆåšé¢˜ç›®ï¼‰</h1>
<h2 id="èƒŒåŒ…dp-ï¼ˆ66-75ï¼‰">èƒŒåŒ…dp ï¼ˆ66 - 75ï¼‰</h2>
<h2 id="åŒºé—´dp">åŒºé—´dp</h2>
<p>å°†å¤§èŒƒå›´ åˆ’åˆ†ä¸º è‹¥å¹²ä¸ª å°èŒƒå›´ çš„é—®é¢˜</p>
<aside>
ğŸ’¡
<p>å¯èƒ½æ€§å±•å¼€ï¼š</p>
<p>åŸºäº <strong>ä¸¤ä¾§ç«¯ç‚¹</strong> è®¨è®º</p>
<p>åŸºäº <strong>èŒƒå›´åˆ’åˆ†</strong> è®¨è®º</p>
<h2 id="çŠ¶æ€dp">çŠ¶æ€dp</h2>
<p>åˆ©ç”¨ äºŒè¿›åˆ¶ çš„ 0 1 æ¥è¡¨ç¤º èŠ‚ç‚¹ çŠ¶æ€</p>
<h2 id="æ ‘å‹dp">æ ‘å‹dp</h2>
<p>å°† å­æ ‘çš„ ä¿¡æ¯ è¿”å›ç»™çˆ¶äº²</p>
<aside>
ğŸ’¡
<p>çˆ¶äº²èŠ‚ç‚¹çš„ ans <strong>ä¾èµ–äº å­æ ‘çš„ä¿¡æ¯</strong></p>
</aside>
<h2 id="æ•°ä½dp">æ•°ä½dp</h2>
<p>åˆ¤æ–­ <strong>æ•°å­—çš„ å¯èƒ½æ€§</strong></p>
<aside>
ğŸ’¡
<p>å¤§éƒ¨åˆ†éƒ½æ˜¯ ä»å·¦ å‘ å³ è¿›è¡Œå°è¯•ï¼ˆçº¿æ€§å±•å¼€ï¼‰</p>
<h2 id="æ¢æ ¹dp">æ¢æ ¹dp</h2>
<p>å°† æ ¹èŠ‚ç‚¹ äº’æ¢ï¼Œè¦æ±‚å€¼çš„å˜åŒ–</p>
<h2 id="è½®å»“çº¿dp">è½®å»“çº¿dp</h2>
<h2 id="ä¸‰è¿›åˆ¶çŠ¶å‹dp">ä¸‰è¿›åˆ¶çŠ¶å‹dp</h2>
<h2 id="dpä¼˜åŒ–">dpä¼˜åŒ–</h2>
<h1>å­—ç¬¦ä¸²</h1>
<h2 id="KMP">KMP</h2>
<p><strong>å‰ç¼€å‡½æ•°</strong></p>
<aside>
ğŸ’¡
<p>NEXT å‡½æ•°æ„å»º</p>
<pre><code> å‰åç¼€ åŒ¹é…é•¿åº¦
</code></pre>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> Next[N];</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">get_next</span><span class="params">(string s)</span></span>&#123;</span><br><span class="line">    Next[<span class="number">0</span>] = <span class="number">-1</span>;</span><br><span class="line">    Next[<span class="number">1</span>] = <span class="number">0</span>;</span><br><span class="line">    <span class="type">int</span> i = <span class="number">2</span>, cn = <span class="number">0</span>;</span><br><span class="line">    <span class="comment">// Next[i] è¡¨ç¤ºçš„æ˜¯ 1 - i-1 çš„æœ€é•¿å‰åç¼€åŒ¹é…é•¿åº¦</span></span><br><span class="line">    <span class="keyword">while</span>(i &lt; s.<span class="built_in">size</span>())&#123;</span><br><span class="line">        <span class="keyword">if</span>(s[i - <span class="number">1</span>] == s[cn])&#123;</span><br><span class="line">            Next[i++] = ++cn;</span><br><span class="line">        &#125;<span class="keyword">else</span> <span class="keyword">if</span>(cn &gt; <span class="number">0</span>)&#123;</span><br><span class="line">            cn = Next[cn];</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            Next[i++] = <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<aside>
ğŸ’¡
<p>KMP æ˜¯ä¾é è¿™ä¸ª å‰ç¼€å‡½æ•°æ¥å®ç°çš„</p>
<p>å¦‚æœå½“å‰ çš„å­—ç¬¦ä¸åŒ¹é…</p>
<p>éœ€è¦æ£€æµ‹çš„ å­—ç¬¦ï¼Œæ ¹æ® NEXT æ•°ç»„ å‘å‰è·³è½¬</p>
<h3 id="æ‰©å±•-KMP-ï¼ˆZæ•°ç»„ï¼‰å‰ç¼€åŒ¹é…é—®é¢˜">æ‰©å±• KMP ï¼ˆZæ•°ç»„ï¼‰å‰ç¼€åŒ¹é…é—®é¢˜</h3>
<p>åŠ¨æ€å›¾å±•ç¤º ğŸ”—ï¼š<a target="_blank" rel="noopener" href="https://personal.utdallas.edu/~besp/demo/John2010/z-algorithm.htm">https://personal.utdallas.edu/~besp/demo/John2010/z-algorithm.htm</a></p>
<aside>
ğŸ’¡
<p><strong>Z[i] è¡¨ç¤º s[0 - n-1] å’Œ s[i - n-1] çš„æœ€é•¿åŒ¹é…é•¿åº¦</strong></p>
<p>çº¿æ€§åŠ é€Ÿè¿‡ç¨‹ï¼š</p>
<pre><code>   å¦‚æœåœ¨æœ€å³çš„æœ€é•¿å‰ç¼€åŒ¹é…åŒºé—´ä¸­ï¼Œä¼šåŠ é€Ÿå‰ç¼€åŠ é€ŸåŒ¹é…è¿‡ç¨‹
</code></pre>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">2e6</span> + <span class="number">10</span>;</span><br><span class="line"><span class="type">int</span> z[N];</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">Z</span><span class="params">(string s)</span></span>&#123;</span><br><span class="line">     z[<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line">     <span class="type">int</span> n = s.<span class="built_in">size</span>();</span><br><span class="line">     <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>, r = <span class="number">0</span>, l = <span class="number">0</span>; i &lt; n;i++)&#123;</span><br><span class="line">         <span class="keyword">if</span>(i &lt;= r &amp;&amp; z[i - l] &lt; r - i + <span class="number">1</span>)&#123;</span><br><span class="line">            z[i] = z[i - l];</span><br><span class="line">         &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            z[i] = <span class="built_in">max</span>(<span class="number">0</span>, r - i + <span class="number">1</span>);</span><br><span class="line">            <span class="keyword">while</span>(i + z[i] &lt; n &amp;&amp; s[z[i]] == s[i + z[i]]) z[i]++;</span><br><span class="line">            <span class="keyword">if</span>(i + z[i] - <span class="number">1</span> &gt; r)&#123;</span><br><span class="line">                r = i + z[i] - <span class="number">1</span>;</span><br><span class="line">                l = i;</span><br><span class="line">            &#125;</span><br><span class="line">     &#125;</span><br><span class="line">     &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="Manacher">Manacher</h2>
<aside>
ğŸ’¡
<p><strong>P[i] æ•°ç»„æ˜¯ä¿ç•™äº†æ›´æ–°çš„æ•°ç»„çš„å›æ–‡ä¸²é•¿åº¦</strong></p>
<p><strong># a # a # a #          æ€»é•¿åº¦ ä¸º 2 * n + 1</strong></p>
<p><strong>1 2 3 4 3 2 1</strong></p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">3e7</span>;</span><br><span class="line"><span class="type">int</span> p[N];</span><br><span class="line"><span class="type">int</span> Max = <span class="number">0</span>;</span><br><span class="line"><span class="function">string <span class="title">c</span><span class="params">(string s)</span></span>&#123;</span><br><span class="line">    string s1 = <span class="string">&quot;#&quot;</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">auto</span> x : s)&#123;</span><br><span class="line">       s1 += x;</span><br><span class="line">       s1 += <span class="string">&#x27;#&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> s1;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">manacher</span><span class="params">(string s)</span></span>&#123;</span><br><span class="line">     <span class="type">int</span> n = s.<span class="built_in">length</span>();</span><br><span class="line">     <span class="type">int</span> c = <span class="number">0</span>, r = <span class="number">0</span>;</span><br><span class="line">     <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>, len; i &lt; n; i++)&#123;</span><br><span class="line">        len = r &gt; i ? <span class="built_in">min</span>(p[<span class="number">2</span> * c - i], r - i) : <span class="number">1</span>; <span class="comment">// è‡³å°‘çš„å›æ–‡åŠå¾„åŒºåŸŸ</span></span><br><span class="line">        <span class="keyword">while</span>(i  + len &lt; n &amp;&amp; i - len &gt;= <span class="number">0</span> &amp;&amp; s[i + len] == s[i - len] )&#123;</span><br><span class="line">            len ++;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(i + len &gt; r)&#123;</span><br><span class="line">            c = i;</span><br><span class="line">            r = i + len;</span><br><span class="line">        &#125;</span><br><span class="line">        Max = <span class="built_in">max</span>(Max, len);</span><br><span class="line">         p[i] = len;</span><br><span class="line">     &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="ACè‡ªåŠ¨æœº">ACè‡ªåŠ¨æœº</h2>
<h2 id="å­—ç¬¦ä¸²å“ˆå¸Œ">å­—ç¬¦ä¸²å“ˆå¸Œ</h2>
<h1>æ•°å­¦</h1>
<h2 id="åŸƒå¼ç­›">åŸƒå¼ç­›</h2>
<aside>
ğŸ’¡
<p>å¦‚æœè¿™ä¸ª å…ƒç´  æ²¡æœ‰è®¿é—®è¿‡ï¼Œä¾¿æ˜¯è´¨æ•°ï¼Œå¹¶ä¸” <strong>è¿™ä¸ªè´¨æ•°çš„æ‰€æœ‰å€æ•°çš„å€¼ å°±ä¸æ˜¯è´¨æ•°</strong></p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">ehrlich</span><span class="params">(<span class="type">int</span> n)</span></span>&#123;</span><br><span class="line">    <span class="function">vector&lt;<span class="type">bool</span>&gt; <span class="title">vis</span><span class="params">(n + <span class="number">1</span>, <span class="literal">false</span>)</span></span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">2</span>; i * i &lt;= n; i++)&#123;</span><br><span class="line">        <span class="keyword">if</span>(!vis[i])&#123;</span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> j = i * i; j &lt;= n; j +=i)&#123;</span><br><span class="line">                vis[j] = <span class="literal">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="type">int</span> cnt = <span class="number">0</span>; <span class="comment">// è´¨æ•° è®°æ•° vis æœªè®¿é—®è¿‡çš„ ä¾¿æ˜¯è´¨æ•°å­—</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++)&#123;</span><br><span class="line">        <span class="keyword">if</span>(!vis[i])&#123;</span><br><span class="line">            cnt ++;</span><br><span class="line">            cout &lt;&lt; i &lt;&lt; <span class="string">&quot; &quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;cout &lt;&lt; endl;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<h2 id="ä¹˜æ³•é€†å…ƒ">ä¹˜æ³•é€†å…ƒ</h2>
<p>$$<br>
é€†å…ƒå«ä¹‰ ï¼š x\rightarrow \frac{1}{x}<br>
$$</p>
<p><strong>æ³•ä¸€ ï¼šæ‰©å±•æ¬§å‡ é‡Œå¾— æ±‚é€†å…ƒ</strong></p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="type">long</span> <span class="type">long</span> LL;</span><br><span class="line"><span class="function">LL <span class="title">ExGCD</span><span class="params">(LL a, LL mod, LL &amp;x, LL &amp;y)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(mod == <span class="number">0</span>)&#123;</span><br><span class="line">        x = <span class="number">1</span>; y = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">return</span> a;</span><br><span class="line">    &#125;</span><br><span class="line">    LL d = <span class="built_in">ExGCD</span>(mod, a % mod, x, y), t = x;</span><br><span class="line">    x = y; y = t - a / mod * x;</span><br><span class="line">    <span class="keyword">return</span> d;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">ExGcdInv</span><span class="params">(<span class="type">int</span> a, <span class="type">int</span> mod)</span></span>&#123;</span><br><span class="line">    LL x, y;</span><br><span class="line">    <span class="built_in">ExGCD</span>(a, mod, x, y);</span><br><span class="line">    <span class="keyword">return</span> (x + mod) % mod;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p><strong>æ³•äºŒ ï¼š å¿«é€Ÿå¹‚ æ±‚é€†å…ƒ</strong></p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">LL <span class="title">fastpow</span><span class="params">(<span class="type">int</span> a, <span class="type">int</span> b, <span class="type">int</span> mod)</span></span>&#123;</span><br><span class="line">    LL ret = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span>(b)&#123;</span><br><span class="line">        <span class="keyword">if</span>(b &amp; <span class="number">1</span>) ret = ret * a % mod;</span><br><span class="line">        a = a * a % mod;</span><br><span class="line">        b &gt;&gt;= <span class="number">1</span>; </span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">LL <span class="title">FermatInv</span><span class="params">(<span class="type">int</span> a, <span class="type">int</span> mod)</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">fastpow</span>(a, mod - <span class="number">2</span>, mod);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>æ³•ä¸‰ ï¼š è´¹é©¬å°é€’æ¨ æ±‚é€†å…ƒ</strong></p>
<p>$$<br>
\text{inv}[i] = ( \text{mod} - (\text{mod} \div i) ) \times \text{inv}[\text{mod} % i] % \text{mod}<br>
$$</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> invList[mod+ <span class="number">10</span>];</span><br><span class="line"><span class="built_in">voidGetInv</span>(<span class="type">int</span> mod)</span><br><span class="line">&#123;</span><br><span class="line">    invList[<span class="number">1</span>]= <span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i= <span class="number">2</span>; i&lt; mod; i++)</span><br><span class="line">        invList[i]= <span class="number">1LL</span>* (mod- mod/ i)* invList[mod% i]% mod;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="å®¹æ–¥åŸç†">å®¹æ–¥åŸç†</h2>
<p><strong>å¥‡ â•Â å¶ â–</strong><br>
$$<br>
\textbf{ä¸¤ä¸ªé›†åˆï¼š} \quad<br>
|A \cup B| = |A| + |B| - |A \cap B|<br>
$$</p>
<p>$$<br>
\textbf{ä¸‰ä¸ªé›†åˆï¼š} \quad<br>
|A \cup B \cup C| = |A| + |B| + |C|</p>
<ul class="lvl-0">
<li class="lvl-2">
<p>|A \cap B| - |A \cap C| - |B \cap C|</p>
</li>
</ul>
<ul class="lvl-0">
<li class="lvl-2">
<p>|A \cap B \cap C|<br>
$$</p>
</li>
</ul>
<p>$$<br>
\textbf{n ä¸ªé›†åˆçš„æƒ…å†µï¼ˆå®¹æ–¥åŸç†ï¼‰ï¼š} \quad<br>
\left| \bigcup_{i=1}^{n} A_i \right|<br>
= \sum_{k=1}^{n} (-1)^{k+1}<br>
\sum_{1 \leq i_1 &lt; i_2 &lt; \dots &lt; i_k \leq n}<br>
\left| A_{i_1} \cap A_{i_2} \cap \dots \cap A_{i_k} \right|<br>
$$</p>
<p>ç›¸å…³é¢˜ç›®ï¼š</p>
<ul class="lvl-0">
<li class="lvl-2">
<p>è®¡ç®—åŒºé—´ [1,n] å†…ä¸è¢«ç»™å®šè´¨æ•°æ•´é™¤çš„æ•´æ•°ä¸ªæ•°</p>
</li>
</ul>
<aside>
ğŸ’¡
<p>å› ä¸º éœ€è¦éšæœºé€‰ a0 â†’ an ä¸­çš„ä»»æ„å‡ ä¸ªæ•°çš„ç»„åˆï¼Œæ‰€ä»¥ç”¨ <strong>äºŒè¿›åˆ¶çš„å½¢å¼</strong> æ¥è®¡ç®—</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="type">long</span> <span class="type">long</span> LL;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">lcm</span><span class="params">(<span class="type">int</span> a, <span class="type">int</span> b)</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> a / __gcd(a, b) * b;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="type">int</span> k, n;</span><br><span class="line">    cin &gt;&gt; k &gt;&gt; n;</span><br><span class="line">    <span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">a</span><span class="params">(k)</span></span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">auto</span>&amp; x : a)&#123;</span><br><span class="line">        cin &gt;&gt; x;</span><br><span class="line">    &#125;</span><br><span class="line">    LL t = <span class="number">1</span> &lt;&lt; k; </span><br><span class="line">    LL result = <span class="number">0</span>;   </span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= t; i++)&#123;</span><br><span class="line">        <span class="type">int</span> l = <span class="number">1</span>, bits = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> j = <span class="number">0</span>; j &lt; k; j++)&#123;</span><br><span class="line">           <span class="keyword">if</span>(i &amp; (<span class="number">1</span> &lt;&lt; j))&#123;</span><br><span class="line">             bits++;</span><br><span class="line">             <span class="keyword">if</span>(l &gt; n / a[i])&#123;</span><br><span class="line">                l = n + <span class="number">1</span>;</span><br><span class="line">                <span class="comment">// ç›¸å½“äº æ²¡å¿…è¦è¿›è¡Œåç»­è®¡ç®— å› ä¸º n / l == 0</span></span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">             &#125;</span><br><span class="line">             l = <span class="built_in">lcm</span>(l, a[i]);</span><br><span class="line">           &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(bits % <span class="number">2</span>) result += n / l;</span><br><span class="line">        <span class="keyword">else</span> result -= n / l;</span><br><span class="line">    &#125;</span><br><span class="line">    cout &lt;&lt; n - result &lt;&lt; endl;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul class="lvl-0">
<li class="lvl-2">
<p>è®¡ç®—éäº’è´¨æ•´æ•°å¯¹çš„ä¸ªæ•°</p>
</li>
<li class="lvl-2">
<p>è®¡ç®—ç¬¦åˆæ’åˆ—æ¡ä»¶çš„æ–¹æ¡ˆæ•°ï¼ˆnï¼çš„æ’åˆ—ä¸­ï¼Œè‡³å°‘æœ‰ k ä¸ªå­—ç¬¦ åœ¨åŸä½ä¸Šçš„ ä¸ªæ•°ï¼‰</p>
</li>
</ul>
<h2 id="å¿«é€Ÿå¹‚">å¿«é€Ÿå¹‚</h2>
<ul class="lvl-0">
<li class="lvl-2">
<p>åŸºæœ¬å¿«é€Ÿå¹‚</p>
</li>
</ul>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="type">long</span> <span class="type">long</span> LL;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> mod = <span class="number">1e9</span> + <span class="number">7</span>;</span><br><span class="line"><span class="function">LL <span class="title">fastpow</span><span class="params">(<span class="type">int</span> a, <span class="type">int</span> b)</span></span>&#123;</span><br><span class="line">    LL ant = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span>(b)&#123;</span><br><span class="line">        <span class="keyword">if</span>(b &amp; <span class="number">1</span>)&#123;</span><br><span class="line">            ant = ant * a %mod;</span><br><span class="line">        &#125;</span><br><span class="line">        a = a * a %mod;</span><br><span class="line">        b &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ant % mod;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul class="lvl-0">
<li class="lvl-2">
<p>çŸ©é˜µå¿«é€Ÿå¹‚</p>
</li>
</ul>
<aside>
ğŸ’¡
<p>çŸ©é˜µå¿«é€Ÿå¹‚ å¸¸ç”¨äº DPï¼ˆå›ºå®šçº¿æ€§é€’å½’ï¼‰é—®é¢˜</p>
<ol>
<li class="lvl-3">
<p><strong>ä¸€ç»´ ké˜¶</strong>ï¼ˆk ä¸ªå¼å­ï¼‰ <strong>æ—¶é—´å¤æ‚åº¦ ï¼šO(logn * 2^k)</strong></p>
</li>
</ol>
<p>$$<br>
f(n) = c_1 f(n-1) + c_2 f(n-2) + â€¦ + c_k f(n-k)<br>
$$</p>
<ol>
<li class="lvl-3">
<p><strong>kç»´ä¸€é˜¶</strong></p>
</li>
</ol>
<p>$$<br>
\mathbf{X}n = A \mathbf{X}{n-1}<br>
$$</p>
<aside>
ğŸ’¡
<p>ç›¸å½“äº ç¬¬ i ä½ç½®çš„ ans éœ€è¦ç¬¬ i-1 ä½ç½®çš„ ansï¼ˆå¯èƒ½æ˜¯äºŒç»´çš„ï¼Œä»¥ä¸ºç€éœ€è¦ i-1 ä½ç½®çš„å¤šä¸ªç­”æ¡ˆï¼‰</p>
<h3 id="çŸ©é˜µå¿«é€Ÿå¹‚çš„åŸºæœ¬ä¼ªä»£ç ">çŸ©é˜µå¿«é€Ÿå¹‚çš„åŸºæœ¬ä¼ªä»£ç </h3>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">vector&lt;vector&lt;<span class="type">int</span>&gt;&gt; <span class="built_in">multiply</span>(vector&lt;vector&lt;<span class="type">int</span>&gt;&gt; a, vector&lt;vector&lt;<span class="type">int</span>&gt;&gt; b)&#123;</span><br><span class="line">    <span class="type">int</span> n = a.<span class="built_in">size</span>();</span><br><span class="line">    <span class="type">int</span> m = b[<span class="number">0</span>].<span class="built_in">size</span>();</span><br><span class="line">    <span class="type">int</span> k = a[<span class="number">0</span>].<span class="built_in">size</span>();</span><br><span class="line">    vector&lt;vector&lt;<span class="type">int</span>&gt;&gt; <span class="built_in">ans</span>(n, <span class="built_in">vector</span>&lt;<span class="type">int</span>&gt;(m));</span><br><span class="line">    <span class="comment">// ans[i][j] == açš„ ç¬¬iè¡Œ * bçš„ ç¬¬jåˆ—</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; i++)&#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> j = <span class="number">0</span>; j &lt; m; j++)&#123;</span><br><span class="line">            <span class="type">int</span> temp = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> t = <span class="number">0</span>; t &lt; k; t++)&#123;</span><br><span class="line">                ans[i][j] +=a[i][t] * b[t][j];</span><br><span class="line">            &#125;</span><br><span class="line">         </span><br><span class="line">        &#125;</span><br><span class="line">    &#125; </span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">vector&lt;vector&lt;<span class="type">int</span>&gt;&gt; <span class="built_in">power</span>(vector&lt;vector&lt;<span class="type">int</span>&gt;&gt; a, <span class="type">int</span> t)&#123;</span><br><span class="line">    <span class="type">int</span> n = a.<span class="built_in">size</span>();</span><br><span class="line">    vector&lt;vector&lt;<span class="type">int</span>&gt;&gt; <span class="built_in">ans</span>(n, <span class="built_in">vector</span>&lt;<span class="type">int</span>&gt; (n, <span class="number">0</span>));</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; i++) ans[i][i] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span>(t)&#123;</span><br><span class="line">        <span class="keyword">if</span>(t &amp; <span class="number">1</span>) ans = <span class="built_in">multiply</span>(ans, a);</span><br><span class="line">        a = <span class="built_in">multiply</span>(a, a);</span><br><span class="line">        t &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="çŸ©é˜µå¿«é€Ÿå¹‚çš„ä½¿ç”¨">çŸ©é˜µå¿«é€Ÿå¹‚çš„ä½¿ç”¨</h3>
<p><strong>æ€ä¹ˆæ±‚å…³ç³»çŸ©é˜µ</strong></p>
<ol>
<li class="lvl-3">
<p>ä¸€ç»´ k é˜¶</p>
</li>
</ol>
<p>$$<br>
f(n) = c_1 f(n-1) + c_2 f(n-2) + â€¦ + c_k f(n-k)<br>
$$</p>
<p>$$<br>
V_n =<br>
\begin{bmatrix}<br>
f(n) &amp; f(n-1) &amp; \dots &amp; f(n-k+1)<br>
\end{bmatrix}</p>
<p>çŸ©é˜µé€’æ¨å…³ç³»ï¼š<br>
V_n = V_{n-1} \times T{\prime}<br>
$$</p>
<p>$$<br>
å…³ç³»çŸ©é˜µ<br>
T{\prime} =<br>
\begin{bmatrix}<br>
c_1 &amp; 1 &amp; 0 &amp; 0 &amp; \dots &amp; 0 \<br>
c_2 &amp; 0 &amp; 1 &amp; 0 &amp; \dots &amp; 0 \<br>
c_3 &amp; 0 &amp; 0 &amp; 1 &amp; \dots &amp; 0 \<br>
\vdots &amp; \vdots &amp; \vdots &amp; \vdots &amp; \ddots &amp; \vdots \<br>
c_k &amp; 0 &amp; 0 &amp; 0 &amp; \dots &amp; 0<br>
\end{bmatrix}<br>
$$</p>
<ol>
<li class="lvl-3">
<p>kç»´ ä¸€é˜¶</p>
</li>
</ol>
<p>$$<br>
\mathbf{X}n = \mathbf{X}{n-1} \times A<br>
$$</p>
<p>$$<br>
çŠ¶æ€å‘é‡ ï¼š \mathbf{X}_n = [x_1(n), x_2(n), â€¦, x_k(n)]<br>
$$</p>
<p>$$<br>
x_1(n) = c_1 x_1(n-1) + c_2 x_2(n-1) + \dots + c_k x_k(n-1)\<br>
x_2(n) = d_1 x_1(n-1) + d_2 x_2(n-1) + \dots + d_k x_k(n-1)\</p>
<p>x_3(n) = e_1 x_1(n-1) + e_2 x_2(n-1) + \dots + e_k x_k(n-1)</p>
<p>\\dots\</p>
<p>x_k(n) = f_1 x_1(n-1) + f_2 x_2(n-1) + \dots + f_k x_k(n-1)<br>
$$</p>
<p>$$<br>
A =<br>
\begin{bmatrix}<br>
c_1 &amp; d_1 &amp; e_1 &amp; \dots &amp; f_1 \<br>
c_2 &amp; d_2 &amp; e_2 &amp; \dots &amp; f_2 \<br>
c_3 &amp; d_3 &amp; e_3 &amp; \dots &amp; f_3 \<br>
\vdots &amp; \vdots &amp; \vdots &amp; \ddots &amp; \vdots \<br>
c_k &amp; d_k &amp; e_k &amp; \dots &amp; f_k<br>
\end{bmatrix}<br>
$$</p>
</div><div class="article-licensing box"><div class="licensing-title"><p>è€ç®—æ³•ç¬”è®°</p><p><a href="http://whalefall.fun/2025/03/25/è€ç®—æ³•ç¬”è®°/">http://whalefall.fun/2025/03/25/è€ç®—æ³•ç¬”è®°/</a></p></div><div class="licensing-meta level is-mobile"><div class="level-left"><div class="level-item is-narrow"><div><h6>ä½œè€…</h6><a href="http://whalefall.fun"><p>Jiely</p></a></div></div><div class="level-item is-narrow"><div><h6>å‘å¸ƒäº</h6><p>2025-03-25</p></div></div><div class="level-item is-narrow"><div><h6>æ›´æ–°äº</h6><p>2025-06-10</p></div></div><div class="level-item is-narrow"><div><h6>è®¸å¯åè®®</h6><p><a class="icon" rel="noopener" target="_blank" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a><a class="icon" rel="noopener" target="_blank" title="Attribution" href="https://creativecommons.org/licenses/by/4.0/"><i class="fab fa-creative-commons-by"></i></a><a class="icon" rel="noopener" target="_blank" title="Noncommercial" href="https://creativecommons.org/licenses/by-nc/4.0/"><i class="fab fa-creative-commons-nc"></i></a></p></div></div></div></div></div><div class="recommend-area"><div class="recommend-post"><span class="is-size-6 has-text-grey has-mr-7">#Â ç›¸å…³æ–‡ç« </span><br><span>Â Â 1.<a class="is-size-6" href="/2025/05/06/%E7%AE%97%E6%B3%95%E6%9D%BF%E5%AD%90/" target="_blank">ç®—æ³•çŸ¥è¯†å†Œ</a><br></span><span>Â Â 2.<a class="is-size-6" href="/2025/04/17/%E7%AE%97%E6%B3%95%E4%B9%8B%E7%BE%8E/" target="_blank">ç®—æ³•ä¹‹ç¾</a><br></span><span>Â Â 3.<a class="is-size-6" href="/2025/04/15/ACM%E9%9B%86%E8%AE%AD%E9%A2%98/" target="_blank">ACMé›†è®­é¢˜</a><br></span><span>Â Â 4.<a class="is-size-6" href="/2025/03/24/PYTHON%E7%AE%97%E6%B3%95%E5%AD%A6%E4%B9%A0/" target="_blank">PYTHON ç®—æ³•å­¦ä¹ </a><br></span></div></div><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/social-share.js/1.0.16/css/share.min.css"><div class="social-share"></div><script src="https://cdnjs.loli.net/ajax/libs/social-share.js/1.0.16/js/social-share.min.js"></script></article></div><!--!--><nav class="post-navigation mt-4 level is-mobile"><div class="level-start"><a class="article-nav-prev level-item  link-muted" href="/2025/04/12/%E6%95%B0%E6%8D%AE%E5%BA%93%E5%9F%BA%E7%A1%80/"><i class="fas fa-chevron-left"></i><span>æ•°æ®åº“åŸºç¡€å­¦ä¹ </span></a></div><div class="level-end"><a class="article-nav-next level-item  link-muted" href="/2025/03/25/%E5%8D%9A%E5%AE%A2%E5%BC%80%E7%AB%AF/"><span>ç¬¬ä¸€ä¸ªåšå®¢ï¼æ–°çš„ä¸–ç•Œï¼</span><i class="fas fa-chevron-right"></i></a></div></nav><!--!--></div><div class="column column-left is-4-tablet is-4-desktop is-3-widescreen  order-1"><div class="card widget" id="toc" data-type="toc"><div class="card-content"><div class="menu"><h3 class="menu-label">ç›®å½•</h3><ul class="menu-list"><li><a class="is-flex is-mobile" href="#"><span class="mr-2">1</span><span>å·¦ç¥è¯¾ç¨‹ç¬”è®°</span></a></li><li><a class="is-flex is-mobile" href="#"><span class="mr-2">2</span><span>å‰ç½®åŸºæœ¬é—®é¢˜ï¼š</span></a><ul class="menu-list"><li><a class="is-flex is-mobile" href="#1-å½’å¹¶åˆ†æ²»ç®—æ³•"><span class="mr-2">2.1</span><span>1. å½’å¹¶åˆ†æ²»ç®—æ³•</span></a><ul class="menu-list"><li><a class="is-flex is-mobile" href="#å¤§èŒƒå›´çš„ç­”æ¡ˆ-ç­‰ä¸ç­‰äº-å·¦è¾¹éƒ¨åˆ†-å³è¾¹éƒ¨åˆ†-è·¨è¶Šå·¦å³ä¸¤è¾¹çš„ç­”æ¡ˆ"><span class="mr-2">2.1.1</span><span>å¤§èŒƒå›´çš„ç­”æ¡ˆ  ç­‰ä¸ç­‰äº å·¦è¾¹éƒ¨åˆ† + å³è¾¹éƒ¨åˆ† + è·¨è¶Šå·¦å³ä¸¤è¾¹çš„ç­”æ¡ˆ</span></a></li></ul></li><li><a class="is-flex is-mobile" href="#2-éšæœºå¿«é€Ÿæ’åº"><span class="mr-2">2.2</span><span>2. éšæœºå¿«é€Ÿæ’åº</span></a><ul class="menu-list"><li><a class="is-flex is-mobile" href="#å¯ä»¥ç”¨-partition-æ¥å¯»æ‰¾-ç¬¬kå¤§-ç¬¬kå°-è·å…°å›½æ——é—®é¢˜"><span class="mr-2">2.2.1</span><span>å¯ä»¥ç”¨ partition æ¥å¯»æ‰¾ ç¬¬kå¤§ ç¬¬kå° (è·å…°å›½æ——é—®é¢˜)</span></a></li></ul></li><li><a class="is-flex is-mobile" href="#æ„å»ºå‰ç¼€ä¿¡æ¯ï¼ˆ46ï¼‰"><span class="mr-2">2.3</span><span>æ„å»ºå‰ç¼€ä¿¡æ¯ï¼ˆ46ï¼‰</span></a></li><li><a class="is-flex is-mobile" href="#å•è°ƒé˜Ÿåˆ—"><span class="mr-2">2.4</span><span>å•è°ƒé˜Ÿåˆ—</span></a><ul class="menu-list"><li><a class="is-flex is-mobile" href="#ä¼˜å…ˆé˜Ÿåˆ—æ‰©å±•"><span class="mr-2">2.4.1</span><span>ä¼˜å…ˆé˜Ÿåˆ—æ‰©å±•</span></a></li><li><a class="is-flex is-mobile" href="#åŒç«¯é˜Ÿåˆ—åƒè¯ä»»åŠ¡å®‰æ’"><span class="mr-2">2.4.2</span><span>åŒç«¯é˜Ÿåˆ—åƒè¯ä»»åŠ¡å®‰æ’</span></a></li></ul></li><li><a class="is-flex is-mobile" href="#å•è°ƒæ ˆ"><span class="mr-2">2.5</span><span>å•è°ƒæ ˆ</span></a><ul class="menu-list"><li><a class="is-flex is-mobile" href="#å®ç°æœ€å°å­—å…¸åºï¼ˆå•è°ƒæ ˆï¼‰"><span class="mr-2">2.5.1</span><span>å®ç°æœ€å°å­—å…¸åºï¼ˆå•è°ƒæ ˆï¼‰</span></a></li></ul></li><li><a class="is-flex is-mobile" href="#æ»‘åŠ¨çª—å£-åŒæŒ‡é’ˆï¼ˆè§†é¢‘ï¼‰"><span class="mr-2">2.6</span><span>æ»‘åŠ¨çª—å£ + åŒæŒ‡é’ˆï¼ˆè§†é¢‘ï¼‰</span></a></li></ul></li><li><a class="is-flex is-mobile" href="#"><span class="mr-2">3</span><span>æ•°æ®ç»“æ„</span></a><ul class="menu-list"><li><a class="is-flex is-mobile" href="#å‰ç¼€æ ‘ï¼ˆå­—å…¸æ ‘ï¼‰"><span class="mr-2">3.1</span><span>å‰ç¼€æ ‘ï¼ˆå­—å…¸æ ‘ï¼‰</span></a><ul class="menu-list"><li><a class="is-flex is-mobile" href="#ä»¥ä¸‹æ˜¯å…³äº-å­—å…¸æ ‘-äºŒè¿›åˆ¶è¿ç®—ï¼š"><span class="mr-2">3.1.1</span><span>ä»¥ä¸‹æ˜¯å…³äº å­—å…¸æ ‘ + äºŒè¿›åˆ¶è¿ç®—ï¼š</span></a></li></ul></li><li><a class="is-flex is-mobile" href="#å•è°ƒæ ˆ-å•è°ƒé˜Ÿåˆ—"><span class="mr-2">3.2</span><span>å•è°ƒæ ˆ + å•è°ƒé˜Ÿåˆ—</span></a></li><li><a class="is-flex is-mobile" href="#å¹¶æŸ¥é›†ï¼ˆæ¨¡ç‰ˆï¼‰"><span class="mr-2">3.3</span><span>å¹¶æŸ¥é›†ï¼ˆæ¨¡ç‰ˆï¼‰</span></a><ul class="menu-list"><li><a class="is-flex is-mobile" href="#åŸºæœ¬å»ºå›¾æ–¹æ³•"><span class="mr-2">3.3.1</span><span>åŸºæœ¬å»ºå›¾æ–¹æ³•</span></a></li></ul></li><li><a class="is-flex is-mobile" href="#æ‹“æ‰‘æ’åº"><span class="mr-2">3.4</span><span>æ‹“æ‰‘æ’åº</span></a><ul class="menu-list"><li><a class="is-flex is-mobile" href="#æ‹“æ‰‘æ’åºæ‰©å±•çŸ¥è¯†ï¼ˆç±»ä¼¼æ ‘å‹dpï¼‰"><span class="mr-2">3.4.1</span><span>æ‹“æ‰‘æ’åºæ‰©å±•çŸ¥è¯†ï¼ˆç±»ä¼¼æ ‘å‹dpï¼‰</span></a></li></ul></li><li><a class="is-flex is-mobile" href="#å€å¢ç®—æ³•-STè¡¨ï¼ˆç”¨äºåŒºé—´æŸ¥è¯¢æœ€å€¼ï¼Œgcdï¼‰-å…ˆçœ‹-åŸºç¡€dp"><span class="mr-2">3.5</span><span>å€å¢ç®—æ³• + STè¡¨ï¼ˆç”¨äºåŒºé—´æŸ¥è¯¢æœ€å€¼ï¼Œgcdï¼‰(å…ˆçœ‹ åŸºç¡€dp )</span></a></li><li><a class="is-flex is-mobile" href="#æ ‘ä¸Šé—®é¢˜"><span class="mr-2">3.6</span><span>æ ‘ä¸Šé—®é¢˜</span></a><ul class="menu-list"><li><a class="is-flex is-mobile" href="#æ ‘ä¸Šå€å¢-LCA"><span class="mr-2">3.6.1</span><span>æ ‘ä¸Šå€å¢ + LCA</span></a></li><li><a class="is-flex is-mobile" href="#æ ‘çš„é‡å¿ƒï¼ˆæœ‰ä¸€ä¸ªæˆ–è€…ä¸¤ä¸ªï¼‰"><span class="mr-2">3.6.2</span><span>æ ‘çš„é‡å¿ƒï¼ˆæœ‰ä¸€ä¸ªæˆ–è€…ä¸¤ä¸ªï¼‰</span></a></li><li><a class="is-flex is-mobile" href="#æ ‘çš„ç›´å¾„"><span class="mr-2">3.6.3</span><span>æ ‘çš„ç›´å¾„</span></a></li><li><a class="is-flex is-mobile" href="#æ ‘ä¸Šå·®åˆ†"><span class="mr-2">3.6.4</span><span>æ ‘ä¸Šå·®åˆ†</span></a></li></ul></li><li><a class="is-flex is-mobile" href="#æ ‘çŠ¶æ•°ç»„ï¼ˆè§†é¢‘ï¼‰"><span class="mr-2">3.7</span><span>æ ‘çŠ¶æ•°ç»„ï¼ˆè§†é¢‘ï¼‰</span></a><ul class="menu-list"><li><a class="is-flex is-mobile" href="#ç»´æŠ¤-ä¸¤ä¸ªå·®åˆ†æ•°ç»„-Di-ï¼ˆi-1-Di"><span class="mr-2">3.7.1</span><span>ç»´æŠ¤ ä¸¤ä¸ªå·®åˆ†æ•°ç»„ Di  +  ï¼ˆi - 1) * Di</span></a></li><li><a class="is-flex is-mobile" href="#é€†åºé˜Ÿé—®é¢˜"><span class="mr-2">3.7.2</span><span>é€†åºé˜Ÿé—®é¢˜</span></a></li></ul></li><li><a class="is-flex is-mobile" href="#çº¿æ®µæ ‘"><span class="mr-2">3.8</span><span>çº¿æ®µæ ‘</span></a></li></ul></li><li><a class="is-flex is-mobile" href="#"><span class="mr-2">4</span><span>åŠ¨æ€è§„åˆ’ï¼ˆå…ˆåšé¢˜ç›®ï¼‰</span></a><ul class="menu-list"><li><a class="is-flex is-mobile" href="#èƒŒåŒ…dp-ï¼ˆ66-75ï¼‰"><span class="mr-2">4.1</span><span>èƒŒåŒ…dp ï¼ˆ66 - 75ï¼‰</span></a></li><li><a class="is-flex is-mobile" href="#åŒºé—´dp"><span class="mr-2">4.2</span><span>åŒºé—´dp</span></a></li><li><a class="is-flex is-mobile" href="#çŠ¶æ€dp"><span class="mr-2">4.3</span><span>çŠ¶æ€dp</span></a></li><li><a class="is-flex is-mobile" href="#æ ‘å‹dp"><span class="mr-2">4.4</span><span>æ ‘å‹dp</span></a></li><li><a class="is-flex is-mobile" href="#æ•°ä½dp"><span class="mr-2">4.5</span><span>æ•°ä½dp</span></a></li><li><a class="is-flex is-mobile" href="#æ¢æ ¹dp"><span class="mr-2">4.6</span><span>æ¢æ ¹dp</span></a></li><li><a class="is-flex is-mobile" href="#è½®å»“çº¿dp"><span class="mr-2">4.7</span><span>è½®å»“çº¿dp</span></a></li><li><a class="is-flex is-mobile" href="#ä¸‰è¿›åˆ¶çŠ¶å‹dp"><span class="mr-2">4.8</span><span>ä¸‰è¿›åˆ¶çŠ¶å‹dp</span></a></li><li><a class="is-flex is-mobile" href="#dpä¼˜åŒ–"><span class="mr-2">4.9</span><span>dpä¼˜åŒ–</span></a></li></ul></li><li><a class="is-flex is-mobile" href="#"><span class="mr-2">5</span><span>å­—ç¬¦ä¸²</span></a><ul class="menu-list"><li><a class="is-flex is-mobile" href="#KMP"><span class="mr-2">5.1</span><span>KMP</span></a><ul class="menu-list"><li><a class="is-flex is-mobile" href="#æ‰©å±•-KMP-ï¼ˆZæ•°ç»„ï¼‰å‰ç¼€åŒ¹é…é—®é¢˜"><span class="mr-2">5.1.1</span><span>æ‰©å±• KMP ï¼ˆZæ•°ç»„ï¼‰å‰ç¼€åŒ¹é…é—®é¢˜</span></a></li></ul></li><li><a class="is-flex is-mobile" href="#Manacher"><span class="mr-2">5.2</span><span>Manacher</span></a></li><li><a class="is-flex is-mobile" href="#ACè‡ªåŠ¨æœº"><span class="mr-2">5.3</span><span>ACè‡ªåŠ¨æœº</span></a></li><li><a class="is-flex is-mobile" href="#å­—ç¬¦ä¸²å“ˆå¸Œ"><span class="mr-2">5.4</span><span>å­—ç¬¦ä¸²å“ˆå¸Œ</span></a></li></ul></li><li><a class="is-flex is-mobile" href="#"><span class="mr-2">6</span><span>æ•°å­¦</span></a><ul class="menu-list"><li><a class="is-flex is-mobile" href="#åŸƒå¼ç­›"><span class="mr-2">6.1</span><span>åŸƒå¼ç­›</span></a></li><li><a class="is-flex is-mobile" href="#ä¹˜æ³•é€†å…ƒ"><span class="mr-2">6.2</span><span>ä¹˜æ³•é€†å…ƒ</span></a></li><li><a class="is-flex is-mobile" href="#å®¹æ–¥åŸç†"><span class="mr-2">6.3</span><span>å®¹æ–¥åŸç†</span></a></li><li><a class="is-flex is-mobile" href="#å¿«é€Ÿå¹‚"><span class="mr-2">6.4</span><span>å¿«é€Ÿå¹‚</span></a><ul class="menu-list"><li><a class="is-flex is-mobile" href="#çŸ©é˜µå¿«é€Ÿå¹‚çš„åŸºæœ¬ä¼ªä»£ç "><span class="mr-2">6.4.1</span><span>çŸ©é˜µå¿«é€Ÿå¹‚çš„åŸºæœ¬ä¼ªä»£ç </span></a></li><li><a class="is-flex is-mobile" href="#çŸ©é˜µå¿«é€Ÿå¹‚çš„ä½¿ç”¨"><span class="mr-2">6.4.2</span><span>çŸ©é˜µå¿«é€Ÿå¹‚çš„ä½¿ç”¨</span></a></li></ul></li></ul></li></ul></div></div><style>.menu-list > li > a.is-active + .menu-list { display: block; }.menu-list > li > a + .menu-list { display: none; }</style><script src="/js/toc.js" defer></script></div><div class="card widget" data-type="profile"><div class="card-content"><nav class="level"><div class="level-item has-text-centered flex-shrink-1"><div><figure class="image is-128x128 mx-auto mb-2"><img class="avatar" src="/img/avatar.jpg" alt="Jiely"></figure><p class="title is-size-4 is-block" style="line-height:inherit;">Jiely</p><p class="is-size-6 is-block">ACMer and AI</p><p class="is-size-6 is-flex justify-content-center"><i class="fas fa-map-marker-alt mr-1"></i><span>China</span></p></div></div></nav><nav class="level is-mobile"><div class="level-item has-text-centered is-marginless"><div><p class="heading">æ–‡ç« </p><a href="/archives/"><p class="title">16</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">åˆ†ç±»</p><a href="/categories/"><p class="title">6</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">æ ‡ç­¾</p><a href="/tags/"><p class="title">11</p></a></div></div></nav><div class="level"><a class="level-item button is-primary is-rounded" href="https://github.com/pa-her0" target="_blank" rel="noopener">å…³æ³¨æˆ‘</a></div><div class="level is-mobile"><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Github" href="https://github.com/pa-her0"><i class="fab fa-github"></i></a></div><div><hr><p id="hitokoto">:D ä¸€è¨€å¥å­è·å–ä¸­...</p><script type="text/javascript" defer>function getYiyan(){
                                $.getJSON("https://v1.hitokoto.cn/", function (data) {
                                if(data){
                                    $('#hitokoto').html("");
                                    $('#hitokoto').append("<strong style='color: #3273dc;'>"+data.hitokoto+"</strong>"+
                                    "<p>"+"æ¥æºã€Š"+data.from+"ã€‹</p><p>æä¾›è€…-"+data.creator+"</p>");
                                }});}
                                $(function (){getYiyan();$('#hitokoto').click(function(){getYiyan();})});</script></div></div></div><div class="card widget"><div class="card-content"><h3 class="menu-label">æœ€æ–°æ–‡ç« </h3><article class="media"><figure class="media-left"><a class="image" href="/2025/06/19/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E7%AC%94%E8%AE%B0-%E7%8E%8B%E9%81%93%E8%80%83%E7%A0%94/"><img src="/img/linux.png" alt="æ“ä½œç³»ç»Ÿç¬”è®° --ç‹é“è€ƒç ”"></a></figure><div class="media-content"><p class="date"><time dateTime="2025-06-19T10:05:38.000Z">2025-06-19</time></p><p class="title"><a href="/2025/06/19/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E7%AC%94%E8%AE%B0-%E7%8E%8B%E9%81%93%E8%80%83%E7%A0%94/">æ“ä½œç³»ç»Ÿç¬”è®° --ç‹é“è€ƒç ”</a></p><p class="categories"><a href="/categories/%E6%97%A5%E5%B8%B8%E5%AD%A6%E4%B9%A0/">æ—¥å¸¸å­¦ä¹ </a></p></div></article><article class="media"><figure class="media-left"><a class="image" href="/2025/06/14/YOLO/"><img src="img/yolo.png" alt="åŸºäºYOLOçš„ç¥ç»ç½‘ç»œå‰ªæ"></a></figure><div class="media-content"><p class="date"><time dateTime="2025-06-14T03:36:33.000Z">2025-06-14</time></p><p class="title"><a href="/2025/06/14/YOLO/">åŸºäºYOLOçš„ç¥ç»ç½‘ç»œå‰ªæ</a></p><p class="categories"><a href="/categories/%E6%97%A5%E5%B8%B8%E5%AD%A6%E4%B9%A0/">æ—¥å¸¸å­¦ä¹ </a></p></div></article><article class="media"><figure class="media-left"><a class="image" href="/2025/06/10/Codeforces/"><img src="/img/cf.png" alt="Codeforces"></a></figure><div class="media-content"><p class="date"><time dateTime="2025-06-10T08:30:48.000Z">2025-06-10</time></p><p class="title"><a href="/2025/06/10/Codeforces/">Codeforces</a></p><p class="categories"><a href="/categories/Codeforces/">Codeforces</a></p></div></article><article class="media"><figure class="media-left"><a class="image" href="/2025/06/10/%E7%89%9B%E5%AE%A2%E8%B5%9B/"><img src="/img/newcode2.png" alt="ç‰›å®¢èµ›"></a></figure><div class="media-content"><p class="date"><time dateTime="2025-06-10T08:30:25.000Z">2025-06-10</time></p><p class="title"><a href="/2025/06/10/%E7%89%9B%E5%AE%A2%E8%B5%9B/">ç‰›å®¢èµ›</a></p><p class="categories"><a href="/categories/%E7%89%9B%E5%AE%A2/">ç‰›å®¢</a></p></div></article><article class="media"><figure class="media-left"><a class="image" href="/2025/05/21/Obisidian%20to%20Typora/"><img src="/img/obisidian.png" alt="Obisidian to Typora"></a></figure><div class="media-content"><p class="date"><time dateTime="2025-05-21T15:33:28.000Z">2025-05-21</time></p><p class="title"><a href="/2025/05/21/Obisidian%20to%20Typora/">Obisidian to Typora</a></p><p class="categories"><a href="/categories/%E7%94%9F%E6%B4%BB/">ç”Ÿæ´»</a></p></div></article></div></div><div class="column-right-shadow is-hidden-widescreen"></div></div></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><a class="footer-logo is-block mb-2" href="/"><img src="/img/Y1.png" alt="ğŸ¦–" height="28"></a><p class="size-small"><span>&copy; 2025 Jiely</span>Â Â Powered by <a href="https://hexo.io/" target="_blank">Hexo</a> &amp; <a href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank">Icarus</a> &amp; <a href="https://github.com/removeif/hexo-theme-amazing" target="_blank">Amazing</a>Â <br><span><span id="statistic-times">loading...</span><script>function createTime(time) {
            var n = new Date(time);
            now.setTime(now.getTime() + 250),
                days = (now - n) / 1e3 / 60 / 60 / 24,
                dnum = Math.floor(days),
                hours = (now - n) / 1e3 / 60 / 60 - 24 * dnum,
                hnum = Math.floor(hours),
            1 == String(hnum).length && (hnum = "0" + hnum),
                minutes = (now - n) / 1e3 / 60 - 1440 * dnum - 60 * hnum,
                mnum = Math.floor(minutes),
            1 == String(mnum).length && (mnum = "0" + mnum),
                seconds = (now - n) / 1e3 - 86400 * dnum - 3600 * hnum - 60 * mnum,
                snum = Math.round(seconds),
            1 == String(snum).length && (snum = "0" + snum),
                document.getElementById("statistic-times").innerHTML = "â¤ï¸æœ¬ç«™è‡ª <strong>"+time.split(" ")[0].replace(/\//g,".")+"</strong> å·²è¿è¡Œ <strong>" + dnum + "</strong> å¤© <strong>" + hnum + "</strong> å°æ—¶ <strong>" + mnum + "</strong> åˆ† <strong>" + snum + "</strong> ç§’ï¼â¤ï¸";
        }var now = new Date();setInterval("createTime('2025/4/14 16:35:00')", 250,"");</script><br></span><div class="size-small"><span>â¤ï¸æ„Ÿè°¢ <strong><span id="busuanzi_value_site_uv">99+</span></strong> å°ä¼™ä¼´çš„ <strong><span id="busuanzi_value_site_pv">99+</span></strong> æ¬¡å…‰ä¸´ï¼â¤ï¸</span></div></p></div><div class="level-end"><div class="field has-addons"><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/pa-her0"><i class="fab fa-github"></i></a></p></div><div class="sideMusic"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.css"><script src="/js/APlayer.min.js"></script><script src="https://cdn.jsdelivr.net/npm/meting@2/dist/Meting.min.js"></script><meting-js style="width: auto;height: 2000px;" server="netease" type="playlist" id="13584583094" theme="#2980b9" loop="all" autoplay="false" order="list" storageName="aplayer-setting" lrctype="0" list-max-height="400px" fixed="true"></meting-js></div></div></div></div></footer><script src="https://cdnjs.loli.net/ajax/libs/moment.js/2.22.2/moment-with-locales.min.js"></script><script src="https://cdnjs.loli.net/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" async></script><script>moment.locale("zh-cn");</script><script>var IcarusThemeSettings = {
            article: {
                highlight: {
                    clipboard: true,
                    fold: 'unfolded'
                }
            }
        };</script><script src="/js/column.js"></script><script src="/js/animation.js"></script><a id="back-to-top" title="å›åˆ°é¡¶ç«¯" href="javascript:;"><i class="fas fa-chevron-up"></i></a><script src="/js/back_to_top.js" defer></script><!--!--><!--!--><!--!--><script src="https://cdnjs.loli.net/ajax/libs/lightgallery/1.10.0/js/lightgallery.min.js" defer></script><script src="https://cdnjs.loli.net/ajax/libs/justifiedGallery/3.8.1/js/jquery.justifiedGallery.min.js" defer></script><script>window.addEventListener("load", () => {
            if (typeof $.fn.lightGallery === 'function') {
                $('.article').lightGallery({ selector: '.gallery-item' });
            }
            if (typeof $.fn.justifiedGallery === 'function') {
                if ($('.justified-gallery > p > .gallery-item').length) {
                    $('.justified-gallery > p > .gallery-item').unwrap();
                }
                $('.justified-gallery').justifiedGallery();
            }
        });</script><!--!--><!--!--><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/KaTeX/0.15.1/katex.min.css"><script src="https://cdnjs.loli.net/ajax/libs/KaTeX/0.15.1/katex.min.js" defer></script><script src="https://cdnjs.loli.net/ajax/libs/KaTeX/0.15.1/contrib/auto-render.min.js" defer></script><script src="https://cdnjs.loli.net/ajax/libs/KaTeX/0.15.1/contrib/mhchem.min.js" defer></script><script>window.addEventListener("load", function() {
            document.querySelectorAll('[role="article"] > .content').forEach(function(element) {
                renderMathInElement(element);
            });
        });</script><script type="text/javascript" id="MathJax-script" async>MathJax = {
      tex: {
        inlineMath: [['$', '$'], ['\\(', '\\)']]
      },
      svg: {
        fontCache: 'global'
      },
      chtml: {
        matchFontHeight: false
      }
    };</script><script src="https://cdnjs.loli.net/ajax/libs/mathjax/3.2.2/es5/tex-mml-chtml.js"></script><!--!--><script src="/js/main.js" defer></script><div class="searchbox"><div class="searchbox-container"><div class="searchbox-header"><div class="searchbox-input-container"><input class="searchbox-input" type="text" placeholder="æƒ³è¦æŸ¥æ‰¾ä»€ä¹ˆ..."></div><a class="searchbox-close" href="javascript:;">Ã—</a></div><div class="searchbox-body"></div></div></div><script data-pjax src="/js/insight.js" defer></script><script data-pjax>document.addEventListener('DOMContentLoaded', function () {
            loadInsight({"contentUrl":"/content.json"}, {"hint":"æƒ³è¦æŸ¥æ‰¾ä»€ä¹ˆ...","untitled":"(æ— æ ‡é¢˜)","posts":"æ–‡ç« ","pages":"é¡µé¢","categories":"åˆ†ç±»","tags":"æ ‡ç­¾"});
        });</script><script src="https://cdn.jsdelivr.net/npm/pjax@0.2.8/pjax.js"></script><script type="text/javascript">var pjax = new Pjax({
            elements: "a",//ä»£è¡¨ç‚¹å‡»é“¾æ¥å°±æ›´æ–°
            selectors: [  //ä»£è¡¨è¦æ›´æ–°çš„èŠ‚ç‚¹
                ".section",
                "title"
            ],
            cache: true,
            cacheBust:false
        })

        function loadBusuanzi(){
        $.getScript("//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js", function () {});
        }

        function loadMathJax() { //åŠ è½½mathjax
            $.getScript("//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.4/MathJax.js?config=TeX-MML-AM_CHTML", function () {
                MathJax.Hub.Config({ tex2jax: { inlineMath: [['$', '$'], ['\(', '\)']] } });
                var math = document.getElementsByClassName("entry-content")[0];
                MathJax.Hub.Queue(["Typeset", MathJax.Hub, math]);
            });
        };

        // å¼€å§‹ PJAX æ‰§è¡Œçš„å‡½æ•°
        document.addEventListener('pjax:send', function () {
        });
        
        // PJAX å®Œæˆä¹‹åæ‰§è¡Œçš„å‡½æ•°ï¼Œå¯ä»¥å’Œä¸Šé¢çš„é‡è½½æ”¾åœ¨ä¸€èµ·
        document.addEventListener('pjax:complete', function () {
            $(".section").css({opacity:1});
            if(false){
                $.getScript('/js/comment-issue-data.js',function(){loadIssueData('undefined','undefined','undefined','undefined',undefined);});
            }
            if(false){
                loadMathJax();
            }
            loadMainJs(jQuery, window.moment, window.ClipboardJS, window.IcarusThemeSettings);
            loadBackTop();
            loadBusuanzi();
            if(typeof loadBanner == 'function'){
                loadBanner();
            }
        });</script></body></html>