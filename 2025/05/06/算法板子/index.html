<!doctype html>
<html lang="zh"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta><title>ç®—æ³•çŸ¥è¯†å†Œ - éœ¸ç‹é¾™çš„å°çªğŸ¦–</title><link rel="manifest" href="/manifest.json"><meta name="application-name" content="éœ¸ç‹é¾™çš„å°çªğŸ¦–"><meta name="msapplication-TileImage" content="/img/Whale.png"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-title" content="éœ¸ç‹é¾™çš„å°çªğŸ¦–"><meta name="apple-mobile-web-app-status-bar-style" content="default"><meta name="description" content="[!NOTE] æœ¬æ–‡ç« æ˜¯ åŸºäº å·¦ç¥è¯¾ç¨‹ + ç‰›å®¢è¯¾ç¨‹ è¿›è¡Œç®—æ³•ç³»ç»Ÿå¼å­¦ä¹ çš„çŸ¥è¯†æ±‡æ€»ã€‚"><meta property="og:type" content="article"><meta property="og:title" content="ç®—æ³•çŸ¥è¯†å†Œ"><meta property="og:url" content="http://whalefall.fun/2025/05/06/%E7%AE%97%E6%B3%95%E6%9D%BF%E5%AD%90/"><meta property="og:site_name" content="éœ¸ç‹é¾™çš„å°çªğŸ¦–"><meta property="og:description" content="[!NOTE] æœ¬æ–‡ç« æ˜¯ åŸºäº å·¦ç¥è¯¾ç¨‹ + ç‰›å®¢è¯¾ç¨‹ è¿›è¡Œç®—æ³•ç³»ç»Ÿå¼å­¦ä¹ çš„çŸ¥è¯†æ±‡æ€»ã€‚"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="http://whalefall.fun/img/ACM.png"><meta property="article:published_time" content="2025-05-06T08:48:00.000Z"><meta property="article:modified_time" content="2025-09-21T01:21:40.509Z"><meta property="article:author" content="Jiely"><meta property="article:tag" content="æ²‰æ·€"><meta property="twitter:card" content="summary"><meta property="twitter:image:src" content="http://whalefall.fun/img/ACM.png"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"http://whalefall.fun/2025/05/06/%E7%AE%97%E6%B3%95%E6%9D%BF%E5%AD%90/"},"headline":"ç®—æ³•çŸ¥è¯†å†Œ","image":["http://whalefall.fun/img/ACM.png"],"datePublished":"2025-05-06T08:48:00.000Z","dateModified":"2025-09-21T01:21:40.509Z","author":{"@type":"Person","name":"Jiely"},"publisher":{"@type":"Organization","name":"éœ¸ç‹é¾™çš„å°çªğŸ¦–","logo":{"@type":"ImageObject","url":{"light":"/img/JIELY.png","dark":"/img/JIELY.png"}}},"description":"[!NOTE] æœ¬æ–‡ç« æ˜¯ åŸºäº å·¦ç¥è¯¾ç¨‹ + ç‰›å®¢è¯¾ç¨‹ è¿›è¡Œç®—æ³•ç³»ç»Ÿå¼å­¦ä¹ çš„çŸ¥è¯†æ±‡æ€»ã€‚"}</script><link rel="canonical" href="http://whalefall.fun/2025/05/06/%E7%AE%97%E6%B3%95%E6%9D%BF%E5%AD%90/"><link rel="alternate" href="/atom.xml" title="éœ¸ç‹é¾™çš„å°çªğŸ¦–" type="application/atom+xml"><link rel="icon" href="/img/Whale.png"><link rel="stylesheet" href="/css/font/fontawesome/css/all.min.css"><link data-pjax rel="stylesheet" href="/js/imaegoo/highlight.js/11.7.0/styles/tokyo-night-dark.css"><link data-pjax rel="stylesheet" href="/css/default.css"><style>
                /* ä¸»è¦å®¹å™¨åœ†è§’ */
                .card, .box, .notification {
                    border-radius: 12px;
                }
                
                /* æ–‡ç« å¡ç‰‡ */
                .card-content, .media, .timeline-item {
                    border-radius: 8px;
                }
                
                /* å¯¼èˆªæ  */
                .navbar {
                    border-radius: 0 0 12px 12px;
                }
                
                /* ä¾§è¾¹æ ç»„ä»¶ */
                .widget, .menu-list a {
                    border-radius: 8px;
                }
                
                /* æŒ‰é’® */
                .button {
                    border-radius: 6px;
                }
                
                /* è¾“å…¥æ¡† */
                .input, .textarea, .select select {
                    border-radius: 6px;
                }
                
                /* ä»£ç å— */
                pre, code {
                    border-radius: 6px;
                }
                
                /* å¼•ç”¨å— */
                blockquote {
                    border-radius: 0 8px 8px 0;
                }
                
                /* å›¾ç‰‡ */
                img {
                    border-radius: 8px;
                }
                
                /* æ ‡ç­¾ */
                .tag {
                    border-radius: 12px;
                }
                
                /* åˆ†é¡µå™¨ */
                .pagination-link, .pagination-previous, .pagination-next {
                    border-radius: 6px;
                }
                
                /* è¯„è®ºåŒºåŸŸ */
                .comments {
                    border-radius: 12px;
                }
                
                /* ç›®å½• */
                .toc {
                    border-radius: 8px;
                }
                
                /* Macé£æ ¼çš„è½»å¾®é˜´å½±æ•ˆæœ */
                .card {
                    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
                    transition: box-shadow 0.3s ease;
                }
                
                .card:hover {
                    box-shadow: 0 4px 16px rgba(0, 0, 0, 0.15);
                }
            </style><!--!--><!--!--><script src="https://vercount.one/js" defer></script><link rel="stylesheet" href="/js/imaegoo/lightgallery/1.10.0/dist/css/lightgallery.min.css"><link rel="stylesheet" href="/js/imaegoo/justifiedGallery/3.8.1/dist/css/justifiedGallery.min.css"><script src="https://www.googletagmanager.com/gtag/js?id=G-RCCCLYKRH5" async></script><script>window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
    
        gtag('config', 'G-RCCCLYKRH5');</script><!--!--><link rel="stylesheet" href="/js/imaegoo/cookieconsent/3.1.1/build/cookieconsent.min.css"><!-- hexo injector head_end start --><script>
  (function () {
      function switchTab() {
          if (!location.hash) {
            return;
          }

          const id = '#' + CSS.escape(location.hash.substring(1));
          const $tabMenu = document.querySelector(`.tabs a[href="${id}"]`);
          if (!$tabMenu) {
            return;
          }

          const $tabMenuContainer = $tabMenu.parentElement.parentElement;
          Array.from($tabMenuContainer.children).forEach($menu => $menu.classList.remove('is-active'));
          Array.from($tabMenuContainer.querySelectorAll('a'))
              .map($menu => document.getElementById($menu.getAttribute("href").substring(1)))
              .forEach($content => $content.classList.add('is-hidden'));

          if ($tabMenu) {
              $tabMenu.parentElement.classList.add('is-active');
          }
          const $activeTab = document.querySelector(id);
          if ($activeTab) {
              $activeTab.classList.remove('is-hidden');
          }
      }
      switchTab();
      window.addEventListener('hashchange', switchTab, false);
  })();
  </script><!-- hexo injector head_end end --><meta name="generator" content="Hexo 7.3.0"><style>mjx-container[jax="SVG"] {
  direction: ltr;
}

mjx-container[jax="SVG"] > svg {
  overflow: visible;
}

mjx-container[jax="SVG"][display="true"] {
  display: block;
  text-align: center;
  margin: 1em 0;
}

mjx-container[jax="SVG"][justify="left"] {
  text-align: left;
}

mjx-container[jax="SVG"][justify="right"] {
  text-align: right;
}

g[data-mml-node="merror"] > g {
  fill: red;
  stroke: red;
}

g[data-mml-node="merror"] > rect[data-background] {
  fill: yellow;
  stroke: none;
}

g[data-mml-node="mtable"] > line[data-line] {
  stroke-width: 70px;
  fill: none;
}

g[data-mml-node="mtable"] > rect[data-frame] {
  stroke-width: 70px;
  fill: none;
}

g[data-mml-node="mtable"] > .mjx-dashed {
  stroke-dasharray: 140;
}

g[data-mml-node="mtable"] > .mjx-dotted {
  stroke-linecap: round;
  stroke-dasharray: 0,140;
}

g[data-mml-node="mtable"] > svg {
  overflow: visible;
}

[jax="SVG"] mjx-tool {
  display: inline-block;
  position: relative;
  width: 0;
  height: 0;
}

[jax="SVG"] mjx-tool > mjx-tip {
  position: absolute;
  top: 0;
  left: 0;
}

mjx-tool > mjx-tip {
  display: inline-block;
  padding: .2em;
  border: 1px solid #888;
  font-size: 70%;
  background-color: #F8F8F8;
  color: black;
  box-shadow: 2px 2px 5px #AAAAAA;
}

g[data-mml-node="maction"][data-toggle] {
  cursor: pointer;
}

mjx-status {
  display: block;
  position: fixed;
  left: 1em;
  bottom: 1em;
  min-width: 25%;
  padding: .2em .4em;
  border: 1px solid #888;
  font-size: 90%;
  background-color: #F8F8F8;
  color: black;
}

foreignObject[data-mjx-xml] {
  font-family: initial;
  line-height: normal;
  overflow: visible;
}

.MathJax path {
  stroke-width: 3;
}

mjx-container[display="true"] {
  overflow: auto hidden;
}

mjx-container[display="true"] + br {
  display: none;
}
</style></head><head><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css"></head><body class="is-2-column"><script type="text/javascript" src="/js/imaegoo/night.js"></script><canvas id="universe"></canvas><style>
                    @media screen and (min-width: 1024px) {
                        .container {
                            max-width: 900px !important;
                        }
                    }
                    @media screen and (min-width: 1216px) {
                        .container {
                            max-width: 1000px !important;
                        }
                    }
                    @media screen and (min-width: 1408px) {
                        .container {
                            max-width: 1100px !important;
                        }
                    }
                </style><nav class="navbar navbar-main"><div class="container navbar-container" style="paddingLeft:0.25rem;paddingRight:0.5rem;"><div class="navbar-brand" style="marginLeft:-2rem;"><a class="navbar-item navbar-logo" href="/"><img class="logo-img" src="/img/JIELY.png" alt="éœ¸ç‹é¾™çš„å°çªğŸ¦–" height="28"><img class="logo-img-dark" src="/img/JIELY.png" alt="éœ¸ç‹é¾™çš„å°çªğŸ¦–" height="28"></a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item" href="/">é¦–é¡µ</a><a class="navbar-item" href="/archives/">æ—¶é—´è½´</a><a class="navbar-item" href="/categories/">åˆ†ç±»</a><a class="navbar-item" href="/tags/">æ ‡ç­¾</a><a class="navbar-item" href="/about/">å…³äº</a></div><div class="navbar-end"><a class="navbar-item is-hidden-tablet catalogue" title="ç›®å½•" href="javascript:;"><i class="fas fa-list-ul"></i><span>Â Â ç›®å½•</span></a><a class="navbar-item night" id="night-nav" title="Night Mode" href="javascript:;"><i class="fas fa-moon" id="night-icon"></i></a><a class="navbar-item search" title="æœç´¢" href="javascript:;"><i class="fas fa-search"></i></a></div></div></div></nav><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-8-tablet is-8-desktop is-10-widescreen"><div class="card"><div class="card-image"><span class="image is-7by3"><img class="fill" style="objectFit:contain;" src="/img/ACM.png" alt="ç®—æ³•çŸ¥è¯†å†Œ" referrerpolicy="no-referrer"></span></div><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><i class="fas fa-thumbtack level-item" title="Pinned"></i><span class="level-item"><time dateTime="2025-05-06T08:48:00.000Z" title="5/6/2025, 4:48:00 PM">2025-05-06</time>å‘è¡¨</span><span class="level-item"><time dateTime="2025-09-21T01:21:40.509Z" title="9/21/2025, 9:21:40 AM">2025-09-21</time>æ›´æ–°</span><span class="level-item"><a class="link-muted" href="/categoriehexo-theme-claudias/%E7%AE%97%E6%B3%95/">ç®—æ³•</a></span><span class="level-item">1 å°æ—¶è¯»å®Œ (å¤§çº¦7662ä¸ªå­—)</span><span class="level-item leancloud_visitors" id="/2025/05/06/%E7%AE%97%E6%B3%95%E6%9D%BF%E5%AD%90/" data-flag-title="ç®—æ³•çŸ¥è¯†å†Œ"><i class="far fa-eye"></i>&nbsp;&nbsp;<span id="twikoo_visitors"><i class="fa fa-spinner fa-spin"></i></span>æ¬¡è®¿é—®</span></div></div><h1 class="title is-3 is-size-4-mobile">ç®—æ³•çŸ¥è¯†å†Œ</h1><div class="content"><blockquote>
<p>[!NOTE]<br>
æœ¬æ–‡ç« æ˜¯ åŸºäº å·¦ç¥è¯¾ç¨‹ + ç‰›å®¢è¯¾ç¨‹ è¿›è¡Œç®—æ³•ç³»ç»Ÿå¼å­¦ä¹ çš„çŸ¥è¯†æ±‡æ€»ã€‚</p>
</blockquote>
<span id="more"></span>
<h2 id="ç›¸å…³å­¦ä¹ æ–¹å‘æ€è€ƒ"><a class="markdownIt-Anchor" href="#ç›¸å…³å­¦ä¹ æ–¹å‘æ€è€ƒ"></a> ç›¸å…³å­¦ä¹ æ–¹å‘æ€è€ƒ</h2>
<h3 id="2025818"><a class="markdownIt-Anchor" href="#2025818"></a> 2025.8.18</h3>
<ol>
<li>é’ˆå¯¹äºå­¦ä¹ çš„è·¯å¾„,ç”±äºå‰é¢å­¦ä¹ çš„å¾ˆå¤šçŸ¥è¯†å¹¶æ²¡æœ‰æ‰“ä¸‹åšå®çš„åŸºç¡€,ç„¶åé‚£æ—¶å€™åˆ·é¢˜ä¹Ÿæ²¡æœ‰è·Ÿä¸Š,æ‰€ä»¥ç°åœ¨é’ˆå¯¹äºç›¸å…³å­¦ä¹ ,æ˜¯çœ‹ä¸€èŠ‚å·¦ç¥çš„è¯¾+è‡ªå·±è¡¥å‰é¢çš„ä¸€ä¸ªçŸ¥è¯†ç‚¹,æˆ‘æ„Ÿè§‰å¯ä»¥å…ˆè¡¥å‰é¢çš„çŸ¥è¯†ç‚¹,ç„¶åå†çœ‹ä¸€èŠ‚åé¢ç›¸å…³çš„è¯¾</li>
</ol>
<h3 id="2025821"><a class="markdownIt-Anchor" href="#2025821"></a> 2025.8.21</h3>
<ol>
<li>å¦‚æœé‡åˆ°ä¸€äº›é¢˜ç›®è¶…æ—¶äº†,æœ‰ä¸¤ä¸ªåŸå› ,ç¬¬ä¸€ç§å°±æ˜¯ä½ è¿™ç§æ–¹æ³•æœ¬æ¥å°±æ˜¯ä¸å¯è¡Œ,ç¬¬äºŒç§å°±æ˜¯ä½ è¢«å¡å¸¸äº†,å°±æ˜¯æœ‰ä¸€ä¸ªç‰¹åˆ¤æ²¡æœ‰è®¾ç½®,ä½ å¯ä»¥å»å°è¯•å»ç”¨ä¸€ä¸ªå›ºå®šçš„å¸¸æ•°å»å¡ä½ä»–çš„è¶…æ—¶çº¿ğŸ˜„(äº²è¯•æœ‰æ•ˆ)</li>
</ol>
<h3 id="2025827"><a class="markdownIt-Anchor" href="#2025827"></a> 2025.8.27</h3>
<ol>
<li>æœ‰ä¸€äº›é—®é¢˜,å¦‚æœæœ‰æ˜ç¡®çš„æ€è·¯å»è§£å†³,ä½†æ˜¯ä»æ­£é¢å»è§£å†³çš„è¯æ„Ÿè§‰éš¾ä»¥å®ç°çš„è¯,å¯ä»¥å°è¯•åç€å»æ€è€ƒè¿™ä¸ªé—®é¢˜,æ¯”å¦‚,å¦‚æœè®©ä½ å»è§£å†³ä¸é€’å‡åºåˆ—çš„ç›¸å…³é—®é¢˜,è¯•ç€çœ‹å¯ä¸å¯ä»¥è½¬åŒ–ä¸ºä¸é€’å¢åºåˆ—å»è§£å†³ğŸ˜„</li>
</ol>
<h2 id="åŸºç¡€ç®—æ³•"><a class="markdownIt-Anchor" href="#åŸºç¡€ç®—æ³•"></a> åŸºç¡€ç®—æ³•</h2>
<h3 id="å•è°ƒé˜Ÿåˆ—"><a class="markdownIt-Anchor" href="#å•è°ƒé˜Ÿåˆ—"></a> å•è°ƒé˜Ÿåˆ—</h3>
<blockquote>
<p>[!NOTE]<br>
è¿™æ˜¯ä¸€æ¬¡å°è¯•</p>
</blockquote>
<h3 id="å•è°ƒæ ˆ"><a class="markdownIt-Anchor" href="#å•è°ƒæ ˆ"></a> å•è°ƒæ ˆ</h3>
<h3 id="é€†åºå¯¹"><a class="markdownIt-Anchor" href="#é€†åºå¯¹"></a> é€†åºå¯¹</h3>
<ol>
<li>æ ‘çŠ¶æ•°ç»„</li>
</ol>
<blockquote>
<p>ä½¿ç”¨æ ‘çŠ¶æ•°ç»„æ¥æ±‚é€†åºé˜Ÿï¼Œä¸»è¦è¦è¿›è¡Œç¦»æ•£åŒ–ï¼Œåº”ä¸ºå¯ä»¥ a[i] çš„å€¼å¾ˆå¤§ï¼Œä½†æ˜¯ æ•°ç»„å¤§å°æœ‰é™ï¼Œä¸ç¦»æ•£åŒ–çš„è¯ï¼Œå¯èƒ½æ ‘çŠ¶æ•°ç»„çš„ treeæ•°ç»„å­˜ä¸ä¸‹ã€‚</p>
</blockquote>
<p>æ€è·¯ï¼š<br>
ä»æ•°ç»„çš„å³è¾¹å¼€å§‹ä¾¿åˆ©ï¼Œè®¿é—®åˆ°å½“å‰å…ƒç´ çš„æ—¶å€™ï¼Œæ£€æŸ¥æ ‘çŠ¶æ•°ç»„ä¸­æ±‚å’Œï¼ˆæ¯”å½“å‰å…ƒç´ å°çš„å…ƒç´ ï¼‰ï¼Œå› ä¸ºæ˜¯ä»å³å¾€å·¦ä¾¿åˆ©ï¼Œå¦‚æœæœ‰æ¯”å½“å‰å…ƒç´ å°çš„ï¼Œè‚¯å®šåœ¨æ•°ç»„ä¸­æ˜¯åœ¨å½“å‰å…ƒç´ çš„å³è¾¹ã€‚</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line">#<span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">1e5</span> + <span class="number">10</span>;</span><br><span class="line"><span class="type">int</span> n;</span><br><span class="line"><span class="type">int</span> tree[N];</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">lowbit</span><span class="params">(<span class="type">int</span> i)</span></span>{</span><br><span class="line">    <span class="keyword">return</span> i &amp; -i;</span><br><span class="line">}</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">add</span><span class="params">(<span class="type">int</span> i, <span class="type">int</span> w)</span></span>{</span><br><span class="line">    <span class="keyword">while</span>(i &lt;= n){</span><br><span class="line">        tree[i] += w;</span><br><span class="line">        i += <span class="built_in">lowbit</span>(i);</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"><span class="comment">// 1 - r</span></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">sum</span><span class="params">(<span class="type">int</span> r)</span></span>{</span><br><span class="line">    <span class="type">int</span> ans = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(r &gt; <span class="number">0</span>){</span><br><span class="line">        ans += tree[r];</span><br><span class="line">        r-= <span class="built_in">lowbit</span>(r);</span><br><span class="line">    }</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span></span>{</span><br><span class="line">    cin &gt;&gt; n;</span><br><span class="line">    <span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">a</span><span class="params">(n)</span></span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; i++)    cin &gt;&gt; a[i];</span><br><span class="line">    <span class="comment">// ç¦»æ•£åŒ–</span></span><br><span class="line">    <span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">b</span><span class="params">(n)</span></span>;</span><br><span class="line">    b = a</span><br><span class="line">    <span class="built_in">sort</span>(b.<span class="built_in">begin</span>(), b.<span class="built_in">end</span>());</span><br><span class="line">    map&lt;<span class="type">int</span>, <span class="type">int</span>&gt; mp;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; i++) mp[b[i]] = i + <span class="number">1</span>;</span><br><span class="line">    <span class="comment">// æ±‚é€†åºé˜Ÿ</span></span><br><span class="line">    <span class="type">int</span> ans = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = n - <span class="number">1</span>; i &gt;= <span class="number">0</span>; i--){</span><br><span class="line">        <span class="type">int</span> r = <span class="built_in">sum</span>(mp[a[i]] - <span class="number">1</span>);</span><br><span class="line">        ans += r;</span><br><span class="line">        <span class="built_in">add</span>(mp[a[i]], <span class="number">1</span>);</span><br><span class="line">    }</span><br><span class="line">    cout &lt;&lt; ans &lt;&lt; endl;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">}</span><br></pre></td></tr></table></figure>
<h3 id="å½’å¹¶åˆ†æ²»"><a class="markdownIt-Anchor" href="#å½’å¹¶åˆ†æ²»"></a> å½’å¹¶åˆ†æ²»</h3>
<blockquote>
<p>åˆ†æ²»çš„å«ä¹‰æ˜¯ æ•´ä½“çš„ç­”æ¡ˆ <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo stretchy="false">?</mo><mo>=</mo></mrow><annotation encoding="application/x-tex">?=</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mclose">?</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span></span></span></span> å·¦è¾¹çš„ç­”æ¡ˆ + å³è¾¹çš„ç­”æ¡ˆ</p>
</blockquote>
<ol>
<li>å½’å¹¶æ’åº</li>
</ol>
<blockquote>
<p>å½’å¹¶æ’åºæ˜¯ä¸€ä¸ªç¨³å®šçš„æ’åº</p>
</blockquote>
<ul>
<li>æ•´ä½“çš„æœ‰åº æ˜¯ <strong>å·¦è¾¹æœ‰åº + å³è¾¹æœ‰åº + åˆå¹¶è¿‡ç¨‹</strong></li>
</ul>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">merge</span><span class="params">(<span class="type">int</span> l, <span class="type">int</span> r)</span></span>{</span><br><span class="line">    <span class="type">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">    <span class="type">int</span> i = l, j = mid + <span class="number">1</span>, t1 = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(i &lt;= mid &amp;&amp; j &lt;= r){</span><br><span class="line">        help[t1++] = (a[i] &lt;= a[j]) ? a[i++] :a[j++];</span><br><span class="line">    }</span><br><span class="line">    <span class="keyword">while</span>(i &lt;= mid) help[t1++] = a[i++];</span><br><span class="line">    <span class="keyword">while</span>(j &lt;= r) help[t1++] = a[j++];</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = r; i &gt;= l; i--){</span><br><span class="line">        a[i] = help[--t1];</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">guibin</span><span class="params">(<span class="type">int</span> l, <span class="type">int</span> r)</span></span>{</span><br><span class="line">    <span class="keyword">if</span>(l &gt;= r) <span class="keyword">return</span>;</span><br><span class="line">    <span class="type">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">    <span class="built_in">guibin</span>(l, mid);</span><br><span class="line">    <span class="built_in">guibin</span>(mid + <span class="number">1</span>, r);</span><br><span class="line">    <span class="built_in">merge</span>(l, r);</span><br><span class="line">}</span><br></pre></td></tr></table></figure>
<p>åˆ†æ²»é¢˜ç›®ï¼š<br>
<a target="_blank" rel="noopener" href="https://leetcode.com/problem-list/divide-and-conquer/">leetcode-åˆ†æ²»</a></p>
<h3 id="éšæœºå¿«æ’"><a class="markdownIt-Anchor" href="#éšæœºå¿«æ’"></a> éšæœºå¿«æ’</h3>
<p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow></mrow><annotation encoding="application/x-tex">
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"></span></span></span></p>
<h3 id="ç¦»æ•£åŒ–"><a class="markdownIt-Anchor" href="#ç¦»æ•£åŒ–"></a> ç¦»æ•£åŒ–</h3>
<blockquote>
<p>å¦‚æœæ•°æ®è§„æ¨¡å¤§ï¼Œä½†æ˜¯æ•°æ®é‡å°çš„è¯ï¼Œæˆ‘ä»¬å¯ä»¥è¿›è¡Œç¦»æ•£åŒ–å¤„ç†ã€‚</p>
</blockquote>
<ul>
<li>ç»™æ¯ä¸€ä¸ªå€¼ä¸€ä¸ªç¼–å·</li>
<li>æ³•ä¸€</li>
</ul>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">b</span><span class="params">(n)</span></span>;</span><br><span class="line">b = a;</span><br><span class="line"><span class="built_in">sort</span>(b.<span class="built_in">begin</span>(), b.<span class="built_in">end</span>());</span><br><span class="line">b.<span class="built_in">erase</span>(<span class="built_in">unique</span>(b.<span class="built_in">begin</span>(), b.<span class="built_in">end</span>()), b.<span class="built_in">end</span>());</span><br><span class="line">map&lt;<span class="type">int</span>, <span class="type">int</span>&gt; mp;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; b.<span class="built_in">size</span>(); i++){mp[b[i]] = i;}</span><br></pre></td></tr></table></figure>
<h3 id="ç±»å¹¶æŸ¥é›†"><a class="markdownIt-Anchor" href="#ç±»å¹¶æŸ¥é›†"></a> ç±»å¹¶æŸ¥é›†</h3>
<blockquote>
<p>å¦‚æœæ˜¯åˆ†è”é€šå—è¿›è¡Œè®¡ç®—ï¼Œæˆ‘ä»¬å¯ä»¥ä¸ä½¿ç”¨å¹¶æŸ¥é›†ï¼Œä½¿ç”¨ä¸€ä¸ªç®€å•çš„æ€è·¯ï¼Œç»™æ¯ä¸€ä¸ªè”é€šå—<strong>ç¼–å·</strong>ï¼Œä»è€Œæ¥è€ƒè™‘æ¯ä¸€ä¸ªè”é€šå—ä¹‹é—´çš„å…³ç³»ã€‚</p>
</blockquote>
<ul>
<li>
<p><a target="_blank" rel="noopener" href="https://codeforces.com/problemset/problem/2060/E">E. Graph Composition(div3)</a></p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line">#<span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line">#<span class="meta">#<span class="keyword">define</span> int long long</span></span><br><span class="line"></span><br><span class="line"><span class="type">void</span> __(){</span><br><span class="line">    <span class="type">int</span> n, m1, m2;</span><br><span class="line">    cin &gt;&gt; n &gt;&gt; m1 &gt;&gt; m2;</span><br><span class="line">    vector&lt;vector&lt;<span class="type">int</span>&gt;&gt; <span class="built_in">a1</span>(n + <span class="number">1</span>);</span><br><span class="line">    vector&lt;vector&lt;<span class="type">int</span>&gt;&gt; <span class="built_in">a2</span>(n + <span class="number">1</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; m1; i++){</span><br><span class="line">        <span class="type">int</span> u, v;</span><br><span class="line">        cin &gt;&gt; u &gt;&gt; v;</span><br><span class="line">        a1[u].<span class="built_in">push_back</span>(v);</span><br><span class="line">        a1[v].<span class="built_in">push_back</span>(u);</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; m2; i++){</span><br><span class="line">        <span class="type">int</span> u, v;</span><br><span class="line">        cin &gt;&gt; u &gt;&gt; v;</span><br><span class="line">        a2[u].<span class="built_in">push_back</span>(v);</span><br><span class="line">        a2[v].<span class="built_in">push_back</span>(u);</span><br><span class="line">    }</span><br><span class="line">    <span class="comment">// è¿›è¡Œç¼–å·</span></span><br><span class="line">    <span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">col1</span><span class="params">(n + <span class="number">1</span>,<span class="number">0</span>)</span></span>;</span><br><span class="line">    <span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">col2</span><span class="params">(n + <span class="number">1</span>, <span class="number">0</span>)</span></span>;</span><br><span class="line">    <span class="keyword">auto</span> dfs2 = [&amp;](<span class="keyword">auto</span> f,<span class="type">int</span> u, <span class="type">int</span> k) -&gt; <span class="type">void</span>{</span><br><span class="line">        col2[u] = k;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">auto</span> x : a2[u]){</span><br><span class="line">            <span class="keyword">if</span>(col2[x] == <span class="number">0</span>){</span><br><span class="line">                <span class="built_in">f</span>(f,x,k);</span><br><span class="line">            }</span><br><span class="line">        }</span><br><span class="line">    };</span><br><span class="line">    <span class="keyword">auto</span> dfs1 = [&amp;](<span class="keyword">auto</span> f, <span class="type">int</span> u, <span class="type">int</span> k) -&gt; <span class="type">int</span>{</span><br><span class="line">        <span class="type">int</span> cnt = <span class="number">0</span>;</span><br><span class="line">        col1[u] = k;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">auto</span> x : a1[u]){</span><br><span class="line">            <span class="keyword">if</span>(col1[x] == <span class="number">0</span>){</span><br><span class="line">            <span class="keyword">if</span>(col2[x] != k) cnt++;</span><br><span class="line">            <span class="keyword">else</span> cnt += <span class="built_in">f</span>(f,x,k);}</span><br><span class="line">        }</span><br><span class="line">        <span class="keyword">return</span> cnt;</span><br><span class="line">    };</span><br><span class="line">    <span class="type">int</span> ans = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++){</span><br><span class="line">        <span class="keyword">if</span>(col2[i] == <span class="number">0</span>){</span><br><span class="line">            <span class="built_in">dfs2</span>(dfs2,i,i);</span><br><span class="line">        }</span><br><span class="line">        <span class="keyword">if</span>(col1[i] == <span class="number">0</span>){</span><br><span class="line">            ans += <span class="built_in">dfs1</span>(dfs1,i,col2[i]);</span><br><span class="line">            <span class="keyword">if</span>(col2[i] &lt; i) ans ++; <span class="comment">// åœ¨å‰é¢æœ‰ä»£è¡¨èŠ‚ç‚¹çš„æ—¶å€™ä¾¿å·²ç»è®¿é—®è¿‡è¿™ä¸ªèŠ‚ç‚¹ï¼Œä½†æ˜¯åœ¨Få›¾ä¸­è¿™ä¸ª i èŠ‚ç‚¹å¹¶æ²¡æœ‰è¢« åˆå§‹åŒ–ï¼Œè¯´æ˜å‰é¢çš„ä»£è¡¨èŠ‚ç‚¹å’Œè¿™ä¸ªèŠ‚ç‚¹ä¹‹é—´åº”è¯¥è¦å¢åŠ ä¸€æ¡è¾¹</span></span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line">    cout &lt;&lt; ans &lt;&lt; endl;</span><br><span class="line">}</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span></span>{</span><br><span class="line">    <span class="type">int</span> _;</span><br><span class="line">    cin &gt;&gt; _;</span><br><span class="line">    <span class="keyword">while</span>(_--) __();</span><br><span class="line">}</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="å¿«é€Ÿå¹‚"><a class="markdownIt-Anchor" href="#å¿«é€Ÿå¹‚"></a> å¿«é€Ÿå¹‚</h3>
<h4 id="æ— -mod"><a class="markdownIt-Anchor" href="#æ— -mod"></a> æ—  mod</h4>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> <span class="title">fpw</span><span class="params">(<span class="type">int</span> a, <span class="type">int</span> b)</span></span>{</span><br><span class="line">    <span class="type">int</span> res = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span>(b){</span><br><span class="line">        <span class="keyword">if</span>(b &amp; <span class="number">1</span>) res *= a;</span><br><span class="line">        a *= a;</span><br><span class="line">        b &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">    }</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">}</span><br></pre></td></tr></table></figure>
<h4 id="æœ‰mod"><a class="markdownIt-Anchor" href="#æœ‰mod"></a> æœ‰mod</h4>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> <span class="title">fpw</span><span class="params">(<span class="type">int</span> a, <span class="type">int</span> b, <span class="type">int</span> mod)</span></span>{</span><br><span class="line">    <span class="type">int</span> res = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span>(b){</span><br><span class="line">        <span class="keyword">if</span>(b &amp; <span class="number">1</span>){</span><br><span class="line">            res = res * a % mod;</span><br><span class="line">        }</span><br><span class="line">        a = a * a % mod;</span><br><span class="line">        b &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">    }</span><br><span class="line">    <span class="keyword">return</span> res % mod;</span><br><span class="line">}</span><br></pre></td></tr></table></figure>
<h3 id="ä¹˜æ³•é€†å…ƒ"><a class="markdownIt-Anchor" href="#ä¹˜æ³•é€†å…ƒ"></a> ä¹˜æ³•é€†å…ƒ</h3>
<h4 id="çº¿æ€§"><a class="markdownIt-Anchor" href="#çº¿æ€§"></a> çº¿æ€§</h4>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">inv[<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">2</span>; i &lt;= n; ++i) {</span><br><span class="line">  inv[i] = (<span class="type">long</span> <span class="type">long</span>)(p - p / i) * inv[p % i] % p;</span><br><span class="line">}</span><br></pre></td></tr></table></figure>
<h4 id="æ‰©å±•æ¬§å‡ é‡Œå¾—"><a class="markdownIt-Anchor" href="#æ‰©å±•æ¬§å‡ é‡Œå¾—"></a> æ‰©å±•æ¬§å‡ é‡Œå¾—</h4>
<h4 id="è´¹é©¬å°"><a class="markdownIt-Anchor" href="#è´¹é©¬å°"></a> è´¹é©¬å°</h4>
<p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>a</mi><mi>x</mi><mo>â‰¡</mo><mn>1</mn><mo stretchy="false">(</mo><mi>m</mi><mi>o</mi><mi>d</mi><mtext>â€…â€Š</mtext><mi>b</mi><mo stretchy="false">)</mo><mspace linebreak="newline"></mspace><mi>x</mi><mo>=</mo><msup><mi>a</mi><mrow><mi>b</mi><mo>âˆ’</mo><mn>2</mn></mrow></msup><mo stretchy="false">(</mo><mi>m</mi><mi>o</mi><mi>d</mi><mtext>â€…â€Š</mtext><mi>b</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">ax \equiv 1(mod \; b) \\
x = a^{b - 2}(mod \; b)
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.46375em;vertical-align:0em;"></span><span class="mord mathdefault">a</span><span class="mord mathdefault">x</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">â‰¡</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mopen">(</span><span class="mord mathdefault">m</span><span class="mord mathdefault">o</span><span class="mord mathdefault">d</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord mathdefault">b</span><span class="mclose">)</span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">x</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.149108em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8991079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">b</span><span class="mbin mtight">âˆ’</span><span class="mord mtight">2</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault">m</span><span class="mord mathdefault">o</span><span class="mord mathdefault">d</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord mathdefault">b</span><span class="mclose">)</span></span></span></span></span></p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">x = <span class="built_in">fpw</span>(a, b<span class="number">-2</span>,b)</span><br></pre></td></tr></table></figure>
<h2 id="æ•°æ®ç»“æ„"><a class="markdownIt-Anchor" href="#æ•°æ®ç»“æ„"></a> æ•°æ®ç»“æ„</h2>
<h3 id="æŠ˜åŠæœç´¢"><a class="markdownIt-Anchor" href="#æŠ˜åŠæœç´¢"></a> æŠ˜åŠæœç´¢</h3>
<p><a target="_blank" rel="noopener" href="https://oi-wiki.org/search/bidirectional/">OI WIKI - Meet in the middle</a></p>
<h3 id="å¹¶æŸ¥é›†"><a class="markdownIt-Anchor" href="#å¹¶æŸ¥é›†"></a> å¹¶æŸ¥é›†</h3>
<h4 id="åŸºç¡€å¹¶æŸ¥é›†"><a class="markdownIt-Anchor" href="#åŸºç¡€å¹¶æŸ¥é›†"></a> åŸºç¡€å¹¶æŸ¥é›†</h4>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> father[N];</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">init</span><span class="params">()</span></span>{ <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; N; i++) father[i] = i; }</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">find</span><span class="params">(<span class="type">int</span> x)</span></span>{</span><br><span class="line">    <span class="keyword">if</span>(x != father[x]){</span><br><span class="line">        father[x] = <span class="built_in">find</span>(father[x]);</span><br><span class="line">    }</span><br><span class="line">    <span class="keyword">return</span> x;</span><br><span class="line">}</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">un</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> y)</span></span>{</span><br><span class="line">    <span class="type">int</span> fx = <span class="built_in">find</span>(x), fy = <span class="built_in">find</span>(y);</span><br><span class="line">    <span class="keyword">if</span>(fx != fy){</span><br><span class="line">        father[fx] = fy;</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></table></figure>
<h4 id="å¸¦æƒå¹¶æŸ¥é›†"><a class="markdownIt-Anchor" href="#å¸¦æƒå¹¶æŸ¥é›†"></a> å¸¦æƒå¹¶æŸ¥é›†</h4>
<blockquote>
<p>ä¸ªäººæ„Ÿè§‰å¸¦æƒå¹¶æŸ¥é›†æœ‰ç‚¹ç±»ä¼¼äº æ ‘å½¢DPï¼Œåç»­è¡¥å……</p>
</blockquote>
<p>â€˜helloâ€™</p>
<h3 id="å‰ç¼€å’Œ-å·®åˆ†"><a class="markdownIt-Anchor" href="#å‰ç¼€å’Œ-å·®åˆ†"></a> å‰ç¼€å’Œ + å·®åˆ†</h3>
<h4 id="å‰ç¼€å’Œ"><a class="markdownIt-Anchor" href="#å‰ç¼€å’Œ"></a> å‰ç¼€å’Œ</h4>
<h5 id="ä¸€ç»´"><a class="markdownIt-Anchor" href="#ä¸€ç»´"></a> ä¸€ç»´</h5>
<p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>s</mi><mi>u</mi><mi>m</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo><mo>=</mo><mi>s</mi><mi>u</mi><mi>m</mi><mo stretchy="false">[</mo><mi>i</mi><mo>âˆ’</mo><mn>1</mn><mo stretchy="false">]</mo><mo>+</mo><mi>a</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">sum[i] = sum[i - 1] + a[i]
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">s</span><span class="mord mathdefault">u</span><span class="mord mathdefault">m</span><span class="mopen">[</span><span class="mord mathdefault">i</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">s</span><span class="mord mathdefault">u</span><span class="mord mathdefault">m</span><span class="mopen">[</span><span class="mord mathdefault">i</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">a</span><span class="mopen">[</span><span class="mord mathdefault">i</span><span class="mclose">]</span></span></span></span></span></p>
<h5 id="äºŒç»´"><a class="markdownIt-Anchor" href="#äºŒç»´"></a> äºŒç»´</h5>
<p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>s</mi><mi>u</mi><mi>m</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mi>j</mi><mo stretchy="false">]</mo><mo>=</mo><mi>a</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mi>j</mi><mo stretchy="false">]</mo><mo>+</mo><mi>s</mi><mi>u</mi><mi>m</mi><mo stretchy="false">[</mo><mi>i</mi><mo>âˆ’</mo><mn>1</mn><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mi>j</mi><mo stretchy="false">]</mo><mo>+</mo><mi>s</mi><mi>u</mi><mi>m</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mi>j</mi><mo>âˆ’</mo><mn>1</mn><mo stretchy="false">]</mo><mo>âˆ’</mo><mi>s</mi><mi>u</mi><mi>m</mi><mo stretchy="false">[</mo><mi>i</mi><mo>âˆ’</mo><mn>1</mn><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mi>j</mi><mo>âˆ’</mo><mn>1</mn><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">sum[i][j] = a[i][j] + sum[i - 1][j] + sum[i][j - 1] - sum[i - 1][j - 1]
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">s</span><span class="mord mathdefault">u</span><span class="mord mathdefault">m</span><span class="mopen">[</span><span class="mord mathdefault">i</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord mathdefault" style="margin-right:0.05724em;">j</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">a</span><span class="mopen">[</span><span class="mord mathdefault">i</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord mathdefault" style="margin-right:0.05724em;">j</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">s</span><span class="mord mathdefault">u</span><span class="mord mathdefault">m</span><span class="mopen">[</span><span class="mord mathdefault">i</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord mathdefault" style="margin-right:0.05724em;">j</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">s</span><span class="mord mathdefault">u</span><span class="mord mathdefault">m</span><span class="mopen">[</span><span class="mord mathdefault">i</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord mathdefault" style="margin-right:0.05724em;">j</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">s</span><span class="mord mathdefault">u</span><span class="mord mathdefault">m</span><span class="mopen">[</span><span class="mord mathdefault">i</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord mathdefault" style="margin-right:0.05724em;">j</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">]</span></span></span></span></span></p>
<h5 id="æ ‘ä¸Šå‰ç¼€å’Œ"><a class="markdownIt-Anchor" href="#æ ‘ä¸Šå‰ç¼€å’Œ"></a> æ ‘ä¸Šå‰ç¼€å’Œ</h5>
<ul>
<li>ç‚¹æƒ</li>
</ul>
<p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>x</mi><mo>â†’</mo><mi>y</mi><mi mathvariant="normal">çš„</mi><mi mathvariant="normal">è·¯</mi><mi mathvariant="normal">å¾„</mi><mo>=</mo><mi>s</mi><mi>u</mi><msub><mi>m</mi><mi>x</mi></msub><mo>+</mo><mi>s</mi><mi>u</mi><msub><mi>m</mi><mi>y</mi></msub><mo>âˆ’</mo><mi>s</mi><mi>u</mi><msub><mi>m</mi><mrow><mi>l</mi><mi>c</mi><mi>a</mi></mrow></msub><mo>âˆ’</mo><mi>s</mi><mi>u</mi><msub><mi>m</mi><msub><mi>f</mi><mrow><mi>a</mi><mi>l</mi><mi>c</mi><mi>a</mi></mrow></msub></msub></mrow><annotation encoding="application/x-tex">x\rightarrow y çš„è·¯å¾„ = sum_x + sum_y - sum_{lca} - sum_{f_{alca}}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">x</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">â†’</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="mord cjk_fallback">çš„</span><span class="mord cjk_fallback">è·¯</span><span class="mord cjk_fallback">å¾„</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.73333em;vertical-align:-0.15em;"></span><span class="mord mathdefault">s</span><span class="mord mathdefault">u</span><span class="mord"><span class="mord mathdefault">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">x</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.8694379999999999em;vertical-align:-0.286108em;"></span><span class="mord mathdefault">s</span><span class="mord mathdefault">u</span><span class="mord"><span class="mord mathdefault">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.15139200000000003em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.03588em;">y</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.73333em;vertical-align:-0.15em;"></span><span class="mord mathdefault">s</span><span class="mord mathdefault">u</span><span class="mord"><span class="mord mathdefault">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.01968em;">l</span><span class="mord mathdefault mtight">c</span><span class="mord mathdefault mtight">a</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.716668em;vertical-align:-0.286108em;"></span><span class="mord mathdefault">s</span><span class="mord mathdefault">u</span><span class="mord"><span class="mord mathdefault">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361079999999999em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3487714285714287em;margin-left:-0.10764em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">a</span><span class="mord mathdefault mtight" style="margin-right:0.01968em;">l</span><span class="mord mathdefault mtight">c</span><span class="mord mathdefault mtight">a</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15122857142857138em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span></span></span></span></span></p>
<ul>
<li>è¾¹æƒ</li>
</ul>
<p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>x</mi><mo>â†’</mo><mi>y</mi><mi mathvariant="normal">çš„</mi><mi mathvariant="normal">è·¯</mi><mi mathvariant="normal">å¾„</mi><mo>=</mo><mi>s</mi><mi>u</mi><msub><mi>m</mi><mi>x</mi></msub><mo>+</mo><mi>s</mi><mi>u</mi><msub><mi>m</mi><mi>y</mi></msub><mo>âˆ’</mo><mn>2</mn><mo>âˆ—</mo><mi>s</mi><mi>u</mi><msub><mi>m</mi><mrow><mi>l</mi><mi>c</mi><mi>a</mi></mrow></msub></mrow><annotation encoding="application/x-tex">x \rightarrow y çš„è·¯å¾„ = sum_x + sum_y - 2 * sum_{lca}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">x</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">â†’</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="mord cjk_fallback">çš„</span><span class="mord cjk_fallback">è·¯</span><span class="mord cjk_fallback">å¾„</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.73333em;vertical-align:-0.15em;"></span><span class="mord mathdefault">s</span><span class="mord mathdefault">u</span><span class="mord"><span class="mord mathdefault">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">x</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.8694379999999999em;vertical-align:-0.286108em;"></span><span class="mord mathdefault">s</span><span class="mord mathdefault">u</span><span class="mord"><span class="mord mathdefault">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.15139200000000003em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.03588em;">y</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">2</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord mathdefault">s</span><span class="mord mathdefault">u</span><span class="mord"><span class="mord mathdefault">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.01968em;">l</span><span class="mord mathdefault mtight">c</span><span class="mord mathdefault mtight">a</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span></p>
<h4 id="å·®åˆ†"><a class="markdownIt-Anchor" href="#å·®åˆ†"></a> å·®åˆ†</h4>
<blockquote>
<p>ç”¨äºå¿«é€Ÿè§£å†³åŒºé—´ä¿®æ”¹é—®é¢˜</p>
</blockquote>
<h5 id="ä¸€ç»´-2"><a class="markdownIt-Anchor" href="#ä¸€ç»´-2"></a> ä¸€ç»´</h5>
<p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>b</mi><mi>i</mi></msub><mo>=</mo><msub><mi>a</mi><mi>i</mi></msub><mo>âˆ’</mo><msub><mi>a</mi><mrow><mi>i</mi><mo>âˆ’</mo><mn>1</mn></mrow></msub></mrow><annotation encoding="application/x-tex">b_i = a_i - a_{i - 1}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.73333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.638891em;vertical-align:-0.208331em;"></span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mbin mtight">âˆ’</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span></span></span></span></span></p>
<p>å¦‚æœå­˜åœ¨ [l, r] åŒºé—´å†…çš„å€¼è¿›è¡ŒèŒƒå›´ä¿®æ”¹,åœ¨å·®åˆ†æ•°ç»„ä¸Šé¢ <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>b</mi><mi>l</mi></msub><mo>+</mo><mi>d</mi><mo separator="true">,</mo><msub><mi>b</mi><mrow><mi>r</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>âˆ’</mo><mi>d</mi></mrow><annotation encoding="application/x-tex">b_l + d,b_{r + 1} - d</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.01968em;">l</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.902771em;vertical-align:-0.208331em;"></span><span class="mord mathdefault">d</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.301108em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.02778em;">r</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault">d</span></span></span></span></p>
<h5 id="äºŒç»´-2"><a class="markdownIt-Anchor" href="#äºŒç»´-2"></a> äºŒç»´</h5>
<p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>d</mi><mi>i</mi><mi>f</mi><mi>f</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mi>j</mi><mo stretchy="false">]</mo><mo>=</mo><mi>a</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mi>j</mi><mo stretchy="false">]</mo><mo>âˆ’</mo><mi>a</mi><mo stretchy="false">[</mo><mi>i</mi><mo>âˆ’</mo><mn>1</mn><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mi>j</mi><mo stretchy="false">]</mo><mo>âˆ’</mo><mi>a</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mi>j</mi><mo>âˆ’</mo><mn>1</mn><mo stretchy="false">]</mo><mo>+</mo><mi>a</mi><mo stretchy="false">[</mo><mi>i</mi><mo>âˆ’</mo><mn>1</mn><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mi>j</mi><mo>âˆ’</mo><mn>1</mn><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">diff[i][j] = a[i][j] - a[i - 1][j] - a[i][j - 1] + a[i - 1][j - 1]
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">d</span><span class="mord mathdefault">i</span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="mopen">[</span><span class="mord mathdefault">i</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord mathdefault" style="margin-right:0.05724em;">j</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">a</span><span class="mopen">[</span><span class="mord mathdefault">i</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord mathdefault" style="margin-right:0.05724em;">j</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">a</span><span class="mopen">[</span><span class="mord mathdefault">i</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord mathdefault" style="margin-right:0.05724em;">j</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">a</span><span class="mopen">[</span><span class="mord mathdefault">i</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord mathdefault" style="margin-right:0.05724em;">j</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">a</span><span class="mopen">[</span><span class="mord mathdefault">i</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord mathdefault" style="margin-right:0.05724em;">j</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">]</span></span></span></span></span></p>
<p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>a</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mi>j</mi><mo stretchy="false">]</mo><mo>=</mo><munderover><mo>âˆ‘</mo><mrow><mi>t</mi><mn>1</mn><mo>=</mo><mn>1</mn></mrow><mi>i</mi></munderover><munderover><mo>âˆ‘</mo><mrow><mi>t</mi><mn>2</mn><mo>=</mo><mn>1</mn></mrow><mi>j</mi></munderover><mi>d</mi><mi>i</mi><mi>f</mi><mi>f</mi><mo stretchy="false">[</mo><mi>t</mi><mn>1</mn><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mi>t</mi><mn>2</mn><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">a[i][j] = \sum_{t1 = 1}^{i}\sum_{t2 = 1}^{j} diff[t1][t2]
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">a</span><span class="mopen">[</span><span class="mord mathdefault">i</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord mathdefault" style="margin-right:0.05724em;">j</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:3.12589em;vertical-align:-1.267113em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8116690000000002em;"><span style="top:-1.882887em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">t</span><span class="mord mtight">1</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.050005em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">âˆ‘</span></span></span><span style="top:-4.3000050000000005em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.267113em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8587770000000003em;"><span style="top:-1.882887em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">t</span><span class="mord mtight">2</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.050005em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">âˆ‘</span></span></span><span style="top:-4.347113em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.267113em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">d</span><span class="mord mathdefault">i</span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="mopen">[</span><span class="mord mathdefault">t</span><span class="mord">1</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord mathdefault">t</span><span class="mord">2</span><span class="mclose">]</span></span></span></span></span></p>
<h5 id="æ ‘ä¸Šå·®åˆ†"><a class="markdownIt-Anchor" href="#æ ‘ä¸Šå·®åˆ†"></a> æ ‘ä¸Šå·®åˆ†</h5>
<ul>
<li>ç‚¹å·®åˆ†</li>
</ul>
<blockquote>
<p>å¦‚æŸ¥è¯¢ä¸€æ£µæ ‘ä¸Š èŠ‚ç‚¹è¢«è®¿é—®çš„æ¬¡æ•°</p>
</blockquote>
<p>Ex:  s åˆ° t è·¯å¾„èŠ‚ç‚¹çš„è®¿é—®ä¿®æ”¹</p>
<p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>d</mi><mi>s</mi></msub><mo>=</mo><msub><mi>d</mi><mi>s</mi></msub><mo>+</mo><mn>1</mn><mspace linebreak="newline"></mspace><msub><mi>d</mi><mrow><mi>l</mi><mi>c</mi><mi>a</mi></mrow></msub><mo>=</mo><msub><mi>d</mi><mrow><mi>l</mi><mi>c</mi><mi>a</mi></mrow></msub><mo>âˆ’</mo><mn>1</mn><mspace linebreak="newline"></mspace><msub><mi>d</mi><mi>t</mi></msub><mo>=</mo><msub><mi>d</mi><mi>t</mi></msub><mo>+</mo><mn>1</mn><mspace linebreak="newline"></mspace><msub><mi>d</mi><mrow><mi>f</mi><mo stretchy="false">(</mo><mi>l</mi><mi>c</mi><mi>a</mi><mo stretchy="false">)</mo></mrow></msub><mo>=</mo><msub><mi>d</mi><mrow><mi>f</mi><mo stretchy="false">(</mo><mi>l</mi><mi>c</mi><mi>a</mi><mo stretchy="false">)</mo></mrow></msub><mo>âˆ’</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">d_s = d_s + 1 \\
d_{lca} = d_{lca} - 1\\
d_t = d_t + 1\\
d_{f(lca)} = d_{f(lca)} - 1
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">s</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">s</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.01968em;">l</span><span class="mord mathdefault mtight">c</span><span class="mord mathdefault mtight">a</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.01968em;">l</span><span class="mord mathdefault mtight">c</span><span class="mord mathdefault mtight">a</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:1.04964em;vertical-align:-0.3551999999999999em;"></span><span class="mord"><span class="mord mathdefault">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.34480000000000005em;"><span style="top:-2.5198em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.10764em;">f</span><span class="mopen mtight">(</span><span class="mord mathdefault mtight" style="margin-right:0.01968em;">l</span><span class="mord mathdefault mtight">c</span><span class="mord mathdefault mtight">a</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.3551999999999999em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.04964em;vertical-align:-0.3551999999999999em;"></span><span class="mord"><span class="mord mathdefault">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.34480000000000005em;"><span style="top:-2.5198em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.10764em;">f</span><span class="mopen mtight">(</span><span class="mord mathdefault mtight" style="margin-right:0.01968em;">l</span><span class="mord mathdefault mtight">c</span><span class="mord mathdefault mtight">a</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.3551999999999999em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span></span></p>
<p>å½“å‰èŠ‚ç‚¹çš„æƒé‡,ç”±äºå½“å‰èŠ‚ç‚¹çš„æƒé‡ä¸å­èŠ‚ç‚¹æœ‰å…³ï¼Œä¾¿å¯ä»¥å¾ˆå¥½çš„è§£é‡Š ä¸Šé¢è¿™ä¸ªå·®åˆ†è®¿é—®ä¿®æ”¹</p>
<p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>a</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo><mo>=</mo><mover><mo>âˆ‘</mo><mrow><mi>i</mi><mi mathvariant="normal">çš„</mi><mi mathvariant="normal">å­</mi><mi mathvariant="normal">èŠ‚</mi><mi mathvariant="normal">ç‚¹</mi></mrow></mover><mi>d</mi><mi>i</mi><mi>f</mi><mi>f</mi><mo stretchy="false">[</mo><mi>t</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">a[i] = \sum^{içš„å­èŠ‚ç‚¹}diff[t]
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">a</span><span class="mopen">[</span><span class="mord mathdefault">i</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:2.3616740000000003em;vertical-align:-0.5500050000000001em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8116690000000002em;"><span style="top:-3.0500049999999996em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">âˆ‘</span></span></span><span style="top:-4.300005em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord cjk_fallback mtight">çš„</span><span class="mord cjk_fallback mtight">å­</span><span class="mord cjk_fallback mtight">èŠ‚</span><span class="mord cjk_fallback mtight">ç‚¹</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.5500050000000001em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">d</span><span class="mord mathdefault">i</span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="mopen">[</span><span class="mord mathdefault">t</span><span class="mclose">]</span></span></span></span></span></p>
<ul>
<li>è¾¹å·®åˆ†</li>
</ul>
<p>Ex:  s åˆ° t è·¯å¾„çš„è¾¹çš„è®¿é—®ä¿®æ”¹</p>
<p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>d</mi><mi>s</mi></msub><mo>=</mo><msub><mi>d</mi><mi>s</mi></msub><mo>+</mo><mn>1</mn><mspace linebreak="newline"></mspace><msub><mi>d</mi><mi>t</mi></msub><mo>=</mo><msub><mi>d</mi><mi>t</mi></msub><mo>+</mo><mn>1</mn><mspace linebreak="newline"></mspace><msub><mi>d</mi><mrow><mi>l</mi><mi>c</mi><mi>a</mi></mrow></msub><mo>=</mo><msub><mi>d</mi><mrow><mi>l</mi><mi>c</mi><mi>a</mi></mrow></msub><mo>âˆ’</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">d_s = d_s + 1\\
d_t = d_t + 1\\
d_{lca} = d_{lca} - 1
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">s</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">s</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.01968em;">l</span><span class="mord mathdefault mtight">c</span><span class="mord mathdefault mtight">a</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.01968em;">l</span><span class="mord mathdefault mtight">c</span><span class="mord mathdefault mtight">a</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span></span></p>
<p>å½“å‰èŠ‚ç‚¹çš„æƒé‡,ç”±äºå½“å‰èŠ‚ç‚¹çš„æƒé‡ä¸å­èŠ‚ç‚¹æœ‰å…³ï¼Œä¾¿å¯ä»¥å¾ˆå¥½çš„è§£é‡Š ä¸Šé¢è¿™ä¸ªå·®åˆ†è®¿é—®ä¿®æ”¹</p>
<p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>a</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo><mo>=</mo><mover><mo>âˆ‘</mo><mrow><mi>i</mi><mi mathvariant="normal">çš„</mi><mi mathvariant="normal">å­</mi><mi mathvariant="normal">èŠ‚</mi><mi mathvariant="normal">ç‚¹</mi></mrow></mover><mi>d</mi><mi>i</mi><mi>f</mi><mi>f</mi><mo stretchy="false">[</mo><mi>t</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">a[i] = \sum^{içš„å­èŠ‚ç‚¹}diff[t]
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">a</span><span class="mopen">[</span><span class="mord mathdefault">i</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:2.3616740000000003em;vertical-align:-0.5500050000000001em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8116690000000002em;"><span style="top:-3.0500049999999996em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">âˆ‘</span></span></span><span style="top:-4.300005em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord cjk_fallback mtight">çš„</span><span class="mord cjk_fallback mtight">å­</span><span class="mord cjk_fallback mtight">èŠ‚</span><span class="mord cjk_fallback mtight">ç‚¹</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.5500050000000001em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">d</span><span class="mord mathdefault">i</span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="mopen">[</span><span class="mord mathdefault">t</span><span class="mclose">]</span></span></span></span></span></p>
<h3 id="çº¿æ®µæ ‘"><a class="markdownIt-Anchor" href="#çº¿æ®µæ ‘"></a> çº¿æ®µæ ‘</h3>
<h4 id="åŸºç¡€çº¿æ®µæ ‘"><a class="markdownIt-Anchor" href="#åŸºç¡€çº¿æ®µæ ‘"></a> åŸºç¡€çº¿æ®µæ ‘</h4>
<blockquote>
<p>æ‡’æ›´æ–°çš„æ„ä¹‰æ˜¯ï¼Œå¦‚æœè¿™ä¸ªå¤§åŒºé—´è¿›è¡Œäº†ä¿®æ”¹ï¼Œå½“è®¿é—®åˆ°è¿™ä¸ªå¤§åŒºé—´çš„å­åŒºé—´æ—¶æˆ‘ä»¬å†å»ä¸‹å‘å¤§åŒºé—´çš„ä¿®æ”¹ä¿¡æ¯ã€‚</p>
</blockquote>
<h5 id="åŒºé—´æŸ¥è¯¢åŒºé—´å˜åŒ–åŒºé—´é‡ç½®"><a class="markdownIt-Anchor" href="#åŒºé—´æŸ¥è¯¢åŒºé—´å˜åŒ–åŒºé—´é‡ç½®"></a> åŒºé—´æŸ¥è¯¢ï¼ŒåŒºé—´å˜åŒ–ï¼ŒåŒºé—´é‡ç½®</h5>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br></pre></td><td class="code"><pre><span class="line">#<span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line">#<span class="meta">#<span class="keyword">define</span> int long long</span></span><br><span class="line">#<span class="meta">#<span class="keyword">define</span> endl <span class="string">'\n'</span></span></span><br><span class="line">#<span class="meta">#<span class="keyword">define</span> fr first</span></span><br><span class="line">#<span class="meta">#<span class="keyword">define</span> sc second</span></span><br><span class="line"></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">1e5</span> + <span class="number">10</span>;</span><br><span class="line"><span class="type">int</span> sum[<span class="number">4</span> * N];</span><br><span class="line"><span class="type">int</span> ad[<span class="number">4</span> * N];</span><br><span class="line"><span class="type">int</span> a[N];</span><br><span class="line"><span class="type">int</span> change[<span class="number">4</span> *N];</span><br><span class="line"><span class="type">bool</span> vis[<span class="number">4</span> * N];</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">  åŒºé—´æŸ¥è¯¢ï¼ŒåŒºé—´å˜åŒ–ï¼ŒåŒºé—´é‡ç½®</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">build</span><span class="params">(<span class="type">int</span> l, <span class="type">int</span> r, <span class="type">int</span> i)</span></span>{</span><br><span class="line">    <span class="keyword">if</span>(l == r){</span><br><span class="line">       sum[i] = a[r];</span><br><span class="line">       <span class="keyword">return</span>;</span><br><span class="line">    }</span><br><span class="line">    <span class="type">int</span> mod = (l + r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">    <span class="built_in">build</span>(l, mod, i &lt;&lt; <span class="number">1</span>);</span><br><span class="line">    <span class="built_in">build</span>(mod + <span class="number">1</span>, r, i &lt;&lt; <span class="number">1</span> | <span class="number">1</span>);</span><br><span class="line">    sum[i] = sum[i &lt;&lt; <span class="number">1</span>] + sum[i &lt;&lt; <span class="number">1</span> | <span class="number">1</span>];</span><br><span class="line">    ad[i] = <span class="number">0</span>;</span><br><span class="line">    change[i] = <span class="number">0</span>;</span><br><span class="line">    vis[i] = <span class="literal">false</span>;</span><br><span class="line">}</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">down</span><span class="params">(<span class="type">int</span> i, <span class="type">int</span> ln, <span class="type">int</span> rn)</span></span>{</span><br><span class="line">    <span class="keyword">if</span>(vis[i]){</span><br><span class="line">      sum[i &lt;&lt; <span class="number">1</span>] = change[i] * ln;</span><br><span class="line">      change[i &lt;&lt; <span class="number">1</span>] = change[i];</span><br><span class="line">      vis[i &lt;&lt; <span class="number">1</span>] = <span class="literal">true</span>;</span><br><span class="line">      sum[i &lt;&lt; <span class="number">1</span> | <span class="number">1</span>] = change[i] * rn;     </span><br><span class="line">      change[i &lt;&lt; <span class="number">1</span> | <span class="number">1</span>] = change[i];</span><br><span class="line">      vis[i &lt;&lt; <span class="number">1</span> | <span class="number">1</span>] = <span class="literal">true</span>;</span><br><span class="line">      vis[i] = <span class="literal">false</span>;</span><br><span class="line">    }</span><br><span class="line">    <span class="keyword">if</span>(ad[i] != <span class="number">0</span>){</span><br><span class="line">        sum[i &lt;&lt; <span class="number">1</span>] += (ln * ad[i]);</span><br><span class="line">        ad[i &lt;&lt; <span class="number">1</span>] += ad[i];</span><br><span class="line">        sum[i &lt;&lt; <span class="number">1</span> | <span class="number">1</span>] += (rn * ad[i]);</span><br><span class="line">        ad[i &lt;&lt; <span class="number">1</span> | <span class="number">1</span>] += ad[i];</span><br><span class="line">        ad[i] = <span class="number">0</span>;</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">add</span><span class="params">(<span class="type">int</span> wol, <span class="type">int</span> wor, <span class="type">int</span> wov, <span class="type">int</span> l, <span class="type">int</span> r, <span class="type">int</span> i)</span></span>{</span><br><span class="line">    <span class="keyword">if</span>(l &gt;= wol &amp;&amp; r &lt;= wor){</span><br><span class="line">        sum[i] += (r - l + <span class="number">1</span>) * wov;</span><br><span class="line">        ad[i] += wov;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="type">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">      l -&gt; mid mid + 1-&gt; r</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">    <span class="built_in">down</span>(i, (mid - l + <span class="number">1</span>), (r - mid));</span><br><span class="line">    <span class="keyword">if</span>(wol &lt;= mid){</span><br><span class="line">        <span class="built_in">add</span>(wol, wor, wov, l, mid, i &lt;&lt; <span class="number">1</span>);</span><br><span class="line">    }</span><br><span class="line">    <span class="keyword">if</span>(wor &gt;= mid + <span class="number">1</span>){</span><br><span class="line">        <span class="built_in">add</span>(wol, wor, wov, mid + <span class="number">1</span>, r, i &lt;&lt; <span class="number">1</span> | <span class="number">1</span>);</span><br><span class="line">    }</span><br><span class="line">    sum[i] = sum[i &lt;&lt; <span class="number">1</span>] + sum[i &lt;&lt; <span class="number">1</span> | <span class="number">1</span>];</span><br><span class="line">}</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">cha</span><span class="params">(<span class="type">int</span> wol, <span class="type">int</span> wor, <span class="type">int</span> wov, <span class="type">int</span> l, <span class="type">int</span> r, <span class="type">int</span> i)</span></span>{</span><br><span class="line">    <span class="keyword">if</span>(l &gt;= wol &amp;&amp; r &lt;= wor){</span><br><span class="line">        sum[i] = (r - l + <span class="number">1</span>) * wov;</span><br><span class="line">        change[i] = wov;</span><br><span class="line">        vis[i] = <span class="literal">true</span>;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    }</span><br><span class="line">    <span class="type">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">    <span class="built_in">down</span>(i, (mid - l + <span class="number">1</span>), (r - mid));</span><br><span class="line">    <span class="keyword">if</span>(wol &lt;= mid){</span><br><span class="line">        <span class="built_in">cha</span>(wol, wor, wov, l, mid, i &lt;&lt; <span class="number">1</span>);</span><br><span class="line">    }</span><br><span class="line">    <span class="keyword">if</span>(wor &gt;= mid + <span class="number">1</span>){</span><br><span class="line">        <span class="built_in">cha</span>(wol, wor, wov, mid + <span class="number">1</span>, r, i &lt;&lt; <span class="number">1</span> | <span class="number">1</span>);</span><br><span class="line">    }</span><br><span class="line">    sum[i] = sum[i &lt;&lt; <span class="number">1</span>] + sum[i &lt;&lt; <span class="number">1</span> | <span class="number">1</span>];</span><br><span class="line">}</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">query</span><span class="params">(<span class="type">int</span> wol, <span class="type">int</span> wor, <span class="type">int</span> l, <span class="type">int</span> r, <span class="type">int</span> i)</span></span>{</span><br><span class="line">    <span class="keyword">if</span>(wol &lt;= l &amp;&amp; r &lt;= wor){</span><br><span class="line">        <span class="keyword">return</span> sum[i];</span><br><span class="line">    }</span><br><span class="line">    <span class="type">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">    <span class="built_in">down</span>(i, (mid - l + <span class="number">1</span>), (r - mid));</span><br><span class="line">    <span class="type">int</span> ans = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">if</span>(wol &lt;= mid){</span><br><span class="line">        ans += <span class="built_in">query</span>(wol, wor, l, mid, i &lt;&lt; <span class="number">1</span>);</span><br><span class="line">    }</span><br><span class="line">    <span class="keyword">if</span>(wor &gt;= mid + <span class="number">1</span>){</span><br><span class="line">        ans += <span class="built_in">query</span>(wol, wor, mid + <span class="number">1</span>, r, i &lt;&lt; <span class="number">1</span> | <span class="number">1</span>);</span><br><span class="line">    }</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">}</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span></span>{</span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">      1 1 1 1 6</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">       <span class="type">int</span> n;</span><br><span class="line">       cin &gt;&gt; n;</span><br><span class="line">       <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++) cin &gt;&gt; a[i];</span><br><span class="line">       <span class="built_in">build</span>(<span class="number">1</span>, n, <span class="number">1</span>);</span><br><span class="line">       <span class="type">int</span> q1,q2;</span><br><span class="line">       cin &gt;&gt; q1;</span><br><span class="line">       <span class="keyword">while</span>(q1--){</span><br><span class="line">           <span class="type">int</span> t1, t2, t3;</span><br><span class="line">           cin &gt;&gt; t1 &gt;&gt; t2 &gt;&gt; t3;</span><br><span class="line">           <span class="built_in">add</span>(t1, t2, t3,<span class="number">1</span>,n,<span class="number">1</span>);</span><br><span class="line">       }</span><br><span class="line">       <span class="type">int</span> chl, chr, chv;</span><br><span class="line">       cin &gt;&gt; chl &gt;&gt; chr &gt;&gt; chv;</span><br><span class="line">       <span class="built_in">cha</span>(chl, chr, chv, <span class="number">1</span>, n, <span class="number">1</span>);</span><br><span class="line">       cin &gt;&gt; q2;</span><br><span class="line">       <span class="keyword">while</span>(q2--){</span><br><span class="line">           <span class="type">int</span> l,r;</span><br><span class="line">           cin &gt;&gt; l &gt;&gt; r;</span><br><span class="line">           cout &lt;&lt; <span class="built_in">query</span>(l , r, <span class="number">1</span>, n, <span class="number">1</span>) &lt;&lt; endl; </span><br><span class="line">       }</span><br><span class="line">}</span><br></pre></td></tr></table></figure>
<h5 id="åŒºé—´é‡ç½®-èŒƒå›´æŸ¥è¯¢"><a class="markdownIt-Anchor" href="#åŒºé—´é‡ç½®-èŒƒå›´æŸ¥è¯¢"></a> åŒºé—´é‡ç½® + èŒƒå›´æŸ¥è¯¢</h5>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br></pre></td><td class="code"><pre><span class="line">#<span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line">#<span class="meta">#<span class="keyword">define</span> int long long</span></span><br><span class="line">#<span class="meta">#<span class="keyword">define</span> endl <span class="string">'\n'</span></span></span><br><span class="line">#<span class="meta">#<span class="keyword">define</span> PII pair<span class="string">&lt;int,int&gt;</span></span></span><br><span class="line">#<span class="meta">#<span class="keyword">define</span> fr first</span></span><br><span class="line">#<span class="meta">#<span class="keyword">define</span> sc second</span></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">  èŒƒå›´é‡ç½® + èŒƒå›´æŸ¥è¯¢ï¼ˆçº¿æ®µæ ‘ï¼‰</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">1e5</span> + <span class="number">10</span>;</span><br><span class="line"><span class="type">int</span> Max[<span class="number">4</span> * N]; <span class="comment">// éœ€è¦ 4 * N</span></span><br><span class="line"><span class="type">int</span> a[N];</span><br><span class="line"><span class="comment">// æ‡’æ›´æ–° (è®¿é—®æ‰å¾€ä¸‹æ¨)</span></span><br><span class="line"><span class="type">int</span> change[<span class="number">4</span> * N];</span><br><span class="line"><span class="type">bool</span> update[<span class="number">4</span> * N];</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">  ad è¡¨ç¤ºå½“å‰éœ€è¦ä¸‹å‘çš„ä¿¡æ¯ï¼Œå½“å‰èŠ‚ç‚¹å·²ç»ä¿®æ­£</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="comment">// O(n)</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">build</span><span class="params">(<span class="type">int</span> l, <span class="type">int</span> r, <span class="type">int</span> i)</span></span>{</span><br><span class="line">    <span class="keyword">if</span>(l == r){</span><br><span class="line">        Max[i] = a[r];</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    }</span><br><span class="line">    <span class="type">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span>; <span class="comment">// æœ€åä¸€å®šä¼šè¾¾åˆ°ç›¸ç­‰ï¼Œä¸ä¼šå‡ºç°è¶Šç•Œæƒ…å†µ</span></span><br><span class="line">    <span class="built_in">build</span>(l, mid, i &lt;&lt; <span class="number">1</span>);</span><br><span class="line">    <span class="built_in">build</span>(mid + <span class="number">1</span>, r, i &lt;&lt; <span class="number">1</span> | <span class="number">1</span>);</span><br><span class="line">    Max[i] =<span class="built_in">max</span>( Max[i &lt;&lt; <span class="number">1</span>],Max[i &lt;&lt; <span class="number">1</span> | <span class="number">1</span>]);</span><br><span class="line">    change[i] = <span class="number">0</span>, update[i] = <span class="literal">false</span>;</span><br><span class="line">}</span><br><span class="line"><span class="comment">// æ‡’ä¿¡æ¯ä¸‹å‘</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">down</span><span class="params">(<span class="type">int</span> i, <span class="type">int</span> ln, <span class="type">int</span> rn)</span></span>{</span><br><span class="line">    <span class="keyword">if</span>(update[i]){</span><br><span class="line">        update[i &lt;&lt; <span class="number">1</span>] = <span class="literal">true</span>;</span><br><span class="line">        change[i &lt;&lt; <span class="number">1</span>] = change[i];</span><br><span class="line">        Max[i &lt;&lt; <span class="number">1</span>] = change[i];</span><br><span class="line">        update[i &lt;&lt; <span class="number">1</span> | <span class="number">1</span>] = <span class="literal">true</span>;</span><br><span class="line">        change[i &lt;&lt; <span class="number">1</span> | <span class="number">1</span>] = change[i]; </span><br><span class="line">        Max[i &lt;&lt; <span class="number">1</span> | <span class="number">1</span>] = change[i];</span><br><span class="line">        update[i] = <span class="literal">false</span>;</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="comment">// O(nlog(n)) èŒƒå›´æŸ¥è¯¢</span></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">query</span><span class="params">(<span class="type">int</span> wol, <span class="type">int</span> wor, <span class="type">int</span> l, <span class="type">int</span> r, <span class="type">int</span> i)</span></span>{</span><br><span class="line">    <span class="keyword">if</span>(l &gt;= wol &amp;&amp; r &lt;= wor){</span><br><span class="line">       <span class="keyword">return</span> Max[i];    </span><br><span class="line">    }</span><br><span class="line">    <span class="type">int</span> ans = <span class="number">0</span>;</span><br><span class="line">    <span class="type">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">    <span class="built_in">down</span>(i, mid - l + <span class="number">1</span>, r - mid);</span><br><span class="line">    <span class="keyword">if</span>(mid &gt;=wol){</span><br><span class="line">        ans =<span class="built_in">max</span>(ans,<span class="built_in">query</span>(wol, wor, l, mid, i &lt;&lt; <span class="number">1</span>));</span><br><span class="line">    }</span><br><span class="line">    <span class="keyword">if</span>(mid + <span class="number">1</span>&lt;= wor){</span><br><span class="line">        ans = <span class="built_in">max</span>(ans,<span class="built_in">query</span>(wol, wor, mid + <span class="number">1</span>, r, i &lt;&lt; <span class="number">1</span> | <span class="number">1</span>));</span><br><span class="line">    }</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="comment">// èŒƒå›´iå¢åŠ </span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">up</span><span class="params">(<span class="type">int</span> wol, <span class="type">int</span> wor, <span class="type">int</span> wov, <span class="type">int</span> l, <span class="type">int</span> r, <span class="type">int</span> i)</span></span>{</span><br><span class="line">       <span class="keyword">if</span>(wol &lt;=  l &amp;&amp; r &lt;= wor){</span><br><span class="line">           change[i] = wov;</span><br><span class="line">           update[i] = <span class="literal">true</span>;</span><br><span class="line">           Max[i] = wov; </span><br><span class="line">           <span class="keyword">return</span>;</span><br><span class="line">       }</span><br><span class="line">       <span class="type">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">       <span class="built_in">down</span>(i, mid - l + <span class="number">1</span>, r - mid);</span><br><span class="line">       <span class="keyword">if</span>(wol &lt;= mid){</span><br><span class="line">           <span class="built_in">up</span>(wol, wor, wov, l, mid, i &lt;&lt; <span class="number">1</span>);</span><br><span class="line">       }</span><br><span class="line">       <span class="keyword">if</span>(wor &gt;= mid + <span class="number">1</span>){</span><br><span class="line">           <span class="built_in">up</span>(wol, wor, wov, mid + <span class="number">1</span>, r, i &lt;&lt; <span class="number">1</span> | <span class="number">1</span>);</span><br><span class="line">       }</span><br><span class="line">       Max[i] = <span class="built_in">max</span>(Max[i &lt;&lt; <span class="number">1</span>], Max[i &lt;&lt; <span class="number">1</span> | <span class="number">1</span>]);</span><br><span class="line">       <span class="comment">// cout &lt;&lt; i &lt;&lt; " " &lt;&lt; Max[i] &lt;&lt; endl;</span></span><br><span class="line">}</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span></span>{</span><br><span class="line">       <span class="type">int</span> n;</span><br><span class="line">       cin &gt;&gt; n;</span><br><span class="line">       <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++) cin &gt;&gt; a[i];</span><br><span class="line">       <span class="built_in">build</span>(<span class="number">1</span>, n, <span class="number">1</span>);</span><br><span class="line">       <span class="type">int</span> q1;</span><br><span class="line">       cin &gt;&gt; q1;</span><br><span class="line">       <span class="keyword">while</span>(q1--){</span><br><span class="line">           <span class="type">int</span> l, r, v;</span><br><span class="line">           cin &gt;&gt; l &gt;&gt; r &gt;&gt; v;</span><br><span class="line">           <span class="built_in">up</span>(l, r, v, <span class="number">1</span>, n, <span class="number">1</span>);</span><br><span class="line">       }</span><br><span class="line">       <span class="type">int</span> q;</span><br><span class="line">       cin &gt;&gt; q;</span><br><span class="line">       <span class="keyword">while</span>(q --){</span><br><span class="line">           <span class="type">int</span> l, r;</span><br><span class="line">           cin &gt;&gt; l &gt;&gt; r;</span><br><span class="line">           cout &lt;&lt; <span class="built_in">query</span>(l, r, <span class="number">1</span>, n, <span class="number">1</span>) &lt;&lt; endl;</span><br><span class="line">       }</span><br><span class="line">}</span><br></pre></td></tr></table></figure>
<h5 id="èŒƒå›´ä¿®æ”¹-èŒƒå›´æŸ¥è¯¢"><a class="markdownIt-Anchor" href="#èŒƒå›´ä¿®æ”¹-èŒƒå›´æŸ¥è¯¢"></a> èŒƒå›´ä¿®æ”¹ + èŒƒå›´æŸ¥è¯¢</h5>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br></pre></td><td class="code"><pre><span class="line">#<span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line">#<span class="meta">#<span class="keyword">define</span> int long long</span></span><br><span class="line">#<span class="meta">#<span class="keyword">define</span> endl <span class="string">'\n'</span></span></span><br><span class="line">#<span class="meta">#<span class="keyword">define</span> PII pair<span class="string">&lt;int,int&gt;</span></span></span><br><span class="line">#<span class="meta">#<span class="keyword">define</span> fr first</span></span><br><span class="line">#<span class="meta">#<span class="keyword">define</span> sc second</span></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">  èŒƒå›´ä¿®æ”¹ + èŒƒå›´æŸ¥è¯¢ï¼ˆçº¿æ®µæ ‘ï¼‰</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">1e5</span> + <span class="number">10</span>;</span><br><span class="line"><span class="type">int</span> sum[<span class="number">4</span> * N]; <span class="comment">// éœ€è¦ 4 * N</span></span><br><span class="line"><span class="type">int</span> a[N];</span><br><span class="line"><span class="type">int</span> ad[<span class="number">4</span> * N]; <span class="comment">// æ‡’æ›´æ–° (è®¿é—®æ‰å¾€ä¸‹æ¨)</span></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">  ad è¡¨ç¤ºå½“å‰éœ€è¦ä¸‹å‘çš„ä¿¡æ¯ï¼Œå½“å‰èŠ‚ç‚¹å·²ç»ä¿®æ­£</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="comment">// O(n)</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">build</span><span class="params">(<span class="type">int</span> l, <span class="type">int</span> r, <span class="type">int</span> i)</span></span>{</span><br><span class="line">    <span class="keyword">if</span>(l == r){</span><br><span class="line">        sum[i] = a[r];</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    }</span><br><span class="line">    <span class="type">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span>; <span class="comment">// æœ€åä¸€å®šä¼šè¾¾åˆ°ç›¸ç­‰ï¼Œä¸ä¼šå‡ºç°è¶Šç•Œæƒ…å†µ</span></span><br><span class="line">    <span class="built_in">build</span>(l, mid, i &lt;&lt; <span class="number">1</span>);</span><br><span class="line">    <span class="built_in">build</span>(mid + <span class="number">1</span>, r, i &lt;&lt; <span class="number">1</span> | <span class="number">1</span>);</span><br><span class="line">    sum[i] = sum[i &lt;&lt; <span class="number">1</span>] + sum[i &lt;&lt; <span class="number">1</span> | <span class="number">1</span>];</span><br><span class="line">    ad[i] = <span class="number">0</span>;</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ‡’ä¿¡æ¯ä¸‹å‘</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">down</span><span class="params">(<span class="type">int</span> i, <span class="type">int</span> ln, <span class="type">int</span> rn)</span></span>{</span><br><span class="line">    <span class="keyword">if</span>(ad[i] != <span class="number">0</span>){</span><br><span class="line">        sum[i &lt;&lt; <span class="number">1</span>] += ln * ad[i];</span><br><span class="line">        ad[i &lt;&lt; <span class="number">1</span>] += ad[i];</span><br><span class="line">        sum[i &lt;&lt; <span class="number">1</span> | <span class="number">1</span>] += rn * ad[i];</span><br><span class="line">        ad[i &lt;&lt; <span class="number">1</span> | <span class="number">1</span>] += ad[i];</span><br><span class="line">        ad[i] = <span class="number">0</span>;</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// O(nlog(n)) èŒƒå›´æŸ¥è¯¢</span></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">query</span><span class="params">(<span class="type">int</span> wol, <span class="type">int</span> wor, <span class="type">int</span> l, <span class="type">int</span> r, <span class="type">int</span> i)</span></span>{</span><br><span class="line">    <span class="keyword">if</span>(l &gt;= wol &amp;&amp; r &lt;= wor){</span><br><span class="line">       <span class="keyword">return</span> sum[i];    </span><br><span class="line">    }</span><br><span class="line">    <span class="type">int</span> ans = <span class="number">0</span>;</span><br><span class="line">    <span class="type">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">    <span class="built_in">down</span>(i, mid - l + <span class="number">1</span>, r - mid);</span><br><span class="line">    <span class="keyword">if</span>(mid &gt;=wol){</span><br><span class="line">        ans += <span class="built_in">query</span>(wol, wor, l, mid, i &lt;&lt; <span class="number">1</span>);</span><br><span class="line">    }</span><br><span class="line">    <span class="keyword">if</span>(mid + <span class="number">1</span>&lt;= wor){</span><br><span class="line">        ans += <span class="built_in">query</span>(wol, wor, mid + <span class="number">1</span>, r, i &lt;&lt; <span class="number">1</span> | <span class="number">1</span>);</span><br><span class="line">    }</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="comment">// èŒƒå›´iå¢åŠ </span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">add</span><span class="params">(<span class="type">int</span> wol, <span class="type">int</span> wor, <span class="type">int</span> wov, <span class="type">int</span> l, <span class="type">int</span> r, <span class="type">int</span> i)</span></span>{</span><br><span class="line">       <span class="keyword">if</span>(wol &lt;=  l &amp;&amp; r &lt;= wor){</span><br><span class="line">           ad[i] += wov; <span class="comment">// å¾€ä¸‹ä¼ é€’</span></span><br><span class="line">           sum[i] += wov*(r - l + <span class="number">1</span>); </span><br><span class="line">           <span class="keyword">return</span>;</span><br><span class="line">       }</span><br><span class="line">       <span class="type">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">       <span class="built_in">down</span>(i, mid - l + <span class="number">1</span>, r - mid);</span><br><span class="line">       <span class="keyword">if</span>(wol &lt;= mid){</span><br><span class="line">           <span class="built_in">add</span>(wol, wor, wov, l, mid, i &lt;&lt; <span class="number">1</span>);</span><br><span class="line">       }</span><br><span class="line">       <span class="keyword">if</span>(wor &gt;= mid + <span class="number">1</span>){</span><br><span class="line">           <span class="built_in">add</span>(wol, wor, wov, mid + <span class="number">1</span>, r, i &lt;&lt; <span class="number">1</span> | <span class="number">1</span>);</span><br><span class="line">       }</span><br><span class="line">       sum[i] = sum[i &lt;&lt; <span class="number">1</span>] + sum[i &lt;&lt; <span class="number">1</span> | <span class="number">1</span>];</span><br><span class="line">}</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span></span>{</span><br><span class="line">       <span class="type">int</span> n;</span><br><span class="line">       cin &gt;&gt; n;</span><br><span class="line">       <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++) cin &gt;&gt; a[i];</span><br><span class="line">       <span class="built_in">build</span>(<span class="number">1</span>, n, <span class="number">1</span>);</span><br><span class="line">       <span class="type">int</span> q1;</span><br><span class="line">       cin &gt;&gt; q1;</span><br><span class="line">       <span class="keyword">while</span>(q1--){</span><br><span class="line">           <span class="type">int</span> l, r, v;</span><br><span class="line">           cin &gt;&gt; l &gt;&gt; r &gt;&gt; v;</span><br><span class="line">           <span class="built_in">add</span>(l, r, v, <span class="number">1</span>, n, <span class="number">1</span>);</span><br><span class="line">       }</span><br><span class="line">       <span class="type">int</span> q;</span><br><span class="line">       cin &gt;&gt; q;</span><br><span class="line">       <span class="keyword">while</span>(q --){</span><br><span class="line">           <span class="type">int</span> l, r;</span><br><span class="line">           cin &gt;&gt; l &gt;&gt; r;</span><br><span class="line">           cout &lt;&lt; <span class="built_in">query</span>(l, r, <span class="number">1</span>, n, <span class="number">1</span>) &lt;&lt; endl;</span><br><span class="line">       }</span><br><span class="line">}</span><br></pre></td></tr></table></figure>
<h5 id="çº¿æ®µæ ‘çš„åŠ¿èƒ½åˆ†æ"><a class="markdownIt-Anchor" href="#çº¿æ®µæ ‘çš„åŠ¿èƒ½åˆ†æ"></a> çº¿æ®µæ ‘çš„åŠ¿èƒ½åˆ†æ</h5>
<h5 id="çº¿æ®µæ ‘åŒºé—´åˆå¹¶"><a class="markdownIt-Anchor" href="#çº¿æ®µæ ‘åŒºé—´åˆå¹¶"></a> çº¿æ®µæ ‘åŒºé—´åˆå¹¶</h5>
<blockquote>
<p>å¤„ç† å­ä¸² å­æ•°ç»„(ç›¸äº’è¿æ¥) çš„ä¿¡æ¯</p>
</blockquote>
<ul>
<li><a target="_blank" rel="noopener" href="https://www.luogu.com.cn/problem/P2572">åºåˆ—æ“ä½œ</a></li>
</ul>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br></pre></td><td class="code"><pre><span class="line">#<span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line">#<span class="meta">#<span class="keyword">define</span> int long long </span></span><br><span class="line">#<span class="meta">#<span class="keyword">define</span> fr first</span></span><br><span class="line">#<span class="meta">#<span class="keyword">define</span> sc second</span></span><br><span class="line"><span class="keyword">using</span> PII = pair&lt;<span class="type">int</span>, <span class="type">int</span>&gt;;</span><br><span class="line"></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">1e5</span>;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> a[N];</span><br><span class="line"><span class="type">int</span> sum[N &lt;&lt; <span class="number">2</span>];</span><br><span class="line"><span class="type">int</span> tree0[N &lt;&lt; <span class="number">2</span>];</span><br><span class="line"><span class="type">int</span> pre0[N &lt;&lt; <span class="number">2</span>];</span><br><span class="line"><span class="type">int</span> la0[N &lt;&lt; <span class="number">2</span>];</span><br><span class="line"><span class="type">int</span> tree1[N &lt;&lt; <span class="number">2</span>];</span><br><span class="line"><span class="type">int</span> pre1[N &lt;&lt; <span class="number">2</span>];</span><br><span class="line"><span class="type">int</span> la1[N &lt;&lt; <span class="number">2</span>];</span><br><span class="line"><span class="type">bool</span> update[N &lt;&lt; <span class="number">2</span>];</span><br><span class="line"><span class="type">int</span> up_data[N &lt;&lt; <span class="number">2</span>];</span><br><span class="line"><span class="type">bool</span> reversed[N &lt;&lt; <span class="number">2</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">up</span><span class="params">(<span class="type">int</span> i, <span class="type">int</span> ln, <span class="type">int</span> rn)</span> </span>{</span><br><span class="line">    pre0[i] = (pre0[i &lt;&lt; <span class="number">1</span>] == ln) ? (pre0[i &lt;&lt; <span class="number">1</span>] + pre0[i &lt;&lt; <span class="number">1</span> | <span class="number">1</span>]) : pre0[i &lt;&lt; <span class="number">1</span>];</span><br><span class="line">    pre1[i] = (pre1[i &lt;&lt; <span class="number">1</span>] == ln) ? (pre1[i &lt;&lt; <span class="number">1</span>] + pre1[i &lt;&lt; <span class="number">1</span> | <span class="number">1</span>]) : pre1[i &lt;&lt; <span class="number">1</span>];</span><br><span class="line">    la0[i] = (pre0[i &lt;&lt; <span class="number">1</span> | <span class="number">1</span>] == rn) ? (la0[i &lt;&lt; <span class="number">1</span>] + pre0[i &lt;&lt; <span class="number">1</span> | <span class="number">1</span>]) : la0[i &lt;&lt; <span class="number">1</span> | <span class="number">1</span>];</span><br><span class="line">    la1[i] = (pre1[i &lt;&lt; <span class="number">1</span> | <span class="number">1</span>] == rn) ? (la1[i &lt;&lt; <span class="number">1</span>] + pre1[i &lt;&lt; <span class="number">1</span> | <span class="number">1</span>]) : la1[i &lt;&lt; <span class="number">1</span> | <span class="number">1</span>];</span><br><span class="line">    tree0[i] = <span class="built_in">max</span>({tree0[i &lt;&lt; <span class="number">1</span>], tree0[i &lt;&lt; <span class="number">1</span> | <span class="number">1</span>], la0[i &lt;&lt; <span class="number">1</span>] + pre0[i &lt;&lt; <span class="number">1</span> | <span class="number">1</span>]});</span><br><span class="line">    tree1[i] = <span class="built_in">max</span>({tree1[i &lt;&lt; <span class="number">1</span>], tree1[i &lt;&lt; <span class="number">1</span> | <span class="number">1</span>], la1[i &lt;&lt; <span class="number">1</span>] + pre1[i &lt;&lt; <span class="number">1</span> | <span class="number">1</span>]});</span><br><span class="line">    sum[i] = sum[i &lt;&lt; <span class="number">1</span>] + sum[i &lt;&lt; <span class="number">1</span> | <span class="number">1</span>];</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">build</span><span class="params">(<span class="type">int</span> l, <span class="type">int</span> r, <span class="type">int</span> i)</span> </span>{</span><br><span class="line">    reversed[i] = <span class="literal">false</span>;</span><br><span class="line">    update[i] = <span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">if</span> (l == r) {</span><br><span class="line">        tree0[i] = (a[r] == <span class="number">0</span>) ? <span class="number">1</span> : <span class="number">0</span>;</span><br><span class="line">        tree1[i] = (a[r] == <span class="number">1</span>) ? <span class="number">1</span> : <span class="number">0</span>;</span><br><span class="line">        sum[i] = a[r];</span><br><span class="line">        la0[i] = pre0[i] = tree0[i];</span><br><span class="line">        la1[i] = pre1[i] = tree1[i];</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    }</span><br><span class="line">    <span class="type">int</span> mid = (r + l) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">    <span class="built_in">build</span>(l, mid, i &lt;&lt; <span class="number">1</span>);</span><br><span class="line">    <span class="built_in">build</span>(mid + <span class="number">1</span>, r, (i &lt;&lt; <span class="number">1</span> | <span class="number">1</span>));</span><br><span class="line">    <span class="built_in">up</span>(i, mid - l + <span class="number">1</span>, r - mid);</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">down</span><span class="params">(<span class="type">int</span> i, <span class="type">int</span> ln, <span class="type">int</span> rn)</span> </span>{</span><br><span class="line">    <span class="keyword">if</span> (update[i]) {</span><br><span class="line">        <span class="keyword">if</span> (up_data[i] == <span class="number">1</span>) {</span><br><span class="line">            pre1[i &lt;&lt; <span class="number">1</span>] = la1[i &lt;&lt; <span class="number">1</span>] = tree1[i &lt;&lt; <span class="number">1</span>] = ln;</span><br><span class="line">            pre0[i &lt;&lt; <span class="number">1</span>] = la0[i &lt;&lt; <span class="number">1</span>] = tree0[i &lt;&lt; <span class="number">1</span>] = <span class="number">0</span>;</span><br><span class="line">            pre1[i &lt;&lt; <span class="number">1</span> | <span class="number">1</span>] = la1[i &lt;&lt; <span class="number">1</span> | <span class="number">1</span>] = tree1[i &lt;&lt; <span class="number">1</span> | <span class="number">1</span>] = rn;</span><br><span class="line">            pre0[i &lt;&lt; <span class="number">1</span> | <span class="number">1</span>] = la0[i &lt;&lt; <span class="number">1</span> | <span class="number">1</span>] = tree0[i &lt;&lt; <span class="number">1</span> | <span class="number">1</span>] = <span class="number">0</span>;</span><br><span class="line">            sum[i &lt;&lt; <span class="number">1</span>] = ln;</span><br><span class="line">            sum[i &lt;&lt; <span class="number">1</span> | <span class="number">1</span>] = rn;</span><br><span class="line">            update[i] = <span class="literal">false</span>;</span><br><span class="line">            update[i &lt;&lt; <span class="number">1</span>] = update[i &lt;&lt; <span class="number">1</span> | <span class="number">1</span>] = <span class="literal">true</span>;</span><br><span class="line">            up_data[i &lt;&lt; <span class="number">1</span>] = up_data[i &lt;&lt; <span class="number">1</span> | <span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">        } <span class="keyword">else</span> {</span><br><span class="line">            pre0[i &lt;&lt; <span class="number">1</span>] = la0[i &lt;&lt; <span class="number">1</span>] = tree0[i &lt;&lt; <span class="number">1</span>] = ln;</span><br><span class="line">            pre1[i &lt;&lt; <span class="number">1</span>] = la1[i &lt;&lt; <span class="number">1</span>] = tree1[i &lt;&lt; <span class="number">1</span>] = <span class="number">0</span>;</span><br><span class="line">            pre0[i &lt;&lt; <span class="number">1</span> | <span class="number">1</span>] = la0[i &lt;&lt; <span class="number">1</span> | <span class="number">1</span>] = tree0[i &lt;&lt; <span class="number">1</span> | <span class="number">1</span>] = rn;</span><br><span class="line">            pre1[i &lt;&lt; <span class="number">1</span> | <span class="number">1</span>] = la1[i &lt;&lt; <span class="number">1</span> | <span class="number">1</span>] = tree1[i &lt;&lt; <span class="number">1</span> | <span class="number">1</span>] = <span class="number">0</span>;</span><br><span class="line">            sum[i &lt;&lt; <span class="number">1</span>] = <span class="number">0</span>;</span><br><span class="line">            sum[i &lt;&lt; <span class="number">1</span> | <span class="number">1</span>] = <span class="number">0</span>;</span><br><span class="line">            update[i] = <span class="literal">false</span>;</span><br><span class="line">            update[i &lt;&lt; <span class="number">1</span>] = update[i &lt;&lt; <span class="number">1</span> | <span class="number">1</span>] = <span class="literal">true</span>;</span><br><span class="line">            up_data[i &lt;&lt; <span class="number">1</span>] = up_data[i &lt;&lt; <span class="number">1</span> | <span class="number">1</span>] = <span class="number">0</span>;</span><br><span class="line">        }</span><br><span class="line">        reversed[i &lt;&lt; <span class="number">1</span>] = reversed[i &lt;&lt; <span class="number">1</span> | <span class="number">1</span>] = <span class="literal">false</span>;</span><br><span class="line">    }</span><br><span class="line">    <span class="keyword">if</span> (reversed[i]) {</span><br><span class="line">        <span class="built_in">swap</span>(pre1[i &lt;&lt; <span class="number">1</span>], pre0[i &lt;&lt; <span class="number">1</span>]);</span><br><span class="line">        <span class="built_in">swap</span>(la1[i &lt;&lt; <span class="number">1</span>], la0[i &lt;&lt; <span class="number">1</span>]);</span><br><span class="line">        <span class="built_in">swap</span>(tree0[i &lt;&lt; <span class="number">1</span>], tree1[i &lt;&lt; <span class="number">1</span>]);</span><br><span class="line">        <span class="built_in">swap</span>(pre1[i &lt;&lt; <span class="number">1</span> | <span class="number">1</span>], pre0[i &lt;&lt; <span class="number">1</span> | <span class="number">1</span>]);</span><br><span class="line">        <span class="built_in">swap</span>(la1[i &lt;&lt; <span class="number">1</span> | <span class="number">1</span>], la0[i &lt;&lt; <span class="number">1</span> | <span class="number">1</span>]);</span><br><span class="line">        <span class="built_in">swap</span>(tree0[i &lt;&lt; <span class="number">1</span> | <span class="number">1</span>], tree1[i &lt;&lt; <span class="number">1</span> | <span class="number">1</span>]);</span><br><span class="line">        sum[i &lt;&lt; <span class="number">1</span>] = ln - sum[i &lt;&lt; <span class="number">1</span>];</span><br><span class="line">        sum[i &lt;&lt; <span class="number">1</span> | <span class="number">1</span>] = rn - sum[i &lt;&lt; <span class="number">1</span> | <span class="number">1</span>];</span><br><span class="line">        reversed[i &lt;&lt; <span class="number">1</span>] = !reversed[i &lt;&lt; <span class="number">1</span>];</span><br><span class="line">        reversed[i &lt;&lt; <span class="number">1</span> | <span class="number">1</span>] = !reversed[i &lt;&lt; <span class="number">1</span> | <span class="number">1</span>];</span><br><span class="line">        reversed[i] = <span class="literal">false</span>;</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">change</span><span class="params">(<span class="type">int</span> jobl, <span class="type">int</span> jobr, <span class="type">int</span> w, <span class="type">int</span> l, <span class="type">int</span> r, <span class="type">int</span> i)</span> </span>{</span><br><span class="line">    <span class="keyword">if</span> (jobl &lt;= l &amp;&amp; r &lt;= jobr) {</span><br><span class="line">        <span class="keyword">if</span> (w == <span class="number">0</span>) {</span><br><span class="line">            pre0[i] = la0[i] = tree0[i] = (r - l + <span class="number">1</span>);</span><br><span class="line">            sum[i] = <span class="number">0</span>;</span><br><span class="line">            pre1[i] = la1[i] = tree1[i] = <span class="number">0</span>;</span><br><span class="line">            update[i] = <span class="literal">true</span>;</span><br><span class="line">            up_data[i] = w;</span><br><span class="line">        } <span class="keyword">else</span> {</span><br><span class="line">            pre1[i] = la1[i] = tree1[i] = (r - l + <span class="number">1</span>);</span><br><span class="line">            sum[i] = (r - l + <span class="number">1</span>);</span><br><span class="line">            pre0[i] = la0[i] = tree0[i] = <span class="number">0</span>;</span><br><span class="line">            update[i] = <span class="literal">true</span>;</span><br><span class="line">            up_data[i] = w;</span><br><span class="line">        }</span><br><span class="line">        reversed[i] = <span class="literal">false</span>;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    }</span><br><span class="line">    <span class="type">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">    <span class="built_in">down</span>(i, mid - l + <span class="number">1</span>, r - mid);</span><br><span class="line">    <span class="keyword">if</span> (jobl &lt;= mid) {</span><br><span class="line">        <span class="built_in">change</span>(jobl, jobr, w, l, mid, i &lt;&lt; <span class="number">1</span>);</span><br><span class="line">    }</span><br><span class="line">    <span class="keyword">if</span> (jobr &gt;= mid + <span class="number">1</span>) {</span><br><span class="line">        <span class="built_in">change</span>(jobl, jobr, w, mid + <span class="number">1</span>, r, i &lt;&lt; <span class="number">1</span> | <span class="number">1</span>);</span><br><span class="line">    }</span><br><span class="line">    <span class="built_in">up</span>(i, mid - l + <span class="number">1</span>, r - mid);</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">query1</span><span class="params">(<span class="type">int</span> jobl, <span class="type">int</span> jobr, <span class="type">int</span> l, <span class="type">int</span> r, <span class="type">int</span> i)</span> </span>{</span><br><span class="line">    <span class="keyword">if</span> (jobl &lt;= l &amp;&amp; r &lt;= jobr) {</span><br><span class="line">        <span class="keyword">return</span> sum[i];</span><br><span class="line">    }</span><br><span class="line">    <span class="type">int</span> ans = <span class="number">0</span>;</span><br><span class="line">    <span class="type">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">    <span class="built_in">down</span>(i, mid - l + <span class="number">1</span>, r - mid);</span><br><span class="line">    <span class="keyword">if</span> (jobl &lt;= mid) {</span><br><span class="line">        ans += <span class="built_in">query1</span>(jobl, jobr, l, mid, i &lt;&lt; <span class="number">1</span>);</span><br><span class="line">    }</span><br><span class="line">    <span class="keyword">if</span> (jobr &gt;= mid + <span class="number">1</span>) {</span><br><span class="line">        ans += <span class="built_in">query1</span>(jobl, jobr, mid + <span class="number">1</span>, r, i &lt;&lt; <span class="number">1</span> | <span class="number">1</span>);</span><br><span class="line">    }</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">}</span><br><span class="line"><span class="comment">//  è¿”å› [l, r] èŒƒå›´ä¸Š è¢« [jobl, jobr] å½±å“çš„åŒºåŸŸ çš„ ä¿¡æ¯</span></span><br><span class="line"><span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">query2</span><span class="params">(<span class="type">int</span> jobl, <span class="type">int</span> jobr, <span class="type">int</span> l, <span class="type">int</span> r, <span class="type">int</span> i)</span> </span>{</span><br><span class="line">    <span class="keyword">if</span> (jobl &lt;= l &amp;&amp; r &lt;= jobr) {</span><br><span class="line">        <span class="keyword">return</span> {tree1[i], pre1[i], la1[i]};</span><br><span class="line">    }</span><br><span class="line">    <span class="type">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">    <span class="built_in">down</span>(i, mid - l + <span class="number">1</span>, r - mid);</span><br><span class="line">    vector&lt;<span class="type">int</span>&gt; a1 = {<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>};</span><br><span class="line">    vector&lt;<span class="type">int</span>&gt; a2 = {<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>};</span><br><span class="line">    <span class="keyword">if</span> (jobl &lt;= mid) {</span><br><span class="line">        a1 = <span class="built_in">query2</span>(jobl, jobr, l, mid, i &lt;&lt; <span class="number">1</span>);</span><br><span class="line">    }</span><br><span class="line">    <span class="keyword">if</span> (jobr &gt;= mid + <span class="number">1</span>) {</span><br><span class="line">        a2 = <span class="built_in">query2</span>(jobl, jobr, mid + <span class="number">1</span>, r, i &lt;&lt; <span class="number">1</span> | <span class="number">1</span>);</span><br><span class="line">    }</span><br><span class="line">    <span class="type">int</span> max_len = <span class="built_in">max</span>(a1[<span class="number">0</span>], a2[<span class="number">0</span>]);</span><br><span class="line">    <span class="keyword">if</span> (jobl &lt;= mid &amp;&amp; jobr &gt;= mid + <span class="number">1</span>) {</span><br><span class="line">        max_len = <span class="built_in">max</span>(max_len, a1[<span class="number">2</span>] + a2[<span class="number">1</span>]);</span><br><span class="line">    }</span><br><span class="line">    <span class="type">int</span> prefix_len = (jobl &lt;= l) ? a1[<span class="number">1</span>] : <span class="number">0</span>;</span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">      [l, r]</span></span><br><span class="line"><span class="comment">      [jobl,jobr]</span></span><br><span class="line"><span class="comment">      è¿”å› [l, r] èŒƒå›´ä¸Š è¢« [jobl, jobr] å½±å“çš„åŒºåŸŸ çš„ ä¿¡æ¯</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">    <span class="keyword">if</span> (jobl &lt;= l &amp;&amp; a1[<span class="number">1</span>] == (mid - l + <span class="number">1</span>) &amp;&amp; jobr &gt;= mid + <span class="number">1</span>) {</span><br><span class="line">        prefix_len += a2[<span class="number">1</span>];</span><br><span class="line">    }</span><br><span class="line">    <span class="type">int</span> suffix_len = (jobr &gt;= r) ? a2[<span class="number">2</span>] : <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">if</span> (jobr &gt;= r &amp;&amp; a2[<span class="number">1</span>] == (r - mid) &amp;&amp; jobl &lt;= mid) {</span><br><span class="line">        suffix_len += a1[<span class="number">2</span>];</span><br><span class="line">    }</span><br><span class="line">    <span class="keyword">return</span> {max_len, prefix_len, suffix_len};</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">reverse</span><span class="params">(<span class="type">int</span> jobl, <span class="type">int</span> jobr, <span class="type">int</span> l, <span class="type">int</span> r, <span class="type">int</span> i)</span> </span>{</span><br><span class="line">    <span class="keyword">if</span> (jobl &lt;= l &amp;&amp; r &lt;= jobr) {</span><br><span class="line">        reversed[i] = !reversed[i];</span><br><span class="line">        <span class="built_in">swap</span>(pre1[i], pre0[i]);</span><br><span class="line">        <span class="built_in">swap</span>(la1[i], la0[i]);</span><br><span class="line">        <span class="built_in">swap</span>(tree0[i], tree1[i]);</span><br><span class="line">        sum[i] = (r - l + <span class="number">1</span>) - sum[i];</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    }</span><br><span class="line">    <span class="type">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">    <span class="built_in">down</span>(i, mid - l + <span class="number">1</span>, r - mid);</span><br><span class="line">    <span class="keyword">if</span> (jobl &lt;= mid) {</span><br><span class="line">        <span class="built_in">reverse</span>(jobl, jobr, l, mid, i &lt;&lt; <span class="number">1</span>);</span><br><span class="line">    }</span><br><span class="line">    <span class="keyword">if</span> (jobr &gt;= mid + <span class="number">1</span>) {</span><br><span class="line">        <span class="built_in">reverse</span>(jobl, jobr, mid + <span class="number">1</span>, r, i &lt;&lt; <span class="number">1</span> | <span class="number">1</span>);</span><br><span class="line">    }</span><br><span class="line">    <span class="built_in">up</span>(i, mid - l + <span class="number">1</span>, r - mid);</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span> </span>{</span><br><span class="line">    <span class="type">int</span> n, m;</span><br><span class="line">    cin &gt;&gt; n &gt;&gt; m;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++) cin &gt;&gt; a[i];</span><br><span class="line">    <span class="built_in">build</span>(<span class="number">1</span>, n, <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">while</span> (m--) {</span><br><span class="line">        <span class="type">int</span> pos, l, r;</span><br><span class="line">        cin &gt;&gt; pos &gt;&gt; l &gt;&gt; r;</span><br><span class="line">        l++; r++;</span><br><span class="line">        <span class="keyword">if</span> (pos == <span class="number">0</span>) {</span><br><span class="line">            <span class="built_in">change</span>(l, r, <span class="number">0</span>, <span class="number">1</span>, n, <span class="number">1</span>);</span><br><span class="line">        } <span class="keyword">else</span> <span class="keyword">if</span> (pos == <span class="number">1</span>) {</span><br><span class="line">            <span class="built_in">change</span>(l, r, <span class="number">1</span>, <span class="number">1</span>, n, <span class="number">1</span>);</span><br><span class="line">        } <span class="keyword">else</span> <span class="keyword">if</span> (pos == <span class="number">2</span>) {</span><br><span class="line">            <span class="built_in">reverse</span>(l, r, <span class="number">1</span>, n, <span class="number">1</span>);</span><br><span class="line">        } <span class="keyword">else</span> <span class="keyword">if</span> (pos == <span class="number">3</span>) {</span><br><span class="line">            cout &lt;&lt; <span class="built_in">query1</span>(l, r, <span class="number">1</span>, n, <span class="number">1</span>) &lt;&lt; endl;</span><br><span class="line">        } <span class="keyword">else</span> <span class="keyword">if</span> (pos == <span class="number">4</span>) {</span><br><span class="line">            cout &lt;&lt; <span class="built_in">query2</span>(l, r, <span class="number">1</span>, n, <span class="number">1</span>)[<span class="number">0</span>] &lt;&lt; endl;</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">}</span><br></pre></td></tr></table></figure>
<h4 id="å¼€ç‚¹çº¿æ®µæ ‘"><a class="markdownIt-Anchor" href="#å¼€ç‚¹çº¿æ®µæ ‘"></a> å¼€ç‚¹çº¿æ®µæ ‘</h4>
<ol>
<li>é—®é¢˜</li>
</ol>
<ul>
<li>æ”¯æŒå¾ˆå¤§çš„èŒƒå›´ï¼Œä½†æ˜¯æŸ¥è¯¢æ¬¡æ•°å°‘ï¼ŒæŸ¥è¯¢åŒºé—´å°</li>
</ul>
<blockquote>
<p>æ—¶é—´å¤æ‚åº¦ 2 * m * log(n)ï¼Œç”¨ cnt æ¥è®°å½•ç¼–å·ï¼Œçœ‹èŠ‚ç‚¹åˆ†æ”¯æ˜¯å¦è®¿é—®è¿‡ã€‚</p>
</blockquote>
<h4 id="çº¿æ®µæ ‘å†å²æœ€å€¼æ“ä½œ"><a class="markdownIt-Anchor" href="#çº¿æ®µæ ‘å†å²æœ€å€¼æ“ä½œ"></a> çº¿æ®µæ ‘å†å²æœ€å€¼æ“ä½œ</h4>
<blockquote>
<p>æ ‡ç­¾å›æ”¶ â†’Â è¿›è¡Œå‰ªæ</p>
</blockquote>
<h3 id="ç¬›å¡å°”æ ‘"><a class="markdownIt-Anchor" href="#ç¬›å¡å°”æ ‘"></a> ç¬›å¡å°”æ ‘</h3>
<h3 id="å€å¢ç®—æ³•-stè¡¨"><a class="markdownIt-Anchor" href="#å€å¢ç®—æ³•-stè¡¨"></a> å€å¢ç®—æ³• + STè¡¨</h3>
<p>å€å¢ç®—æ³•å…¶å®æ˜¯å¸¸ç”¨æ¥æ ‘ä¸Šå‘ä¸Šè·³è½¬çš„,å› ä¸ºæ¯ä¸€ä¸ªèŠ‚ç‚¹çš„çˆ¶äº²èŠ‚ç‚¹æ˜¯å”¯ä¸€çš„<br>
STè¡¨<br>
æ ¸å¿ƒå…¬å¼:</p>
<p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>S</mi><mi>T</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mi>j</mi><mo stretchy="false">]</mo><mo>=</mo><mi>S</mi><mi>T</mi><mo stretchy="false">[</mo><mi>S</mi><mi>T</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mi>j</mi><mo>âˆ’</mo><mn>1</mn><mo stretchy="false">]</mo><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mi>j</mi><mo>âˆ’</mo><mn>1</mn><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">ST[i][j] = ST[ST[i][j - 1]][j - 1]
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="mopen">[</span><span class="mord mathdefault">i</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord mathdefault" style="margin-right:0.05724em;">j</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="mopen">[</span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="mopen">[</span><span class="mord mathdefault">i</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord mathdefault" style="margin-right:0.05724em;">j</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">]</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord mathdefault" style="margin-right:0.05724em;">j</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">]</span></span></span></span></span></p>
<p>è¡¨ç¤º i èŠ‚ç‚¹å‘ä¸Šèµ° <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mn>2</mn><mi>j</mi></msup></mrow><annotation encoding="application/x-tex">2^j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.824664em;vertical-align:0em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.824664em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span></span></span></span></span></span></span></span></span></span></span> æ¬¡æ–¹æ­¥çš„ä½ç½®</p>
<p>å€å¢ç®—æ³•å…¶å®è®²ç©¶çš„æ˜¯é€¼è¿‘: é€¼è¿‘æŸä¸€ä¸ªç›®æ ‡,ç„¶ååœ¨å‘å‰èµ°ST[x][0]å°±æ˜¯ç›®æ ‡èŒƒå›´<br>
<a target="_blank" rel="noopener" href="https://ac.nowcoder.com/acm/contest/108300/H">ç‰›å®¢å¤šæ ¡3-H</a><br>
è¿™é“é¢˜ç›®å°±å¾ˆå¥½çš„æè¿°æ¥é€¼è¿‘è¿™ç§æ•ˆæœ.</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> int long long </span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> fr first</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> sc second</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> endl <span class="string">'\n'</span></span></span><br><span class="line"><span class="keyword">using</span> PII = pair&lt;<span class="type">int</span>,<span class="type">int</span>&gt;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span></span>{</span><br><span class="line">    ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);</span><br><span class="line">    cin.<span class="built_in">tie</span>(<span class="number">0</span>);</span><br><span class="line">    <span class="type">int</span> n, k;</span><br><span class="line">    cin &gt;&gt; n &gt;&gt; k;</span><br><span class="line">    <span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">fath</span><span class="params">(n + <span class="number">1</span>, <span class="number">0</span>)</span></span>;</span><br><span class="line">    vector&lt;vector&lt;<span class="type">int</span>&gt;&gt; <span class="built_in">dj</span>(n + <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">2</span>; i &lt;= n; i++){</span><br><span class="line">        cin &gt;&gt; fath[i];</span><br><span class="line">        dj[fath[i]].<span class="built_in">push_back</span>(i);</span><br><span class="line">    }</span><br><span class="line">    vector&lt;array&lt;<span class="type">int</span>,3&gt;&gt; <span class="built_in">t</span>(k);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; k; i++){</span><br><span class="line">        cin &gt;&gt; t[i][<span class="number">2</span>] &gt;&gt; t[i][<span class="number">0</span>] &gt;&gt; t[i][<span class="number">1</span>];</span><br><span class="line">    }</span><br><span class="line">    <span class="function">vector&lt;<span class="type">bool</span>&gt; <span class="title">vis</span><span class="params">(n + <span class="number">1</span>, <span class="number">0</span>)</span></span>;</span><br><span class="line">    vis[<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">    <span class="type">int</span> h = <span class="number">30</span>;</span><br><span class="line">    <span class="comment">// cout &lt;&lt; "h:" &lt;&lt; h &lt;&lt; endl; </span></span><br><span class="line">    <span class="function">vector <span class="title">st</span><span class="params">(n + <span class="number">1</span>, vector&lt;<span class="type">int</span>&gt;(h + <span class="number">1</span>, <span class="number">0</span>))</span></span>;</span><br><span class="line">    <span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">deep</span><span class="params">(n + <span class="number">1</span>, <span class="number">0</span>)</span></span>;</span><br><span class="line">    <span class="keyword">auto</span> dfs = [&amp;](<span class="keyword">auto</span> ff, <span class="type">int</span> u, <span class="type">int</span> f) -&gt; <span class="type">void</span>{</span><br><span class="line">        deep[u] = deep[f] + <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">auto</span> x : dj[u]){</span><br><span class="line">            <span class="built_in">ff</span>(ff, x, u);   </span><br><span class="line">        }</span><br><span class="line">    };</span><br><span class="line">    <span class="built_in">dfs</span>(dfs, <span class="number">1</span>, <span class="number">0</span>);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++){</span><br><span class="line">        st[i][<span class="number">0</span>] =  fath[i];</span><br><span class="line">    }</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++){</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> j = <span class="number">1</span>; j &lt;= h; j++){</span><br><span class="line">            st[i][j] = st[st[i][j - <span class="number">1</span>]][j - <span class="number">1</span>];</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line">    <span class="keyword">auto</span> get = [&amp;](<span class="type">int</span> x) -&gt; <span class="type">int</span>{</span><br><span class="line">        <span class="type">int</span> p = x;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i = h; i &gt;= <span class="number">0</span>; i--){</span><br><span class="line">            <span class="keyword">if</span>(!st[p][i]) <span class="keyword">continue</span>;</span><br><span class="line">            <span class="keyword">if</span>(!vis[st[p][i]]) p = st[p][i];            </span><br><span class="line">        }</span><br><span class="line">        <span class="keyword">return</span> st[p][<span class="number">0</span>];</span><br><span class="line">    };</span><br><span class="line">    <span class="keyword">auto</span> start = [&amp;](<span class="type">int</span> x, <span class="type">int</span> f, <span class="type">int</span> l, <span class="type">int</span> r) -&gt; <span class="type">void</span>{</span><br><span class="line">        <span class="type">int</span> p = x;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i = h; i &gt;= <span class="number">0</span>; i--){</span><br><span class="line">            <span class="keyword">if</span>(!st[p][i]) <span class="keyword">continue</span>; </span><br><span class="line">            <span class="keyword">if</span>(deep[st[p][i]] - deep[f] &gt; r - l + <span class="number">1</span>) x = st[p][i];</span><br><span class="line">        }</span><br><span class="line">        <span class="type">int</span> tt = st[p][<span class="number">0</span>];</span><br><span class="line">        <span class="keyword">while</span>(tt != f &amp;&amp; !vis[tt]){</span><br><span class="line">            vis[tt] = <span class="number">1</span>;</span><br><span class="line">            tt = st[tt][<span class="number">0</span>];</span><br><span class="line">        }</span><br><span class="line">    };</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; k; i++){</span><br><span class="line">        <span class="keyword">auto</span> x = t[i];</span><br><span class="line">        <span class="keyword">if</span>(vis[x[<span class="number">2</span>]]){</span><br><span class="line">            cout &lt;&lt; x[<span class="number">0</span>] &lt;&lt; endl;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        }</span><br><span class="line">        <span class="type">int</span> len = (x[<span class="number">1</span>] - x[<span class="number">0</span>] + <span class="number">1</span>);</span><br><span class="line">        <span class="type">int</span> p1 = <span class="built_in">get</span>(x[<span class="number">2</span>]);</span><br><span class="line">        <span class="comment">// cout &lt;&lt; "p1:" &lt;&lt; p1 &lt;&lt;  "\n";</span></span><br><span class="line">        <span class="type">int</span> h = deep[x[<span class="number">2</span>]] - deep[p1];</span><br><span class="line">        <span class="keyword">if</span>(h &lt;= len){</span><br><span class="line">            cout &lt;&lt; x[<span class="number">0</span>] + h - <span class="number">1</span> &lt;&lt; endl;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        }</span><br><span class="line">        <span class="built_in">start</span>(x[<span class="number">2</span>], p1, x[<span class="number">0</span>], x[<span class="number">1</span>]);</span><br><span class="line">    }   </span><br><span class="line">    cout &lt;&lt; <span class="number">-1</span> &lt;&lt; <span class="string">"\n"</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>; </span><br><span class="line">}</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h2 id="å›¾è®º"><a class="markdownIt-Anchor" href="#å›¾è®º"></a> å›¾è®º</h2>
<h3 id="æœ€çŸ­è·¯é—®é¢˜"><a class="markdownIt-Anchor" href="#æœ€çŸ­è·¯é—®é¢˜"></a> æœ€çŸ­è·¯é—®é¢˜</h3>
<blockquote>
<p>é‡è§è¿‡å¾ˆå¤š æœ€çŸ­è·¯ é—®é¢˜ï¼Œé¢˜ç›®çš„æ„æ€ä¸€èˆ¬éƒ½æŒ‡å‘æ˜ç¡®ï¼Œå°±æ˜¯(i <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>â†’</mo></mrow><annotation encoding="application/x-tex">\rightarrow</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.36687em;vertical-align:0em;"></span><span class="mrel">â†’</span></span></span></span> j)çš„è·¯å¾„æœ€å°ã€‚</p>
</blockquote>
<blockquote>
<p>[!NOTE]<br>
ä½†æ˜¯ä¸€èˆ¬éƒ½æ˜¯ <strong>æœ€çŸ­è·¯çš„æ‰©å±•</strong>ï¼Œ exï¼šåˆ°è¾¾ç»ˆç‚¹æ—¶å€™éœ€è¦æ»¡è¶³ä»€ä¹ˆæ ·çš„çŠ¶æ€</p>
</blockquote>
<p>é¢˜ç›®é“¾æ¥ï¼š</p>
<ul>
<li>
<p><a target="_blank" rel="noopener" href="https://acm.hdu.edu.cn/contest/problem?cid=1159&amp;pid=1006">æ‰©å±•è¿·å®«é—®é¢˜</a></p>
<blockquote>
<p>ä¸ªäººè®¤ä¸ºè¿™é“é¢˜éå¸¸çš„å…¸ï¼Œé¢˜ä¸­è¿˜åº”ç”¨äº†ä¸€ç±» <strong>è‡ªå®šä¹‰ç‚¹</strong>ï¼Œæ¥ç®¡ç†ç›¸åŒç±»åˆ«çš„ç‚¹ä¹‹é—´çš„è·³è½¬ã€‚</p>
</blockquote>
</li>
</ul>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line">#<span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line">#<span class="meta">#<span class="keyword">define</span> int long long</span></span><br><span class="line">#<span class="meta">#<span class="keyword">define</span> fr first</span></span><br><span class="line">#<span class="meta">#<span class="keyword">define</span> sc second</span></span><br><span class="line">#<span class="meta">#<span class="keyword">define</span> endl <span class="string">'\n'</span></span></span><br><span class="line"><span class="keyword">using</span> PII = pair&lt;<span class="type">int</span>,<span class="type">int</span>&gt;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">slove</span><span class="params">()</span></span>{</span><br><span class="line"><span class="type">int</span> n, m, x;</span><br><span class="line">cin &gt;&gt; n &gt;&gt; m &gt;&gt; x;</span><br><span class="line"><span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">a</span><span class="params">(n + <span class="number">1</span>, <span class="number">0</span>)</span></span>;</span><br><span class="line">vector&lt;array&lt;<span class="type">int</span>, 3&gt;&gt; g[<span class="number">2</span> * n + <span class="number">1</span>];</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++) cin &gt;&gt; a[i];</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++){</span><br><span class="line">    g[a[i] + n].<span class="built_in">push_back</span>({i,<span class="number">0</span>,<span class="number">0</span>});</span><br><span class="line">    g[i].<span class="built_in">push_back</span>({a[i] + n, x, <span class="number">1</span> });</span><br><span class="line">}</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; m; i++){</span><br><span class="line">    <span class="type">int</span> u, v, w;</span><br><span class="line">    cin &gt;&gt; u &gt;&gt; v &gt;&gt; w;</span><br><span class="line">    g[u].<span class="built_in">push_back</span>({v,w,<span class="number">1</span>});</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line">priority_queue&lt; array&lt;<span class="type">int</span>,3&gt;, vector&lt;array&lt;<span class="type">int</span>,3&gt;&gt;, greater&lt;array&lt;<span class="type">int</span>,3&gt;&gt;&gt; q;</span><br><span class="line">q.<span class="built_in">push</span>({<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>});</span><br><span class="line">vector&lt;vector&lt;<span class="type">int</span>&gt;&gt; <span class="built_in">dist</span>(<span class="number">2</span> * n + <span class="number">1</span>, <span class="built_in">vector</span>&lt;<span class="type">int</span>&gt;(<span class="number">3</span>, INT_MAX));</span><br><span class="line">vector&lt;vector&lt;<span class="type">bool</span>&gt;&gt; <span class="built_in">vis</span>(<span class="number">2</span> * n + <span class="number">1</span>,<span class="built_in">vector</span>&lt;<span class="type">bool</span>&gt;(<span class="number">3</span>,<span class="literal">false</span>));</span><br><span class="line">dist[<span class="number">1</span>][<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">while</span>(!q.<span class="built_in">empty</span>()){</span><br><span class="line">    <span class="keyword">auto</span> temp = q.<span class="built_in">top</span>();</span><br><span class="line">    q.<span class="built_in">pop</span>();</span><br><span class="line">    <span class="type">int</span> v = temp[<span class="number">1</span>],step = temp[<span class="number">2</span>];</span><br><span class="line">    <span class="keyword">if</span>(vis[v][step]) <span class="keyword">continue</span>;</span><br><span class="line">    <span class="comment">// cout &lt;&lt; v &lt;&lt; " " &lt;&lt; w &lt;&lt; endl;</span></span><br><span class="line">    vis[v][step] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">auto</span>[u, w, l] : g[v]){</span><br><span class="line">    <span class="comment">// cout &lt;&lt; u &lt;&lt; " " &lt;&lt; w &lt;&lt; endl;</span></span><br><span class="line">    <span class="type">int</span> op = (step + l) % <span class="number">3</span>;</span><br><span class="line">    <span class="keyword">if</span>(dist[u][op] &gt; dist[v][step] + w){</span><br><span class="line">        dist[u][op] = dist[v][step] + w;</span><br><span class="line">        q.<span class="built_in">push</span>({dist[u][op],u, op});}}</span><br><span class="line">    }</span><br><span class="line">    <span class="keyword">if</span>(dist[n][<span class="number">0</span>] == INT_MAX){</span><br><span class="line">    cout &lt;&lt; <span class="string">"-1"</span> &lt;&lt; endl;</span><br><span class="line">    }<span class="keyword">else</span>{</span><br><span class="line">    cout &lt;&lt; dist[n][<span class="number">0</span>] &lt;&lt; endl;</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span></span>{</span><br><span class="line">    ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);</span><br><span class="line">    cout.<span class="built_in">tie</span>(<span class="number">0</span>);</span><br><span class="line">    <span class="type">int</span> t;</span><br><span class="line">    cin &gt;&gt; t;</span><br><span class="line">    <span class="keyword">while</span>(t--) <span class="built_in">slove</span>();</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">}</span><br></pre></td></tr></table></figure>
<h3 id="æ‹“æ‰‘æ’åº"><a class="markdownIt-Anchor" href="#æ‹“æ‰‘æ’åº"></a> æ‹“æ‰‘æ’åº</h3>
<blockquote>
<p>é€‚ç”¨äºé‚£äº› èŠ‚ç‚¹çŠ¶æ€æœ‰å…ˆåæ€§çš„é—®é¢˜ã€‚</p>
</blockquote>
<ul>
<li>å¦‚æœéœ€è¦æ±‚ æœ€å¤§/æœ€å°çš„æ‹“æ‰‘æ’åºçš„è¯ï¼Œå¯ä»¥å°†å­˜å‚¨çš„ deque æ”¹æˆ ä¼˜å…ˆé˜Ÿåˆ—</li>
</ul>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span></span>{</span><br><span class="line">    <span class="type">int</span> n;</span><br><span class="line">    cin &gt;&gt; n;</span><br><span class="line">    vector&lt;vector&lt;<span class="type">int</span>&gt;&gt; <span class="built_in">a</span>(n + <span class="number">1</span>);</span><br><span class="line">    <span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">in</span><span class="params">(n + <span class="number">1</span>)</span></span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; i++){</span><br><span class="line">        <span class="type">int</span> u, v;</span><br><span class="line">        cin &gt;&gt; u &gt;&gt; v;</span><br><span class="line">        a[u].<span class="built_in">push_back</span>(v);</span><br><span class="line">        in[v]++;</span><br><span class="line">    }</span><br><span class="line">    deque&lt;<span class="type">int</span>&gt; q;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++){</span><br><span class="line">        <span class="keyword">if</span>(in[i] == <span class="number">0</span>){q.<span class="built_in">push_back</span>(i);}</span><br><span class="line">    }</span><br><span class="line">    <span class="keyword">while</span>(!q.<span class="built_in">empty</span>()){</span><br><span class="line">        <span class="type">int</span> x = q.<span class="built_in">front</span>(); q.<span class="built_in">pop_front</span>();</span><br><span class="line">        cout &lt;&lt; x &lt;&lt; endl;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">auto</span> t : a[x]){</span><br><span class="line">            in[t]--;</span><br><span class="line">            <span class="keyword">if</span>(in[t] == <span class="number">0</span>) q.<span class="built_in">push_back</span>(t);</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">}</span><br></pre></td></tr></table></figure>
<ul>
<li>æ¿å­é¢˜ï¼š<a target="_blank" rel="noopener" href="https://www.luogu.com.cn/problem/P1347">P1347</a></li>
</ul>
<h3 id="ford-bellman-ford"><a class="markdownIt-Anchor" href="#ford-bellman-ford"></a> ford + Bellman-Ford</h3>
<ol>
<li>ford ç®—æ³•<br>
æ ¸å¿ƒå®ç°å…¬å¼:</li>
</ol>
<p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>d</mi><mi>i</mi><mi>s</mi><mi>t</mi><mo stretchy="false">(</mo><mi>u</mi><mo separator="true">,</mo><mi>v</mi><mo stretchy="false">)</mo><mo>=</mo><mi>m</mi><mi>i</mi><mi>n</mi><mo stretchy="false">(</mo><mi>d</mi><mi>i</mi><mi>s</mi><mi>t</mi><mo stretchy="false">(</mo><mi>u</mi><mo separator="true">,</mo><mi>v</mi><mo stretchy="false">)</mo><mo separator="true">,</mo><mi>d</mi><mi>i</mi><mi>s</mi><mi>t</mi><mo stretchy="false">(</mo><mi>u</mi><mo separator="true">,</mo><mi>k</mi><mo stretchy="false">)</mo><mo>+</mo><mi>d</mi><mi>i</mi><mi>s</mi><mi>t</mi><mo stretchy="false">(</mo><mi>k</mi><mo separator="true">,</mo><mi>v</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">dist(u, v) = min(dist(u,v), dist(u,k) + dist(k, v))
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">d</span><span class="mord mathdefault">i</span><span class="mord mathdefault">s</span><span class="mord mathdefault">t</span><span class="mopen">(</span><span class="mord mathdefault">u</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">m</span><span class="mord mathdefault">i</span><span class="mord mathdefault">n</span><span class="mopen">(</span><span class="mord mathdefault">d</span><span class="mord mathdefault">i</span><span class="mord mathdefault">s</span><span class="mord mathdefault">t</span><span class="mopen">(</span><span class="mord mathdefault">u</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">d</span><span class="mord mathdefault">i</span><span class="mord mathdefault">s</span><span class="mord mathdefault">t</span><span class="mopen">(</span><span class="mord mathdefault">u</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">d</span><span class="mord mathdefault">i</span><span class="mord mathdefault">s</span><span class="mord mathdefault">t</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="mclose">)</span><span class="mclose">)</span></span></span></span></span></p>
<p>æ—¶é—´å¤æ‚åº¦: O(<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>n</mi><mn>3</mn></msup></mrow><annotation encoding="application/x-tex">n^3</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141079999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord mathdefault">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span></span></span></span></span></span></span></span>)</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span>(<span class="type">int</span> u = <span class="number">0</span>; u &lt; n; u++){</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> v = <span class="number">0</span>; v &lt; n; v++){</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> k = <span class="number">0</span>; k &lt; n; k++){</span><br><span class="line">            dist[u][v] = <span class="built_in">min</span>(dist[u][v], dist[u][k] + dist[k][v]);</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></table></figure>
<p>ç›¸å…³é—®é¢˜:</p>
<ul>
<li>æ±‚å›¾çš„ä¼ é€’é—­åŒ…: <code>IMPORTANT</code></li>
</ul>
<ol start="2">
<li>Bellman-ford(SPFA)<br>
ä¸ºäº†è§£å†³Fordçš„æ—¶é—´å¤æ‚åº¦è¿‡é«˜çš„é—®é¢˜,æå‡ºäº†ä¸€ä¸ªæ¾å¼›æ“ä½œ</li>
</ol>
<p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>S</mi><mo>â†’</mo><mi>u</mi><mo>â†’</mo><mi>v</mi></mrow><annotation encoding="application/x-tex">S \rightarrow u \rightarrow v
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">â†’</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">u</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">â†’</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">v</span></span></span></span></span></p>
<p>é€šè¿‡ä¸æ–­ä¼˜åŒ– dist(v) çš„è·¯å¾„æœ€å°å€¼,æ—¶é—´å¤æ‚åº¦: O(mn)<br>
<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>S</mi><mo>â†’</mo><mi>u</mi></mrow><annotation encoding="application/x-tex">S \rightarrow u</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">â†’</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">u</span></span></span></span> çš„è·¯å¾„å–æœ€çŸ­è·¯,ä½†æ˜¯ä½ è¿™ä¸ªåªèƒ½æ˜¯ä»¥ä¸€ä¸ªæºç‚¹è¿›è¡Œ</p>
<blockquote>
<p>[!WARNING]<br>
ç”±äºä½ æ˜¯ä»ä¸€ä¸ªæºç‚¹å¼€å§‹è¿›è¡Œçš„,é€šè¿‡è¿™ä¸ªç‚¹æ£€æµ‹ç‚¹æ—¶å€™å‘ç°æ²¡æœ‰è´Ÿç¯,åªèƒ½è¯´æ˜ä» Sè¿™ä¸ªç‚¹å‡ºå‘ä¸èƒ½æŠµè¾¾ä¸€ä¸ªè´Ÿç¯, æ‰€ä»¥ä½ è¦åˆ¤æ–­æ•´ä¸ªå›¾ä¸Šæ˜¯å¦å­˜åœ¨è´Ÿç¯ä¸€èˆ¬çš„æ‰‹æ®µéƒ½æ˜¯å»ºç«‹<strong>è¶…çº§æºç‚¹</strong></p>
</blockquote>
<p>æœ¬æ–‡åªä»‹ç»é˜Ÿåˆ—ä¼˜åŒ–çš„Bellman-ford: SPFA</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">vector&lt;vector&lt;pair&lt;<span class="type">int</span>, <span class="type">int</span>&gt;&gt;&gt; <span class="built_in">g</span>(n + <span class="number">1</span>);</span><br><span class="line"><span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">dist</span><span class="params">(n + <span class="number">1</span>, <span class="number">0</span>)</span></span>;</span><br><span class="line"><span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">cnt</span><span class="params">(n + <span class="number">1</span>, <span class="number">0</span>)</span></span>;</span><br><span class="line"><span class="function">vector&lt;<span class="type">bool</span>&gt; <span class="title">vis</span><span class="params">(n + <span class="number">1</span>, <span class="literal">false</span>)</span></span>; <span class="comment">// ç”¨æ¥æ ‡è®°èŠ‚ç‚¹æ˜¯ä¸æ˜¯åœ¨é˜Ÿåˆ—ä¸­,é˜²æ­¢é‡å¤</span></span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">spfa</span><span class="params">(<span class="type">int</span> n, <span class="type">int</span> s)</span></span>{</span><br><span class="line">    <span class="built_in">memset</span>(dist, <span class="number">0x3f</span>, dist.<span class="built_in">size</span>());</span><br><span class="line">    <span class="built_in">memset</span>(cnt, <span class="number">0</span>, cnt.<span class="built_in">size</span>());</span><br><span class="line">    dist[s] = <span class="number">0</span>; vis[s] = <span class="number">1</span>;</span><br><span class="line">    deque&lt;<span class="type">int</span>&gt; q;</span><br><span class="line">    q.<span class="built_in">push</span>(s);</span><br><span class="line">    <span class="keyword">while</span>(!q.<span class="built_in">empty</span>()){</span><br><span class="line">        <span class="type">int</span> u = q.<span class="built_in">front</span>(); q.<span class="built_in">pop_front</span>();</span><br><span class="line">        vis[u] = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">auto</span> {x, y} : g[u]){</span><br><span class="line">            <span class="keyword">if</span>(dist[x] &gt; dist[u] + y){</span><br><span class="line">                dist[x] = dist[u] + y;</span><br><span class="line">                cnt[x] = cnt[u] + <span class="number">1</span>;</span><br><span class="line">                <span class="keyword">if</span>(cnt[x] &gt;= n) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">                <span class="keyword">if</span>(!vis[x]) q.<span class="built_in">push_back</span>(x), vis[x] = <span class="number">1</span>;</span><br><span class="line">            }</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">}</span><br></pre></td></tr></table></figure>
<blockquote>
<p>[!TIP]<br>
èŠ‚ç‚¹æ¾å¼› n - 1æ¬¡å°±æ˜¯æé™äº†:å› ä¸ºç›¸å½“äºæ¯ä¸€ä¸ªèŠ‚ç‚¹éƒ½å¯¹è¿™ä¸ªèŠ‚ç‚¹è¿›è¡Œäº†distæ›´æ–°,ä¸å¯èƒ½ä¼šæœ‰æ›´å¤šäº†.</p>
</blockquote>
<h3 id="è´Ÿç¯-å·®åˆ†çº¦æŸ"><a class="markdownIt-Anchor" href="#è´Ÿç¯-å·®åˆ†çº¦æŸ"></a> è´Ÿç¯ å·®åˆ†çº¦æŸ</h3>
<p>å½¢å¼</p>
<ol>
<li>
<p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>x</mi><mi>i</mi></msub><mo>âˆ’</mo><msub><mi>x</mi><mi>j</mi></msub><mo>â‰¤</mo><msub><mi>C</mi><mi>i</mi></msub><mspace width="1em"></mspace><mrow><mtext>(</mtext><mstyle scriptlevel="0" displaystyle="false"><msub><mi>C</mi><mi>i</mi></msub></mstyle><mtext>Â ä¸ºå¸¸æ•°)</mtext></mrow><mspace linebreak="newline"></mspace><mi mathvariant="normal">æ‰¾</mi><mi mathvariant="normal">åˆ°</mi><mi mathvariant="normal">ä¸€</mi><mi mathvariant="normal">ç»„</mi><mi mathvariant="normal">æ»¡</mi><mi mathvariant="normal">è¶³</mi><mi mathvariant="normal">è¿™</mi><mi mathvariant="normal">ç§</mi><mi mathvariant="normal">å¼</mi><mi mathvariant="normal">å­</mi><mi mathvariant="normal">çš„</mi><mi mathvariant="normal">è§£</mi></mrow><annotation encoding="application/x-tex">x_i - x_j \leq C_i \quad \text{($C_i$ ä¸ºå¸¸æ•°)}\\
æ‰¾åˆ°ä¸€ç»„æ»¡è¶³è¿™ç§å¼å­çš„è§£
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.73333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.922078em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">â‰¤</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:1em;"></span><span class="mord text"><span class="mord">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">Â </span><span class="mord cjk_fallback">ä¸ºå¸¸æ•°</span><span class="mord">)</span></span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:0em;vertical-align:0em;"></span><span class="mord cjk_fallback">æ‰¾</span><span class="mord cjk_fallback">åˆ°</span><span class="mord cjk_fallback">ä¸€</span><span class="mord cjk_fallback">ç»„</span><span class="mord cjk_fallback">æ»¡</span><span class="mord cjk_fallback">è¶³</span><span class="mord cjk_fallback">è¿™</span><span class="mord cjk_fallback">ç§</span><span class="mord cjk_fallback">å¼</span><span class="mord cjk_fallback">å­</span><span class="mord cjk_fallback">çš„</span><span class="mord cjk_fallback">è§£</span></span></span></span></span></p>
</li>
</ol>
<blockquote>
<p>æ ¹æ® å°äºå· çš„ä¸ç­‰å¼æ¥å»ºå›¾</p>
</blockquote>
<p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>x</mi><mi>i</mi></msub><mo>â‰¤</mo><msub><mi>x</mi><mi>j</mi></msub><mo>+</mo><msub><mi>C</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">x_i \leq x_j + C_i
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7859700000000001em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">â‰¤</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8694379999999999em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span></p>
<p>å»ºå›¾æ–¹å¼:</p>
<ol>
<li>è¾¹æƒé‡æ›´æ–°: <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>x</mi><mi>j</mi></msub><mo>â†’</mo><msub><mi>x</mi><mi>i</mi></msub><mo separator="true">,</mo><mi mathvariant="normal">æƒ</mi><mi mathvariant="normal">é‡</mi><mo>+</mo><msub><mi>C</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">x_j \rightarrow x_i,æƒé‡+C_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.716668em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">â†’</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.7777700000000001em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord cjk_fallback">æƒ</span><span class="mord cjk_fallback">é‡</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></li>
<li>ç‚¹æƒé‡æ›´æ–°: <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>d</mi><mi>i</mi><mi>s</mi><mi>t</mi><mo stretchy="false">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo stretchy="false">)</mo><mo>=</mo><mi>m</mi><mi>i</mi><mi>n</mi><mo stretchy="false">(</mo><mi>d</mi><mi>i</mi><mi>s</mi><mi>t</mi><mo stretchy="false">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo stretchy="false">)</mo><mo separator="true">,</mo><mi>d</mi><mi>i</mi><mi>s</mi><mi>t</mi><mo stretchy="false">(</mo><msub><mi>C</mi><mi>i</mi></msub><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">dist(x_i) = min(dist(x_i), dist(C_i))</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">d</span><span class="mord mathdefault">i</span><span class="mord mathdefault">s</span><span class="mord mathdefault">t</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">m</span><span class="mord mathdefault">i</span><span class="mord mathdefault">n</span><span class="mopen">(</span><span class="mord mathdefault">d</span><span class="mord mathdefault">i</span><span class="mord mathdefault">s</span><span class="mord mathdefault">t</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">d</span><span class="mord mathdefault">i</span><span class="mord mathdefault">s</span><span class="mord mathdefault">t</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mclose">)</span></span></span></span><br>
ä»é‚£ä¸ªèŠ‚ç‚¹å‡ºå‘,è¿™ä¸ªèŠ‚ç‚¹çš„æƒé‡è®¾ç½®ä¸º 0<br>
å°†è¿™ä¸ªå¼å­åº”ç”¨åˆ° <strong>å›¾</strong>ä¸­,å¦‚æœå›¾ä¸­å­˜åœ¨è´Ÿç¯å°±ä¸å­˜åœ¨æ»¡è¶³çš„è§£ã€‚</li>
</ol>
<ul>
<li>è´Ÿç¯åˆ¤æ–­ï¼š å¦‚æœè¿™ä¸ªèŠ‚ç‚¹è¿›é˜Ÿåˆ— <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>â‰¥</mo></mrow><annotation encoding="application/x-tex">\geq</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7719400000000001em;vertical-align:-0.13597em;"></span><span class="mrel">â‰¥</span></span></span></span> æ‰€æœ‰èŠ‚ç‚¹çš„ ä¸ªæ•° - 1</li>
<li>å¦‚æœé˜Ÿåˆ—ä¸ºç©ºï¼Œdist[n] ä¾¿æ˜¯ä¸€ç»„è§£</li>
<li>ä¸€èˆ¬è®¾ç½®ä¸€ä¸ª <strong>è¶…çº§æºç‚¹</strong> æ¥è§£å†³å›¾ä¸­ä¸è¿é€šé—®é¢˜</li>
<li>å¦‚æœå­˜åœ¨å˜é‡æ˜¯å®šå€¼,è®¾ç½®ä¸€ä¸ª<strong>é™åˆ¶æºç‚¹</strong></li>
</ul>
<h3 id="æœ€å°ç¯é—®é¢˜"><a class="markdownIt-Anchor" href="#æœ€å°ç¯é—®é¢˜"></a> æœ€å°ç¯é—®é¢˜</h3>
<h3 id="åŒä½™æœ€çŸ­è·¯"><a class="markdownIt-Anchor" href="#åŒä½™æœ€çŸ­è·¯"></a> åŒä½™æœ€çŸ­è·¯</h3>
<p>ä»‹ç»:<br>
n ä¸ªæ•°å­—,ç”¨æœ€å°çš„æ•°å­—ä½œä¸ºåŸºå‡†,ç”¨å®ƒçš„ä½™æ•°æ¥è¿›è¡Œåˆ’åˆ†å»ºå›¾,ç„¶åè·‘æœ€çŸ­è·¯,å°†ä½™æ•°ä½œä¸ºèŠ‚ç‚¹,é™¤äº†åŸºå‡†çš„æ•°å­—å…¶ä»–æ•°å­—ä½œä¸ºè¾¹æƒé‡,å¦‚æœ (i + <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>W</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">W_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>) == j,è¯´æ˜ i, jä¹‹é—´æœ‰ä¸€æ¡è¾¹</p>
<blockquote>
<p>[!CAUTION]<br>
æ€è€ƒ: åŒä½™æœ€çŸ­è·¯æ˜¯ç”¨æ¥è§£å†³ä»€ä¹ˆé—®é¢˜?</p>
</blockquote>
<p>å¸¸è§é—®é¢˜:</p>
<ol>
<li>
<p>æœ‰nä¸ªæ•°å­—,æ¯ä¸ªæ•°å­—æœ‰æ— é™ä¸ª,èƒ½ç»„æˆ <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>â†</mo></mrow><annotation encoding="application/x-tex">\leftarrow</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.36687em;vertical-align:0em;"></span><span class="mrel">â†</span></span></span></span> x(å¾ˆå¤§)çš„ä¸ªæ•°</p>
</li>
<li></li>
</ol>
<h2 id="æ•°å­¦"><a class="markdownIt-Anchor" href="#æ•°å­¦"></a> æ•°å­¦</h2>
<h3 id="åŸºç¡€æ•°è®º"><a class="markdownIt-Anchor" href="#åŸºç¡€æ•°è®º"></a> åŸºç¡€æ•°è®º</h3>
<ul>
<li>ä»»ä½•ä¸€ä¸ªæ•´æ•° éƒ½å¯ä»¥åˆ†è§£ä¸º æœ‰é™ä¸ªè´¨æ•°çš„ä¹˜ç§¯</li>
</ul>
<p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>N</mi><mo>=</mo><msubsup><mi>p</mi><mn>1</mn><msub><mi>c</mi><mn>1</mn></msub></msubsup><mo>âˆ—</mo><msubsup><mi>p</mi><mn>2</mn><msub><mi>c</mi><mn>2</mn></msub></msubsup><mo>â€¦</mo><msubsup><mi>p</mi><mi>x</mi><msub><mi>c</mi><mi>x</mi></msub></msubsup></mrow><annotation encoding="application/x-tex">N = p_1^{c_1} * p_2^{c_2} \dots p_x^{c_x}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.10903em;">N</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.0126em;vertical-align:-0.26630799999999993em;"></span><span class="mord"><span class="mord mathdefault">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.746292em;"><span style="top:-2.433692em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span><span style="top:-3.1449em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31731428571428577em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.26630799999999993em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.0126em;vertical-align:-0.26630799999999993em;"></span><span class="mord"><span class="mord mathdefault">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.746292em;"><span style="top:-2.433692em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span><span style="top:-3.1449em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31731428571428577em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.26630799999999993em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner">â€¦</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7143919999999999em;"><span style="top:-2.4530000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">x</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.16454285714285719em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight">x</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span></span></span></span></span></p>
<p>åˆ™ N çš„çº¦æ•°é›†åˆä¸º</p>
<p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="normal">çº¦</mi><mi mathvariant="normal">æ•°</mi><mi mathvariant="normal">é›†</mi><mi mathvariant="normal">åˆ</mi><mo>=</mo><mo stretchy="false">{</mo><msubsup><mi>p</mi><mn>1</mn><msub><mi>b</mi><mn>1</mn></msub></msubsup><mo>âˆ—</mo><msubsup><mi>p</mi><mn>2</mn><msub><mi>b</mi><mn>2</mn></msub></msubsup><mo>â€¦</mo><msubsup><mi>p</mi><mi>x</mi><msub><mi>b</mi><mi>x</mi></msub></msubsup><mo stretchy="false">}</mo><mspace linebreak="newline"></mspace><mn>0</mn><mo>â‰¤</mo><msub><mi>b</mi><mi>i</mi></msub><mo>â‰¤</mo><msub><mi>c</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">çº¦æ•°é›†åˆ = \{p_1^{b_1} * p_2 ^ {b_2} \dots p_x^{b_x}\} \\
 0\le b_i \le c_i
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.36687em;vertical-align:0em;"></span><span class="mord cjk_fallback">çº¦</span><span class="mord cjk_fallback">æ•°</span><span class="mord cjk_fallback">é›†</span><span class="mord cjk_fallback">åˆ</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.1973159999999998em;vertical-align:-0.26630799999999993em;"></span><span class="mopen">{</span><span class="mord"><span class="mord mathdefault">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9310079999999998em;"><span style="top:-2.433692em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span><span style="top:-3.1449em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31731428571428577em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.26630799999999993em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.1973159999999998em;vertical-align:-0.26630799999999993em;"></span><span class="mord"><span class="mord mathdefault">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9310079999999998em;"><span style="top:-2.433692em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span><span style="top:-3.1449em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31731428571428577em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.26630799999999993em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner">â€¦</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8991079999999999em;"><span style="top:-2.4530000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">x</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.16454285714285719em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight">x</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mclose">}</span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:0.78041em;vertical-align:-0.13597em;"></span><span class="mord">0</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">â‰¤</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">â‰¤</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span></p>
<p>æ­£çº¦æ•°çš„ä¸ªæ•° :<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msubsup><mo>âˆ</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>m</mi></msubsup><mrow><mo stretchy="false">(</mo><msub><mi>c</mi><mi>i</mi></msub><mo>+</mo><mn>1</mn><mo stretchy="false">)</mo></mrow></mrow><annotation encoding="application/x-tex">\prod_{i=1}^{m}{(c_i +1)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.104002em;vertical-align:-0.29971000000000003em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:-0.0000050000000000050004em;">âˆ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.804292em;"><span style="top:-2.40029em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">m</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.29971000000000003em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord">1</span><span class="mclose">)</span></span></span></span></span></p>
<ul>
<li>è´¨æ•°ç­›çš„ç®—æ³•åªéœ€è¦ <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>l</mi><mi>o</mi><mi>g</mi><mrow><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow></mrow><annotation encoding="application/x-tex">log{(n)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mord mathdefault">o</span><span class="mord mathdefault" style="margin-right:0.03588em;">g</span><span class="mord"><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mclose">)</span></span></span></span></span></li>
</ul>
<h3 id="é«˜æ–¯æ¶ˆå…ƒ"><a class="markdownIt-Anchor" href="#é«˜æ–¯æ¶ˆå…ƒ"></a> é«˜æ–¯æ¶ˆå…ƒ</h3>
<blockquote>
<p>é«˜æ–¯æ¶ˆå…ƒ æœ‰ä¸‰ç§ç±»åˆ«ï¼Œæˆ‘ä»¬ä¼šé€ä¸€è¡¥å……ï¼Œç›®å‰å…ˆè¡¥å…… å¼‚æˆ–æ¶ˆå…ƒï¼Œä½†æ˜¯å…¶å®æœ¬è´¨æ˜¯ä¸å˜çš„ã€‚</p>
</blockquote>
<h3 id="çº¿æ€§åŸº"><a class="markdownIt-Anchor" href="#çº¿æ€§åŸº"></a> çº¿æ€§åŸº</h3>
<blockquote>
<p>ç»™å‡ºä¸€ä¸ªæ•°ç»„ï¼Œè¯·æ‰¾å‡ºè¿™ä¸ª æ•°ç»„çš„ä»»æ„å…ƒç´ è¿›è¡Œå¼‚æˆ–ï¼Œå¯ä»¥å¾—åˆ°å¤šå°‘ç§æƒ…å†µã€‚</p>
<p>çº¿æ€§åŸºçš„å¤§å°ä¾¿å†³å®šäº† èƒ½å¼‚æˆ–çš„å¤šå°‘ç§æƒ…å†µ ï¼ˆ2 ^ n - 1)</p>
</blockquote>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line">#<span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line">#<span class="meta">#<span class="keyword">define</span> int long long </span></span><br><span class="line">#<span class="meta">#<span class="keyword">define</span> fr first</span></span><br><span class="line">#<span class="meta">#<span class="keyword">define</span> sc second</span></span><br><span class="line">#<span class="meta">#<span class="keyword">define</span> endl <span class="string">'\n'</span></span></span><br><span class="line"><span class="keyword">using</span> PII = pair&lt;<span class="type">int</span>,<span class="type">int</span>&gt;;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">  çº¿æ€§åŸº</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="type">void</span> _1(){</span><br><span class="line">    <span class="type">int</span> n;</span><br><span class="line">    cin &gt;&gt; n;</span><br><span class="line">    <span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">a</span><span class="params">(n + <span class="number">1</span>, <span class="number">0</span>)</span></span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++) cin &gt;&gt; a[i];</span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">      æŸ¥æ‰¾æ¯ä¸€ä½çš„ åŸº</span></span><br><span class="line"><span class="comment">      é¦–å…ˆ ä» æ¯ä¸€ä¸ªæ•° å¼€å§‹éå†ï¼Œç„¶åæšä¸¾ æ¯ä¸€ä¸ªä½ç½®ï¼Œå¦‚æœè¿™ä¸ªä½ç½®æœ‰ åŸºï¼Œå°†è¿™ä¸ªæ•° å˜æˆ ä¸¤è€…çš„å¼‚æˆ–å€¼</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">    <span class="type">int</span> h = <span class="number">61</span>;</span><br><span class="line">    <span class="type">bool</span> zero = <span class="literal">false</span>;</span><br><span class="line">    vector&lt;<span class="type">int</span>&gt; ans;</span><br><span class="line">    <span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">base</span><span class="params">(h + <span class="number">1</span>, <span class="number">0</span>)</span></span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++){</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> j = h; j &gt;= <span class="number">0</span>; j--){</span><br><span class="line">            <span class="keyword">if</span>(((a[i] &gt;&gt; j) &amp; <span class="number">1</span>) == <span class="number">1</span>){</span><br><span class="line">                <span class="keyword">if</span>(base[j] == <span class="number">0</span>){</span><br><span class="line">                    base[j] = a[i];</span><br><span class="line">                    ans.<span class="built_in">push_back</span>(a[i]);</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                }<span class="keyword">else</span> a[i] = a[i] ^ base[j];</span><br><span class="line">            }</span><br><span class="line">            <span class="keyword">if</span>(a[i] == <span class="number">0</span>) zero = <span class="literal">true</span>;</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">auto</span> x : ans) cout &lt;&lt; x &lt;&lt; <span class="string">" "</span>;</span><br><span class="line">    cout &lt;&lt; endl;</span><br><span class="line">    <span class="keyword">if</span>(zero) cout &lt;&lt; <span class="string">"yes"</span> &lt;&lt; endl;</span><br><span class="line">    <span class="keyword">else</span> cout &lt;&lt; <span class="string">"no"</span> &lt;&lt; endl;</span><br><span class="line">}</span><br></pre></td></tr></table></figure>
<ul>
<li>é«˜æ–¯æ¶ˆå…ƒ</li>
</ul>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> _2(){</span><br><span class="line">    <span class="type">int</span> n;</span><br><span class="line">    cin &gt;&gt; n;</span><br><span class="line">    <span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">a</span><span class="params">(n + <span class="number">1</span>, <span class="number">0</span>)</span></span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++) cin &gt;&gt; a[i];</span><br><span class="line"></span><br><span class="line">    <span class="type">int</span> len = <span class="number">1</span>, h = <span class="number">61</span>; <span class="comment">// ä¸Šé¢æ˜¯ç¡®å®šçš„</span></span><br><span class="line">    <span class="type">bool</span> zero = <span class="literal">false</span>;</span><br><span class="line">    <span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">base</span><span class="params">(<span class="number">1</span>,<span class="number">0</span>)</span></span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = h; i &gt;= <span class="number">0</span>; i--){</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> j = len; j &lt;= n; j++){</span><br><span class="line">            <span class="keyword">if</span>(((a[j] &gt;&gt; i) &amp; <span class="number">1</span>) == <span class="number">1</span>){</span><br><span class="line">                <span class="built_in">swap</span>(a[len],a[j]);</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            }</span><br><span class="line">        }</span><br><span class="line">        <span class="keyword">if</span>(((a[len] &gt;&gt; i) &amp; <span class="number">1</span>) == <span class="number">1</span>){ </span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> k = <span class="number">1</span>; k &lt;= n; k++){</span><br><span class="line">            <span class="keyword">if</span>(k != len &amp;&amp; ((a[k] &gt;&gt; i) &amp; <span class="number">1</span>) == <span class="number">1</span>){</span><br><span class="line">                a[k] = a[k] ^ a[len];</span><br><span class="line">            }</span><br><span class="line">        }</span><br><span class="line">        len++;</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line">    len --;</span><br><span class="line">    <span class="keyword">if</span>(len != n) zero = <span class="literal">true</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= len; i++) cout &lt;&lt; a[i] &lt;&lt; <span class="string">" "</span>;</span><br><span class="line">    cout &lt;&lt; endl;</span><br><span class="line">    <span class="keyword">if</span>(zero) cout &lt;&lt; <span class="string">"yes"</span> &lt;&lt; endl;</span><br><span class="line">    <span class="keyword">else</span> cout &lt;&lt; <span class="string">"no"</span> &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line">}</span><br></pre></td></tr></table></figure>
<h4 id="å¸¸è§è€ƒç‚¹"><a class="markdownIt-Anchor" href="#å¸¸è§è€ƒç‚¹"></a> å¸¸è§è€ƒç‚¹ï¼š</h4>
<h5 id="æ±‚å¼‚æˆ–æœ€å¤§å€¼"><a class="markdownIt-Anchor" href="#æ±‚å¼‚æˆ–æœ€å¤§å€¼"></a> <strong>æ±‚å¼‚æˆ–æœ€å¤§å€¼</strong></h5>
<blockquote>
<p>ä» æœ€é«˜ä½å¼€å§‹æšä¸¾ï¼Œæ¥è¿›è¡Œæ›´æ–°æœ€å¤§å€¼</p>
</blockquote>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">#<span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line">#<span class="meta">#<span class="keyword">define</span> int long long </span></span><br><span class="line">#<span class="meta">#<span class="keyword">define</span> fr first</span></span><br><span class="line">#<span class="meta">#<span class="keyword">define</span> sc second</span></span><br><span class="line">#<span class="meta">#<span class="keyword">define</span> endl <span class="string">'\n'</span></span></span><br><span class="line"><span class="keyword">using</span> PII = pair&lt;<span class="type">int</span>,<span class="type">int</span>&gt;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span></span>{</span><br><span class="line">    <span class="type">int</span> n;</span><br><span class="line">    cin &gt;&gt; n;</span><br><span class="line">    <span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">a</span><span class="params">(n + <span class="number">1</span>, <span class="number">0</span>)</span></span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++) cin &gt;&gt; a[i];</span><br><span class="line">    <span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">base</span><span class="params">(<span class="number">53</span>,<span class="number">0</span>)</span></span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++){</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> k = <span class="number">52</span>; k &gt;= <span class="number">0</span>; k--){</span><br><span class="line">            <span class="keyword">if</span>(((a[i] &gt;&gt; k) &amp; <span class="number">1</span>) == <span class="number">1</span>){</span><br><span class="line">                <span class="keyword">if</span>(base[k] == <span class="number">0</span>){</span><br><span class="line">                    base[k] = a[i];</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                }<span class="keyword">else</span>{</span><br><span class="line">                    a[i] ^= base[k];</span><br><span class="line">                }</span><br><span class="line">            }</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="type">int</span> mx = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">52</span>; i &gt;= <span class="number">0</span>; i--){</span><br><span class="line">        mx = <span class="built_in">max</span>(mx, mx ^ base[i]);</span><br><span class="line">    }</span><br><span class="line">    cout &lt;&lt; mx &lt;&lt; endl;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">}</span><br></pre></td></tr></table></figure>
<h5 id="æ±‚-å¼‚æˆ–-ç¬¬-k-å°å€¼"><a class="markdownIt-Anchor" href="#æ±‚-å¼‚æˆ–-ç¬¬-k-å°å€¼"></a> <strong>æ±‚ å¼‚æˆ– ç¬¬ k å°å€¼</strong></h5>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><span class="line">#<span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line">#<span class="meta">#<span class="keyword">define</span> int long long </span></span><br><span class="line">#<span class="meta">#<span class="keyword">define</span> fr first</span></span><br><span class="line">#<span class="meta">#<span class="keyword">define</span> sc second</span></span><br><span class="line">#<span class="meta">#<span class="keyword">define</span> endl <span class="string">'\n'</span></span></span><br><span class="line"><span class="keyword">using</span> PII = pair&lt;<span class="type">int</span>,<span class="type">int</span>&gt;;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">  çº¿æ€§åŸº</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span></span>{</span><br><span class="line">    <span class="type">int</span> n;</span><br><span class="line">    cin &gt;&gt; n;</span><br><span class="line">    <span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">a</span><span class="params">(n + <span class="number">1</span>,<span class="number">0</span>)</span></span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++) cin &gt;&gt; a[i];</span><br><span class="line">    <span class="keyword">auto</span> swp = [&amp;](<span class="type">int</span> i, <span class="type">int</span> j) -&gt; <span class="type">void</span>{</span><br><span class="line">        <span class="type">int</span> t = a[i];</span><br><span class="line">        a[i] = a[j];</span><br><span class="line">        a[j] = t;</span><br><span class="line">    };</span><br><span class="line">    <span class="type">int</span> len = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">53</span>; i &gt;= <span class="number">0</span>; i--){</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> j = len; j &lt;= n; j++){</span><br><span class="line">            <span class="keyword">if</span>(((a[j] &gt;&gt; i) &amp; <span class="number">1</span>) == <span class="number">1</span>){</span><br><span class="line">                <span class="built_in">swp</span>(j, len);</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            }</span><br><span class="line">        }</span><br><span class="line">        <span class="keyword">if</span>(((a[len] &gt;&gt; i) &amp; <span class="number">1</span>) == <span class="number">1</span>){</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> j = <span class="number">1</span>; j &lt;= n; j++){</span><br><span class="line">            <span class="keyword">if</span>(j != len &amp;&amp; (((a[j] &gt;&gt; i) &amp; <span class="number">1</span>) == <span class="number">1</span>)){</span><br><span class="line">                a[j] ^= a[len];</span><br><span class="line">            }</span><br><span class="line">        }</span><br><span class="line">        len ++;</span><br><span class="line">    }</span><br><span class="line">    }</span><br><span class="line">    len --;</span><br><span class="line">    <span class="comment">// for(int i = 1; i &lt;= len; i++) cout &lt;&lt; a[i] &lt;&lt; " ";</span></span><br><span class="line">    <span class="comment">// cout &lt;&lt; endl;</span></span><br><span class="line">    <span class="type">bool</span> zero = (len != n);</span><br><span class="line">    <span class="type">int</span> m;</span><br><span class="line">    cin &gt;&gt; m;</span><br><span class="line">    <span class="type">int</span> mx = (<span class="number">1</span> &lt;&lt; len);</span><br><span class="line">    <span class="comment">// cout &lt;&lt; mx &lt;&lt; endl;</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; m; i++){</span><br><span class="line">        <span class="type">int</span> t;</span><br><span class="line">        cin &gt;&gt; t;</span><br><span class="line">        <span class="keyword">if</span>(zero) t--;</span><br><span class="line">        <span class="keyword">if</span>(t == <span class="number">0</span> &amp;&amp; zero) cout &lt;&lt; <span class="string">"0"</span> &lt;&lt; <span class="string">"\n"</span>;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(t == <span class="number">0</span> || t &gt;= mx) cout &lt;&lt; <span class="string">"-1"</span> &lt;&lt; <span class="string">"\n"</span>;</span><br><span class="line">        <span class="keyword">else</span>{</span><br><span class="line">            <span class="type">int</span> ans = <span class="number">0</span>;</span><br><span class="line">            <span class="comment">// cout &lt;&lt; t &lt;&lt; endl;</span></span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> i = len, j = <span class="number">0</span>; i &gt;= <span class="number">1</span>; i--, j++) {</span><br><span class="line">            <span class="keyword">if</span> ((t &amp; (<span class="number">1L</span> &lt;&lt; j)) != <span class="number">0</span>) {</span><br><span class="line">                ans ^= a[i];</span><br><span class="line">            }</span><br><span class="line">        }</span><br><span class="line">            cout &lt;&lt; ans &lt;&lt; <span class="string">"\n"</span>;</span><br><span class="line">            <span class="comment">// cout &lt;&lt; endl;</span></span><br><span class="line">        }</span><br><span class="line"></span><br><span class="line">    }</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">}</span><br></pre></td></tr></table></figure>
<h3 id="äºŒé¡¹å¼å®šç†"><a class="markdownIt-Anchor" href="#äºŒé¡¹å¼å®šç†"></a> äºŒé¡¹å¼å®šç†</h3>
<p>åŸºæœ¬å…¬å¼:</p>
<p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo stretchy="false">(</mo><mi>a</mi><mo>+</mo><mi>b</mi><msup><mo stretchy="false">)</mo><mi>n</mi></msup><mo>=</mo><munderover><mo>âˆ‘</mo><mrow><mi>k</mi><mo>=</mo><mn>0</mn></mrow><mi>n</mi></munderover><mrow><mo fence="true">(</mo><mfrac linethickness="0px"><mi>n</mi><mi>k</mi></mfrac><mo fence="true">)</mo></mrow><msup><mi>a</mi><mrow><mi>n</mi><mo>âˆ’</mo><mi>k</mi></mrow></msup><msup><mi>b</mi><mi>k</mi></msup></mrow><annotation encoding="application/x-tex">(a + b)^n = \sum_{k=0}^{n} \binom{n}{k} a^{n-k} b^k
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathdefault">a</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">b</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7143919999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:2.9535100000000005em;vertical-align:-1.302113em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6513970000000002em;"><span style="top:-1.8478869999999998em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span><span class="mrel mtight">=</span><span class="mord mtight">0</span></span></span></span><span style="top:-3.0500049999999996em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">âˆ‘</span></span></span><span style="top:-4.300005em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.302113em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size3">(</span></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.1075599999999999em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03148em;">k</span></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault">n</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size3">)</span></span></span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8991079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span><span class="mbin mtight">âˆ’</span><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span></span></span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8991079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span></span></span></span></span></span></span></span></span></span></span></span></p>
<p>å…³é”®çš„ç»„åˆå…¬å¼:(æ¨è¾‰ä¸‰è§’)</p>
<p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>C</mi><mo stretchy="false">(</mo><mi>i</mi><mo separator="true">,</mo><mi>j</mi><mo stretchy="false">)</mo><mo>=</mo><mi>C</mi><mo stretchy="false">(</mo><mi>i</mi><mo>âˆ’</mo><mn>1</mn><mo separator="true">,</mo><mi>j</mi><mo stretchy="false">)</mo><mo>+</mo><mi>C</mi><mo stretchy="false">(</mo><mi>i</mi><mo>âˆ’</mo><mn>1</mn><mo separator="true">,</mo><mi>j</mi><mo>âˆ’</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">C(i,j) = C(i - 1,j) + C(i - 1, j - 1)
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.07153em;">C</span><span class="mopen">(</span><span class="mord mathdefault">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.05724em;">j</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.07153em;">C</span><span class="mopen">(</span><span class="mord mathdefault">i</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.05724em;">j</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.07153em;">C</span><span class="mopen">(</span><span class="mord mathdefault">i</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.85396em;vertical-align:-0.19444em;"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.05724em;">j</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">)</span></span></span></span></span></p>
<p><strong>C(n, k)çš„æ¨¡ç‰ˆ</strong>:</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">1e5</span> + <span class="number">10</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> mod = <span class="number">1e9</span> + <span class="number">7</span>;</span><br><span class="line"><span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">fac</span><span class="params">(N, <span class="number">0</span>)</span></span>; <span class="comment">// é˜¶ä¹˜è¡¨</span></span><br><span class="line"><span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">inv</span><span class="params">(N, <span class="number">0</span>)</span></span>; <span class="comment">// é€†å…ƒè¡¨</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">get_inv</span><span class="params">()</span> </span>{</span><br><span class="line">    inv[<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">2</span>; i &lt;= N; ++i) {</span><br><span class="line">      inv[i] = (<span class="type">long</span> <span class="type">long</span>)(p - p / i) * inv[p % i] % p;</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">get_fac</span><span class="params">()</span> </span>{</span><br><span class="line">    fac[<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">2</span>; i &lt;= N; i++){</span><br><span class="line">        fac[i] = i * fac[i - <span class="number">1</span>] % mod;</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">c</span><span class="params">(<span class="type">int</span> n, <span class="type">int</span> k)</span> </span>{</span><br><span class="line">    <span class="keyword">return</span> (((fac[n] * inv[k]) % mod) * inv[n - k]) % mod;</span><br><span class="line">}</span><br></pre></td></tr></table></figure>
<h3 id="æ‰©å±•æ¬§å‡ é‡Œå¾—-2"><a class="markdownIt-Anchor" href="#æ‰©å±•æ¬§å‡ é‡Œå¾—-2"></a> æ‰©å±•æ¬§å‡ é‡Œå¾—</h3>
<h4 id="ä¸­å›½å‰©ä½™å®šç†"><a class="markdownIt-Anchor" href="#ä¸­å›½å‰©ä½™å®šç†"></a> ä¸­å›½å‰©ä½™å®šç†</h4>
<p>ç”±æ‰©å±•æ¬§å‡ é‡Œå¾—ç®—æ³•ï¼ˆåç»­å¡«å®Œæ‰©å±•æ¬§å‡ é‡Œå¾—ä¼šè¡¥å……ï¼‰</p>
<h3 id="é¸½å·¢åŸç†"><a class="markdownIt-Anchor" href="#é¸½å·¢åŸç†"></a> é¸½å·¢åŸç†</h3>
<h2 id="åŠ¨æ€è§„åˆ’"><a class="markdownIt-Anchor" href="#åŠ¨æ€è§„åˆ’"></a> åŠ¨æ€è§„åˆ’</h2>
<p>æ€è€ƒ: ä»€ä¹ˆæ—¶å€™æ‰æ˜¯ä½¿ç”¨åŠ¨æ€è§„åˆ’çš„æ—¶å€™å‘¢?</p>
<h3 id="åŒºé—´dp"><a class="markdownIt-Anchor" href="#åŒºé—´dp"></a> åŒºé—´DP</h3>
<blockquote>
<p>å½“å®ç° åŒºé—´DP çš„æ—¶å€™ï¼Œå¦‚ä½•å°†é€’å½’è¯¥è¿­ä»£</p>
<ol>
<li>é¦–å…ˆ<strong>æšä¸¾æ¯ä¸€ä¸ªé•¿åº¦çš„åŒºé—´ï¼Œç„¶ååœ¨æšä¸¾æ¯ä¸€ä¸ªåŒºé—´çš„å¼€å¤´</strong>ï¼ˆè¿™æ ·å¯ä»¥é¿å…åˆ¤æ–­è¾¹ç•Œæ¡ä»¶ï¼‰ï¼Œç„¶ååˆ¤æ–­è¿™ä¸ªåŒºé—´çš„æ‰©å±•ï¼Œå› ä¸ºå½“ä½ æšä¸¾åˆ°è¿™ä¸ªé•¿åº¦çš„åŒºé—´çš„æ—¶å€™ï¼Œä½ æ˜¯ä¸€å®šæšä¸¾å®Œè¿™ä¸ªåŒºé—´çš„å­åŒºé—´çš„ã€‚</li>
<li>æ³¨æ„ å­åŒºé—´ä¸­å­˜åœ¨ä¸€äº›ç‰¹åˆ¤çš„æƒ…å†µï¼</li>
</ol>
</blockquote>
<p>å¸¸ç”¨æ¨¡ç‰ˆ</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// æšä¸¾åŒºé—´é•¿åº¦</span></span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> len = <span class="number">2</span>; len &lt;= n; len++){</span><br><span class="line">    <span class="comment">// ä¾¿åˆ©æ¯ä¸€ä¸ªè¯¥é•¿åº¦çš„åŒºé—´</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> l = <span class="number">1</span>, r = l + len - <span class="number">1</span>; r &lt;= n; l++,r++){</span><br><span class="line">        <span class="comment">// åŒºé—´åˆ†å‰²ç‚¹</span></span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> k = l + <span class="number">1</span>; k &lt; r; k++){</span><br><span class="line"></span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<ul>
<li><a target="_blank" rel="noopener" href="http://leetcode.cn/problems/predict-the-winner/submissions/626649392/">é¢„æµ‹èµ¢å®¶</a></li>
</ul>
<h2 id="è®¡ç®—å‡ ä½•"><a class="markdownIt-Anchor" href="#è®¡ç®—å‡ ä½•"></a> è®¡ç®—å‡ ä½•</h2>
<h3 id="æŠ˜å°ºå®šç†"><a class="markdownIt-Anchor" href="#æŠ˜å°ºå®šç†"></a> æŠ˜å°ºå®šç†</h3>
<p><a target="_blank" rel="noopener" href="https://codeforces.com/contest/2119/problem/B">é¢˜ç›®</a><br>
<br><br>
<a target="_blank" rel="noopener" href="https://baoziwan.icu/algorithm.html#more">åŒ…å­ä¸¸-algorithm-1.3.15</a><br>
æ¡ä»¶: ç»™å®š n ä¸ªæœ¨æ£’,åˆ¤æ–­è¿™ n æ ¹æœ¨æ£’èƒ½ä¸èƒ½è¿æ¥åœ¨ä¸¤ä¸ªç‚¹ä¹‹é—´<br>
éœ€è¦æ»¡è¶³æ¡ä»¶:</p>
<p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>L</mi><mo>â‰¤</mo><mi>D</mi><mo>â‰¤</mo><mi>R</mi></mrow><annotation encoding="application/x-tex">L \leq D \leq R
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8193em;vertical-align:-0.13597em;"></span><span class="mord mathdefault">L</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">â‰¤</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8193em;vertical-align:-0.13597em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">D</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">â‰¤</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.00773em;">R</span></span></span></span></span></p>
<p>ç›¸å…³æ¦‚å¿µ:</p>
<ol>
<li><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>L</mi><mo>=</mo><mi>m</mi><mi>a</mi><mi>x</mi><mo stretchy="false">(</mo><mn>0</mn><mo separator="true">,</mo><mn>2</mn><mo>âˆ—</mo><msub><mi>a</mi><mi>m</mi></msub><mi>a</mi><mi>x</mi><mo>âˆ’</mo><mi>R</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">L = max(0,2 * a_max - R)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault">L</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">m</span><span class="mord mathdefault">a</span><span class="mord mathdefault">x</span><span class="mopen">(</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">2</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.73333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">m</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathdefault">a</span><span class="mord mathdefault">x</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="mclose">)</span></span></span></span></li>
<li><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>R</mi><mo>=</mo><msubsup><mo>âˆ‘</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></msubsup><msub><mi>a</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">R = \sum_{i = 1}^{n}a_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.104002em;vertical-align:-0.29971000000000003em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:-0.0000050000000000050004em;">âˆ‘</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.804292em;"><span style="top:-2.40029em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.29971000000000003em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></li>
<li>D è¡¨ç¤ºä¸¤ç‚¹ä¹‹é—´çš„è·ç¦»</li>
</ol>
<h3 id="åšå¼ˆè®º"><a class="markdownIt-Anchor" href="#åšå¼ˆè®º"></a> åšå¼ˆè®º</h3>
<h2 id="å­—ç¬¦ä¸²"><a class="markdownIt-Anchor" href="#å­—ç¬¦ä¸²"></a> å­—ç¬¦ä¸²</h2>
<h3 id="å­—ç¬¦ä¸²å“ˆå¸Œ"><a class="markdownIt-Anchor" href="#å­—ç¬¦ä¸²å“ˆå¸Œ"></a> å­—ç¬¦ä¸²å“ˆå¸Œ</h3>
<blockquote>
<p>[!NOTE]<br>
å…¶å®å°±æ˜¯å°†å­—ç¬¦ä¸²å˜æˆ æ•´æ•°æ¥å­˜å‚¨,å°†ä¸å®šé•¿çš„Stringç±»å‹å˜æˆå®šé•¿çš„æ•´æ•°ç±»å‹,å¯ä»¥åœ¨ä¸€äº›ç‰¹æ®Šåœºæ™¯å‡å°‘å†…å­˜</p>
</blockquote>
<ol>
<li>åŸºäºä¸€ä¸ª baseè¿›åˆ¶çš„æ•°å­—å¹¶ä¸”è®©å…¶è‡ªç„¶æº¢å‡º</li>
<li>è½¬åŒ–çš„æ—¶å€™æ¯ä¸€ä½çš„å€¼ä» 1 å¼€å§‹</li>
</ol>
<p>å®ç°ä»£ç :</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">const</span> <span class="type">int</span> base = <span class="number">1e9</span> + <span class="number">7</span>;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">value</span><span class="params">(string s)</span></span>{</span><br><span class="line">    <span class="comment">// v[] è¡¨ç¤º s[i] åœ¨æ–°å®šä¹‰çš„stringä¸­çš„ä½ç½®</span></span><br><span class="line">    <span class="type">int</span> ans = v[s[<span class="number">0</span>]]; </span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt; s.<span class="built_in">size</span>(); i++){</span><br><span class="line">        ans = ans * base + v[s[i]];</span><br><span class="line">    }</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">}</span><br></pre></td></tr></table></figure>
<h4 id="è·å¾—å­ä¸²hash"><a class="markdownIt-Anchor" href="#è·å¾—å­ä¸²hash"></a> è·å¾—å­ä¸²hash</h4>
<p>å®ç°ä»£ç </p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> base = <span class="number">499</span> <span class="comment">// åŸºæ•°</span></span><br><span class="line"><span class="type">int</span> pow[N];</span><br><span class="line"><span class="type">int</span> hash[N];</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">init</span><span class="params">(string s, <span class="type">int</span> n)</span></span>{</span><br><span class="line">   pow[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">   <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt; n; i++){</span><br><span class="line">       pow[i] = pow[i - <span class="number">1</span>] * base;</span><br><span class="line">   }</span><br><span class="line">   hase[<span class="number">0</span>] = base * pow[<span class="number">0</span>];</span><br><span class="line">   <span class="comment">// hash[i] = hash[i - 1] * base + (s[i] - 'a' + 1) * 1;</span></span><br><span class="line">   <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt; n; i++){</span><br><span class="line">       hash[i] = hash[i - <span class="number">1</span>] * base + (s[i] - <span class="string">'a'</span> + <span class="number">1</span>) * <span class="number">1</span>;</span><br><span class="line">   }</span><br><span class="line"></span><br><span class="line">   hase[l ... r] = hase[r] - hase[l] * base^(r - l + <span class="number">1</span>)</span><br><span class="line">}</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h2 id="æ‚é¡¹"><a class="markdownIt-Anchor" href="#æ‚é¡¹"></a> æ‚é¡¹</h2>
<h3 id="æ•°æ®"><a class="markdownIt-Anchor" href="#æ•°æ®"></a> æ•°æ®</h3>
<blockquote>
<p>é€šè¿‡æ•°æ®é‡çš„ç»™å‡ºï¼Œå¯ä»¥å¤§æ¦‚çš„ä¼°è®¡æ˜¯ä¸€ä¸ªä»€ä¹ˆæ—¶é—´å¤æ‚åº¦çš„ç®—æ³•ï¼Œä»è€Œæ¥æ¨æ¼”è¿™ä¸ªç®—æ³•çš„ç±»å‹ã€‚</p>
</blockquote>
<h3 id="æˆ–-å’Œ-ä¸"><a class="markdownIt-Anchor" href="#æˆ–-å’Œ-ä¸"></a> æˆ–( | ) å’Œ ä¸( &amp; )</h3>
<p>å¯¹äºæˆ–å’Œä¸çš„ä¸€äº›è®¨è®º</p>
<ul>
<li>æˆ– æ˜¯åªè¦æœ‰ä¸€ä¸ª 1ï¼Œæˆ–å€¼ ä¸­è¿™ä¸ªä½ç½®å°±ä¸€å®šä¼šå­˜åœ¨ä¸€ä¸ª 1</li>
</ul>
<p>å¯ä»¥è€ƒè™‘ è¿™ä¸ªä½ç½®çš„ ä¸€æ˜¯å¦éœ€è¦å­˜åœ¨æ¥è¿›è¡ŒæŒ‰ä½åˆ¤æ–­</p>
<ul>
<li>ä¸ æ˜¯éœ€è¦å…¨éƒ¨éƒ½æ˜¯1ï¼Œä¸å€¼ ä¸­è¿™ä¸ªä½ç½®å°±ä¸€å®šå­˜åœ¨ 1</li>
</ul>
<h3 id="æœ€å¤§å…¬çº¦æ•°-å’Œ-æœ€å°å…¬å€æ•°-çš„å…³ç³»"><a class="markdownIt-Anchor" href="#æœ€å¤§å…¬çº¦æ•°-å’Œ-æœ€å°å…¬å€æ•°-çš„å…³ç³»"></a> æœ€å¤§å…¬çº¦æ•° å’Œ æœ€å°å…¬å€æ•° çš„å…³ç³»</h3>
<ul>
<li>
<p><strong>é¢„å¤„ç†ä¸¤ä¸ªæ•°å­—çš„æœ€å¤§å…¬çº¦æ•°</strong></p>
<blockquote>
<p>è¿™ä¸ª <code>g[y][x%y]</code> å…¶å®å°±ç›¸å½“äºä¸€ä¸ª åŠ¨è§„çš„è½¬è¾—ç›¸é™¤æ³•çš„ä¸€ä¸ªåº”ç”¨</p>
</blockquote>
</li>
</ul>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span>(<span class="type">int</span> x = <span class="number">0</span>; x &lt; N; x ++) g[x][<span class="number">0</span>] = g[<span class="number">0</span>][x] = g[x][x] = x;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> x = <span class="number">1</span>; x &lt; N; x ++){</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> y = <span class="number">1</span>; y &lt; x; y++){</span><br><span class="line">        g[x][y] = g[y][x] = g[y][x % y];</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></table></figure>
<ul>
<li>ç‰¹æ®Šæ€§è´¨<br>
å¯¹äºä»»ä½•æ­£æ•´æ•° a1â€‹,a2â€‹,â€¦,anâ€‹ å’Œå®ƒä»¬çš„ GCD g=gcd(a1â€‹,a2â€‹,â€¦,anâ€‹)ï¼Œå¦‚æœæˆ‘ä»¬å®šä¹‰ä¸€ä¸ªæ–°æ•°ç»„ aiâ€²â€‹=aiâ€‹/gï¼Œé‚£ä¹ˆæ–°æ•°ç»„ a1â€²â€‹,a2â€²â€‹,â€¦,anâ€²â€‹ çš„<strong>æœ€å¤§å…¬çº¦æ•°å¿…ç„¶æ˜¯ 1</strong></li>
<li><code>lcm(a, b) * gcd(a, b) = a * b</code></li>
</ul>
<p>â€‹    <code>a * b = è´¨æ•°</code> â†’Â (<code>a = 1, b ä¸º è´¨æ•°</code>)</p>
<ul>
<li>åœ¨è¿›è¡Œ GCD çš„è¿‡ç¨‹ä¸­ï¼Œéšç€ ä¸æ–­è¿›è¡Œ GCDï¼ŒGCDçš„å€¼åªå¯èƒ½ä¸å˜æˆ–è€…å˜å°</li>
</ul>
<h3 id="å¼‚æˆ–å€¼"><a class="markdownIt-Anchor" href="#å¼‚æˆ–å€¼"></a> å¼‚æˆ–å€¼</h3>
<ol>
<li>é‡åˆ°å¼‚æˆ–å€¼å¯ä»¥è€ƒè™‘ æšä¸¾æ¯ä¸€ä¸ªä½ç½®ï¼Œçœ‹æ˜¯ä¸æ˜¯æ¯ä¸€ä¸ªä½ç½®çš„å˜åŒ–ä¼šå¯¹ç­”æ¡ˆæœ‰å½±å“ï¼ˆè§„å¾‹æ€§ï¼‰</li>
</ol>
<p><a target="_blank" rel="noopener" href="https://codeforces.com/problemset/problem/2094/E">2094E</a></p>
<h3 id="äºŒè¿›åˆ¶"><a class="markdownIt-Anchor" href="#äºŒè¿›åˆ¶"></a> äºŒè¿›åˆ¶</h3>
<ul>
<li>åœ¨äºŒè¿›åˆ¶çš„ä½ç§»ä¸­   <strong>1</strong>æ˜¯ä¼šè¢«é»˜è®¤å½“ä½œ (int)ç±»å‹çš„</li>
</ul>
<p>éœ€è¦ (1ll &lt;&lt; j) é˜²æ­¢æº¢å‡º</p>
<blockquote>
<p>å¦‚ ï¼ˆ1 &lt;&lt; j) ä¼šè¢«é»˜è®¤ä¸º <strong>int</strong> ç±»å‹</p>
</blockquote>
<h3 id="å›¾çš„åˆ›æ–°çŸ¥è¯†"><a class="markdownIt-Anchor" href="#å›¾çš„åˆ›æ–°çŸ¥è¯†"></a> å›¾çš„åˆ›æ–°çŸ¥è¯†</h3>
<ul>
<li>å­˜åœ¨å¤šä¸ª èµ·ç‚¹çš„æ—¶å€™ï¼Œå¯ä»¥è®¾ç½®è™šç‚¹ã€‚</li>
<li>é‡åˆ°ä¸­ä½æ•°ï¼ˆå¯¹é¡¶å †ï¼‰</li>
<li>æ ‘ä¸Šçš„ ä¸¤ä¸ªèŠ‚ç‚¹ä¹‹é—´ <strong>åªå­˜åœ¨ä¸€æ¡æœ€çŸ­è·¯å¾„</strong></li>
</ul>
<h3 id="äºŒåˆ†"><a class="markdownIt-Anchor" href="#äºŒåˆ†"></a> äºŒåˆ†</h3>
<ul>
<li>
<p>äºŒåˆ†æ˜¯ x å€¼æˆç«‹ <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>â‰¤</mo><mi>o</mi><mi>r</mi><mo>â‰¥</mo></mrow><annotation encoding="application/x-tex">\leq or \geq</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7719400000000001em;vertical-align:-0.13597em;"></span><span class="mrel">â‰¤</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.7719400000000001em;vertical-align:-0.13597em;"></span><span class="mord mathdefault">o</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">â‰¥</span></span></span></span> x çš„å€¼éƒ½æˆç«‹</p>
</li>
<li>
<p>äºŒåˆ†å…·æœ‰å•è°ƒæ€§ï¼š</p>
</li>
<li>
<p><strong>å½“ x æˆç«‹çš„ æ—¶å€™ï¼Œ å°äº x çš„å€¼éƒ½æ˜¯ä¸€å®šæˆç«‹çš„ã€‚</strong></p>
<h3 id="å¯¹äºæ•°ç»„ä¸­-ä¸åŒä½ç½®çš„å€¼-èƒ½å¦ç›¸äº’æŠµæ¶ˆå˜æˆå…¨æ˜¯-0-çš„æ•°ç»„"><a class="markdownIt-Anchor" href="#å¯¹äºæ•°ç»„ä¸­-ä¸åŒä½ç½®çš„å€¼-èƒ½å¦ç›¸äº’æŠµæ¶ˆå˜æˆå…¨æ˜¯-0-çš„æ•°ç»„"></a> å¯¹äºæ•°ç»„ä¸­ ä¸åŒä½ç½®çš„å€¼ èƒ½å¦ç›¸äº’æŠµæ¶ˆï¼Œå˜æˆå…¨æ˜¯ 0 çš„æ•°ç»„</h3>
</li>
</ul>
<p>å¦‚æœå½“å‰ å…ƒç´ çš„ä¸ªæ•°å¤§äºäº† æ•°ç»„çš„å’Œçš„ä¸€åŠ<strong>è‚¯å®šæ˜¯ä¸æˆç«‹çš„</strong></p>
<h3 id="åŒºé—´å¼‚æˆ–é—®é¢˜"><a class="markdownIt-Anchor" href="#åŒºé—´å¼‚æˆ–é—®é¢˜"></a> åŒºé—´å¼‚æˆ–é—®é¢˜</h3>
<p>å¯¹äºä¸€ä¸ªåŒºé—´ [l, r] æ¥è¯´, <code>l ^ r</code> ä¸­çš„ æœ€é«˜ä½çš„ 1ï¼Œç›¸å½“äº æœ€é«˜ä½åé¢çš„ 1éƒ½å¯ä»¥ç”± [l, r] ä¸­çš„å€¼å¼‚æˆ–å¾—åˆ°ã€‚</p>
<h3 id="1"><a class="markdownIt-Anchor" href="#1"></a> <strong>1</strong></h3>
<p><strong>åœ¨è®¡ç®—æœºä¸­ä¼šè‡ªåŠ¨è¢«é»˜è®¤è®¾ç½®ä¸º int å‹ï¼Œæ‰€ä»¥å¦‚æœæœ‰long long çš„è¯ï¼Œéœ€è¦ æ”¹å˜ 1 çš„ç±»å‹, (long long)</strong></p>
<h3 id="çŸ©é˜µé—®é¢˜"><a class="markdownIt-Anchor" href="#çŸ©é˜µé—®é¢˜"></a> çŸ©é˜µé—®é¢˜</h3>
<h4 id="çŸ©é˜µ-è¡Œåˆ—å¼‚æˆ–"><a class="markdownIt-Anchor" href="#çŸ©é˜µ-è¡Œåˆ—å¼‚æˆ–"></a> çŸ©é˜µ è¡Œåˆ—å¼‚æˆ–</h4>
<p><strong>çŸ©é˜µæ„é€ </strong></p>
<ul>
<li>é€šç”¨æ€è€ƒï¼šæ‰¾ä¸€ä¸‹ æ€»çš„å¼‚æˆ– çš„å€¼çš„å…³ç³»</li>
<li>å°è¯•å»æ„é€ çŸ©é˜µ</li>
</ul>
<h3 id="å…¬çº¦æ•°-å› å­é—®é¢˜"><a class="markdownIt-Anchor" href="#å…¬çº¦æ•°-å› å­é—®é¢˜"></a> å…¬çº¦æ•° + å› å­é—®é¢˜</h3>
<p>ç»å¸¸é‡åˆ°å…¬çº¦æ•°å’Œå› å­çš„é—®é¢˜,ä¹Ÿå­˜åœ¨ä¸€äº›å¸¸è§çš„ç»“è®º:</p>
<ol>
<li>
<p>nä¸ªæ•°å­—çš„å…¬å› å­æ•°é‡å¾ˆå°‘</p>
</li>
<li>
<p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>a</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">a_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> å¾€å‰èµ°100æ­¥ä»¥å†…,è‚¯å®šæœ‰ä¸æ˜¯è‡ªå·±çš„å› å­çš„æ•°å­—</p>
</li>
</ol>
</div><div class="article-licensing box"><div class="licensing-title"><p>ç®—æ³•çŸ¥è¯†å†Œ</p><p><a href="http://whalefall.fun/2025/05/06/ç®—æ³•æ¿å­/">http://whalefall.fun/2025/05/06/ç®—æ³•æ¿å­/</a></p></div><div class="licensing-meta level is-mobile"><div class="level-left"><div class="level-item is-narrow"><div><h6>ä½œè€…</h6><p>Jiely</p></div></div><div class="level-item is-narrow"><div><h6>å‘å¸ƒäº</h6><p>2025-05-06</p></div></div><div class="level-item is-narrow"><div><h6>æ›´æ–°äº</h6><p>2025-09-21</p></div></div><div class="level-item is-narrow"><div><h6>è®¸å¯åè®®</h6><p><a class="icons" rel="noopener" target="_blank" title="Creative Commons" href="https://creativecommons.org/"><i class="icon fab fa-creative-commons"></i></a><a class="icons" rel="noopener" target="_blank" title="Attribution" href="https://creativecommons.org/licenses/by/4.0/"><i class="icon fab fa-creative-commons-by"></i></a><a class="icons" rel="noopener" target="_blank" title="Noncommercial" href="https://creativecommons.org/licenses/by-nc/4.0/"><i class="icon fab fa-creative-commons-nc"></i></a></p></div></div></div></div></div><div class="article-tags is-size-7 mb-4"><span class="mr-2">#</span><a class="link-muted mr-2" rel="tag" href="/tags/%E6%B2%89%E6%B7%80/">æ²‰æ·€</a></div><!--!--></article></div><!--!--><div class="card"><nav class="post-navigation mt-4 level is-mobile card-content"><div class="level-start"><a class="article-nav-prev level level-item link-muted" href="/2025/05/08/Typora-%E8%BD%AC-obisidian/"><i class="level-item fas fa-chevron-left"></i><span class="level-item">Typora to Obisidian</span></a></div><div class="level-end"><a class="article-nav-next level level-item link-muted" href="/2025/04/30/%E5%85%B3%E4%BA%8E%E8%BF%87%E5%8E%BB/"><span class="level-item">å…³äºè¿‡å»</span><i class="level-item fas fa-chevron-right"></i></a></div></nav></div><div class="card" id="comments"><div class="card-content"><h3 class="title is-5">è¯„è®º</h3><div class="content twikoo" id="twikoo"></div><script src="https://cdn.jsdelivr.net/npm/twikoo@1.6.44/dist/twikoo.all.min.js"></script><script>twikoo.init({
            envId: 'https://visionary-gecko-25af79.netlify.app/.netlify/functions/twikoo',
            
            lang: "zh-CN",
            onCommentLoaded: function () {
              var commentContents = document.getElementsByClassName('tk-content');
              for (var i = 0; i < commentContents.length; i++) {
                var commentItem = commentContents[i];
                var imgEls = commentItem.getElementsByTagName('img');
                if (imgEls.length > 0) {
                  for (var j = 0; j < imgEls.length; j++) {
                    var imgEl = imgEls[j];
                    var aEl = document.createElement('a');
                    aEl.setAttribute('class', 'tk-lg-link');
                    aEl.setAttribute('href', imgEl.getAttribute('src'));
                    aEl.setAttribute('data-src', imgEl.getAttribute('src'));
                    aEl.appendChild(imgEl.cloneNode(false));
                    imgEl.parentNode.insertBefore(aEl, imgEl.nextSibling);
                    imgEl.remove();
                  }
                  if (typeof $.fn.lightGallery === 'function') {
                    $(commentItem).lightGallery({
                      selector: '.tk-lg-link'
                    });
                  }
                }
                handleThirdPartyLink && handleThirdPartyLink(commentItem);
              }
            }
        });</script></div></div></div><style>.column.column-left,.column.column-right{display:none}</style><div class="column column-left is-4-tablet is-4-desktop is-3-widescreen  order-1"><div class="card widget toc-widget" id="toc" data-type="toc"><div class="toc-header"><h3 class="menu-label"><i class="fas fa-list toc-icon"></i>ç›®å½•</h3></div><div class="toc-content"><ul class="toc-list toc-level-1"><li class="toc-item toc-h2"><a class="toc-link" href="#ç›¸å…³å­¦ä¹ æ–¹å‘æ€è€ƒ" data-level="2" data-target="ç›¸å…³å­¦ä¹ æ–¹å‘æ€è€ƒ"><span class="toc-index">1</span><span class="toc-text"> ç›¸å…³å­¦ä¹ æ–¹å‘æ€è€ƒ</span></a><ul class="toc-list toc-level-2"><li class="toc-item toc-h3"><a class="toc-link" href="#2025818" data-level="3" data-target="2025818"><span class="toc-index">1.1</span><span class="toc-text"> 2025.8.18</span></a></li><li class="toc-item toc-h3"><a class="toc-link" href="#2025821" data-level="3" data-target="2025821"><span class="toc-index">1.2</span><span class="toc-text"> 2025.8.21</span></a></li><li class="toc-item toc-h3"><a class="toc-link" href="#2025827" data-level="3" data-target="2025827"><span class="toc-index">1.3</span><span class="toc-text"> 2025.8.27</span></a></li></ul></li><li class="toc-item toc-h2"><a class="toc-link" href="#åŸºç¡€ç®—æ³•" data-level="2" data-target="åŸºç¡€ç®—æ³•"><span class="toc-index">2</span><span class="toc-text"> åŸºç¡€ç®—æ³•</span></a><ul class="toc-list toc-level-2"><li class="toc-item toc-h3"><a class="toc-link" href="#å•è°ƒé˜Ÿåˆ—" data-level="3" data-target="å•è°ƒé˜Ÿåˆ—"><span class="toc-index">2.1</span><span class="toc-text"> å•è°ƒé˜Ÿåˆ—</span></a></li><li class="toc-item toc-h3"><a class="toc-link" href="#å•è°ƒæ ˆ" data-level="3" data-target="å•è°ƒæ ˆ"><span class="toc-index">2.2</span><span class="toc-text"> å•è°ƒæ ˆ</span></a></li><li class="toc-item toc-h3"><a class="toc-link" href="#é€†åºå¯¹" data-level="3" data-target="é€†åºå¯¹"><span class="toc-index">2.3</span><span class="toc-text"> é€†åºå¯¹</span></a></li><li class="toc-item toc-h3"><a class="toc-link" href="#å½’å¹¶åˆ†æ²»" data-level="3" data-target="å½’å¹¶åˆ†æ²»"><span class="toc-index">2.4</span><span class="toc-text"> å½’å¹¶åˆ†æ²»</span></a></li><li class="toc-item toc-h3"><a class="toc-link" href="#éšæœºå¿«æ’" data-level="3" data-target="éšæœºå¿«æ’"><span class="toc-index">2.5</span><span class="toc-text"> éšæœºå¿«æ’</span></a></li><li class="toc-item toc-h3"><a class="toc-link" href="#ç¦»æ•£åŒ–" data-level="3" data-target="ç¦»æ•£åŒ–"><span class="toc-index">2.6</span><span class="toc-text"> ç¦»æ•£åŒ–</span></a></li><li class="toc-item toc-h3"><a class="toc-link" href="#ç±»å¹¶æŸ¥é›†" data-level="3" data-target="ç±»å¹¶æŸ¥é›†"><span class="toc-index">2.7</span><span class="toc-text"> ç±»å¹¶æŸ¥é›†</span></a></li><li class="toc-item toc-h3"><a class="toc-link" href="#å¿«é€Ÿå¹‚" data-level="3" data-target="å¿«é€Ÿå¹‚"><span class="toc-index">2.8</span><span class="toc-text"> å¿«é€Ÿå¹‚</span></a><ul class="toc-list toc-level-3"><li class="toc-item toc-h4"><a class="toc-link" href="#æ— -mod" data-level="4" data-target="æ— -mod"><span class="toc-index">2.8.1</span><span class="toc-text"> æ—  mod</span></a></li><li class="toc-item toc-h4"><a class="toc-link" href="#æœ‰mod" data-level="4" data-target="æœ‰mod"><span class="toc-index">2.8.2</span><span class="toc-text"> æœ‰mod</span></a></li></ul></li><li class="toc-item toc-h3"><a class="toc-link" href="#ä¹˜æ³•é€†å…ƒ" data-level="3" data-target="ä¹˜æ³•é€†å…ƒ"><span class="toc-index">2.9</span><span class="toc-text"> ä¹˜æ³•é€†å…ƒ</span></a><ul class="toc-list toc-level-3"><li class="toc-item toc-h4"><a class="toc-link" href="#çº¿æ€§" data-level="4" data-target="çº¿æ€§"><span class="toc-index">2.9.1</span><span class="toc-text"> çº¿æ€§</span></a></li><li class="toc-item toc-h4"><a class="toc-link" href="#æ‰©å±•æ¬§å‡ é‡Œå¾—" data-level="4" data-target="æ‰©å±•æ¬§å‡ é‡Œå¾—"><span class="toc-index">2.9.2</span><span class="toc-text"> æ‰©å±•æ¬§å‡ é‡Œå¾—</span></a></li><li class="toc-item toc-h4"><a class="toc-link" href="#è´¹é©¬å°" data-level="4" data-target="è´¹é©¬å°"><span class="toc-index">2.9.3</span><span class="toc-text"> è´¹é©¬å°</span></a></li></ul></li></ul></li><li class="toc-item toc-h2"><a class="toc-link" href="#æ•°æ®ç»“æ„" data-level="2" data-target="æ•°æ®ç»“æ„"><span class="toc-index">3</span><span class="toc-text"> æ•°æ®ç»“æ„</span></a><ul class="toc-list toc-level-2"><li class="toc-item toc-h3"><a class="toc-link" href="#æŠ˜åŠæœç´¢" data-level="3" data-target="æŠ˜åŠæœç´¢"><span class="toc-index">3.1</span><span class="toc-text"> æŠ˜åŠæœç´¢</span></a></li><li class="toc-item toc-h3"><a class="toc-link" href="#å¹¶æŸ¥é›†" data-level="3" data-target="å¹¶æŸ¥é›†"><span class="toc-index">3.2</span><span class="toc-text"> å¹¶æŸ¥é›†</span></a><ul class="toc-list toc-level-3"><li class="toc-item toc-h4"><a class="toc-link" href="#åŸºç¡€å¹¶æŸ¥é›†" data-level="4" data-target="åŸºç¡€å¹¶æŸ¥é›†"><span class="toc-index">3.2.1</span><span class="toc-text"> åŸºç¡€å¹¶æŸ¥é›†</span></a></li><li class="toc-item toc-h4"><a class="toc-link" href="#å¸¦æƒå¹¶æŸ¥é›†" data-level="4" data-target="å¸¦æƒå¹¶æŸ¥é›†"><span class="toc-index">3.2.2</span><span class="toc-text"> å¸¦æƒå¹¶æŸ¥é›†</span></a></li></ul></li><li class="toc-item toc-h3"><a class="toc-link" href="#å‰ç¼€å’Œ-å·®åˆ†" data-level="3" data-target="å‰ç¼€å’Œ-å·®åˆ†"><span class="toc-index">3.3</span><span class="toc-text"> å‰ç¼€å’Œ + å·®åˆ†</span></a><ul class="toc-list toc-level-3"><li class="toc-item toc-h4"><a class="toc-link" href="#æ ‘ä¸Šå‰ç¼€å’Œ" data-level="4" data-target="æ ‘ä¸Šå‰ç¼€å’Œ"><span class="toc-index">3.3.1</span><span class="toc-text"> æ ‘ä¸Šå‰ç¼€å’Œ</span></a></li><li class="toc-item toc-h4"><a class="toc-link" href="#æ ‘ä¸Šå·®åˆ†" data-level="4" data-target="æ ‘ä¸Šå·®åˆ†"><span class="toc-index">3.3.2</span><span class="toc-text"> æ ‘ä¸Šå·®åˆ†</span></a></li></ul></li><li class="toc-item toc-h3"><a class="toc-link" href="#çº¿æ®µæ ‘" data-level="3" data-target="çº¿æ®µæ ‘"><span class="toc-index">3.4</span><span class="toc-text"> çº¿æ®µæ ‘</span></a><ul class="toc-list toc-level-3"><li class="toc-item toc-h4"><a class="toc-link" href="#çº¿æ®µæ ‘åŒºé—´åˆå¹¶" data-level="4" data-target="çº¿æ®µæ ‘åŒºé—´åˆå¹¶"><span class="toc-index">3.4.1</span><span class="toc-text"> çº¿æ®µæ ‘åŒºé—´åˆå¹¶</span></a></li><li class="toc-item toc-h4"><a class="toc-link" href="#å¼€ç‚¹çº¿æ®µæ ‘" data-level="4" data-target="å¼€ç‚¹çº¿æ®µæ ‘"><span class="toc-index">3.4.2</span><span class="toc-text"> å¼€ç‚¹çº¿æ®µæ ‘</span></a></li><li class="toc-item toc-h4"><a class="toc-link" href="#çº¿æ®µæ ‘å†å²æœ€å€¼æ“ä½œ" data-level="4" data-target="çº¿æ®µæ ‘å†å²æœ€å€¼æ“ä½œ"><span class="toc-index">3.4.3</span><span class="toc-text"> çº¿æ®µæ ‘å†å²æœ€å€¼æ“ä½œ</span></a></li></ul></li><li class="toc-item toc-h3"><a class="toc-link" href="#ç¬›å¡å°”æ ‘" data-level="3" data-target="ç¬›å¡å°”æ ‘"><span class="toc-index">3.5</span><span class="toc-text"> ç¬›å¡å°”æ ‘</span></a></li><li class="toc-item toc-h3"><a class="toc-link" href="#å€å¢ç®—æ³•-stè¡¨" data-level="3" data-target="å€å¢ç®—æ³•-stè¡¨"><span class="toc-index">3.6</span><span class="toc-text"> å€å¢ç®—æ³• + STè¡¨</span></a></li></ul></li><li class="toc-item toc-h2"><a class="toc-link" href="#å›¾è®º" data-level="2" data-target="å›¾è®º"><span class="toc-index">4</span><span class="toc-text"> å›¾è®º</span></a><ul class="toc-list toc-level-2"><li class="toc-item toc-h3"><a class="toc-link" href="#æœ€çŸ­è·¯é—®é¢˜" data-level="3" data-target="æœ€çŸ­è·¯é—®é¢˜"><span class="toc-index">4.1</span><span class="toc-text"> æœ€çŸ­è·¯é—®é¢˜</span></a></li><li class="toc-item toc-h3"><a class="toc-link" href="#æ‹“æ‰‘æ’åº" data-level="3" data-target="æ‹“æ‰‘æ’åº"><span class="toc-index">4.2</span><span class="toc-text"> æ‹“æ‰‘æ’åº</span></a></li><li class="toc-item toc-h3"><a class="toc-link" href="#ford-bellman-ford" data-level="3" data-target="ford-bellman-ford"><span class="toc-index">4.3</span><span class="toc-text"> ford + Bellman-Ford</span></a></li><li class="toc-item toc-h3"><a class="toc-link" href="#è´Ÿç¯-å·®åˆ†çº¦æŸ" data-level="3" data-target="è´Ÿç¯-å·®åˆ†çº¦æŸ"><span class="toc-index">4.4</span><span class="toc-text"> è´Ÿç¯ å·®åˆ†çº¦æŸ</span></a></li><li class="toc-item toc-h3"><a class="toc-link" href="#æœ€å°ç¯é—®é¢˜" data-level="3" data-target="æœ€å°ç¯é—®é¢˜"><span class="toc-index">4.5</span><span class="toc-text"> æœ€å°ç¯é—®é¢˜</span></a></li><li class="toc-item toc-h3"><a class="toc-link" href="#åŒä½™æœ€çŸ­è·¯" data-level="3" data-target="åŒä½™æœ€çŸ­è·¯"><span class="toc-index">4.6</span><span class="toc-text"> åŒä½™æœ€çŸ­è·¯</span></a></li></ul></li><li class="toc-item toc-h2"><a class="toc-link" href="#æ•°å­¦" data-level="2" data-target="æ•°å­¦"><span class="toc-index">5</span><span class="toc-text"> æ•°å­¦</span></a><ul class="toc-list toc-level-2"><li class="toc-item toc-h3"><a class="toc-link" href="#åŸºç¡€æ•°è®º" data-level="3" data-target="åŸºç¡€æ•°è®º"><span class="toc-index">5.1</span><span class="toc-text"> åŸºç¡€æ•°è®º</span></a></li><li class="toc-item toc-h3"><a class="toc-link" href="#é«˜æ–¯æ¶ˆå…ƒ" data-level="3" data-target="é«˜æ–¯æ¶ˆå…ƒ"><span class="toc-index">5.2</span><span class="toc-text"> é«˜æ–¯æ¶ˆå…ƒ</span></a></li><li class="toc-item toc-h3"><a class="toc-link" href="#çº¿æ€§åŸº" data-level="3" data-target="çº¿æ€§åŸº"><span class="toc-index">5.3</span><span class="toc-text"> çº¿æ€§åŸº</span></a><ul class="toc-list toc-level-3"><li class="toc-item toc-h4"><a class="toc-link" href="#æ±‚-å¼‚æˆ–-ç¬¬-k-å°å€¼" data-level="4" data-target="æ±‚-å¼‚æˆ–-ç¬¬-k-å°å€¼"><span class="toc-index">5.3.1</span><span class="toc-text"> æ±‚ å¼‚æˆ– ç¬¬ k å°å€¼</span></a></li></ul></li><li class="toc-item toc-h3"><a class="toc-link" href="#äºŒé¡¹å¼å®šç†" data-level="3" data-target="äºŒé¡¹å¼å®šç†"><span class="toc-index">5.4</span><span class="toc-text"> äºŒé¡¹å¼å®šç†</span></a></li><li class="toc-item toc-h3"><a class="toc-link" href="#æ‰©å±•æ¬§å‡ é‡Œå¾—-2" data-level="3" data-target="æ‰©å±•æ¬§å‡ é‡Œå¾—-2"><span class="toc-index">5.5</span><span class="toc-text"> æ‰©å±•æ¬§å‡ é‡Œå¾—</span></a><ul class="toc-list toc-level-3"><li class="toc-item toc-h4"><a class="toc-link" href="#ä¸­å›½å‰©ä½™å®šç†" data-level="4" data-target="ä¸­å›½å‰©ä½™å®šç†"><span class="toc-index">5.5.1</span><span class="toc-text"> ä¸­å›½å‰©ä½™å®šç†</span></a></li></ul></li><li class="toc-item toc-h3"><a class="toc-link" href="#é¸½å·¢åŸç†" data-level="3" data-target="é¸½å·¢åŸç†"><span class="toc-index">5.6</span><span class="toc-text"> é¸½å·¢åŸç†</span></a></li></ul></li><li class="toc-item toc-h2"><a class="toc-link" href="#åŠ¨æ€è§„åˆ’" data-level="2" data-target="åŠ¨æ€è§„åˆ’"><span class="toc-index">6</span><span class="toc-text"> åŠ¨æ€è§„åˆ’</span></a><ul class="toc-list toc-level-2"><li class="toc-item toc-h3"><a class="toc-link" href="#åŒºé—´dp" data-level="3" data-target="åŒºé—´dp"><span class="toc-index">6.1</span><span class="toc-text"> åŒºé—´DP</span></a></li></ul></li><li class="toc-item toc-h2"><a class="toc-link" href="#è®¡ç®—å‡ ä½•" data-level="2" data-target="è®¡ç®—å‡ ä½•"><span class="toc-index">7</span><span class="toc-text"> è®¡ç®—å‡ ä½•</span></a><ul class="toc-list toc-level-2"><li class="toc-item toc-h3"><a class="toc-link" href="#æŠ˜å°ºå®šç†" data-level="3" data-target="æŠ˜å°ºå®šç†"><span class="toc-index">7.1</span><span class="toc-text"> æŠ˜å°ºå®šç†</span></a></li><li class="toc-item toc-h3"><a class="toc-link" href="#åšå¼ˆè®º" data-level="3" data-target="åšå¼ˆè®º"><span class="toc-index">7.2</span><span class="toc-text"> åšå¼ˆè®º</span></a></li></ul></li><li class="toc-item toc-h2"><a class="toc-link" href="#å­—ç¬¦ä¸²" data-level="2" data-target="å­—ç¬¦ä¸²"><span class="toc-index">8</span><span class="toc-text"> å­—ç¬¦ä¸²</span></a><ul class="toc-list toc-level-2"><li class="toc-item toc-h3"><a class="toc-link" href="#å­—ç¬¦ä¸²å“ˆå¸Œ" data-level="3" data-target="å­—ç¬¦ä¸²å“ˆå¸Œ"><span class="toc-index">8.1</span><span class="toc-text"> å­—ç¬¦ä¸²å“ˆå¸Œ</span></a><ul class="toc-list toc-level-3"><li class="toc-item toc-h4"><a class="toc-link" href="#è·å¾—å­ä¸²hash" data-level="4" data-target="è·å¾—å­ä¸²hash"><span class="toc-index">8.1.1</span><span class="toc-text"> è·å¾—å­ä¸²hash</span></a></li></ul></li></ul></li><li class="toc-item toc-h2"><a class="toc-link" href="#æ‚é¡¹" data-level="2" data-target="æ‚é¡¹"><span class="toc-index">9</span><span class="toc-text"> æ‚é¡¹</span></a><ul class="toc-list toc-level-2"><li class="toc-item toc-h3"><a class="toc-link" href="#æ•°æ®" data-level="3" data-target="æ•°æ®"><span class="toc-index">9.1</span><span class="toc-text"> æ•°æ®</span></a></li><li class="toc-item toc-h3"><a class="toc-link" href="#æˆ–-å’Œ-ä¸" data-level="3" data-target="æˆ–-å’Œ-ä¸"><span class="toc-index">9.2</span><span class="toc-text"> æˆ–( | ) å’Œ ä¸( &amp; )</span></a></li><li class="toc-item toc-h3"><a class="toc-link" href="#æœ€å¤§å…¬çº¦æ•°-å’Œ-æœ€å°å…¬å€æ•°-çš„å…³ç³»" data-level="3" data-target="æœ€å¤§å…¬çº¦æ•°-å’Œ-æœ€å°å…¬å€æ•°-çš„å…³ç³»"><span class="toc-index">9.3</span><span class="toc-text"> æœ€å¤§å…¬çº¦æ•° å’Œ æœ€å°å…¬å€æ•° çš„å…³ç³»</span></a></li><li class="toc-item toc-h3"><a class="toc-link" href="#å¼‚æˆ–å€¼" data-level="3" data-target="å¼‚æˆ–å€¼"><span class="toc-index">9.4</span><span class="toc-text"> å¼‚æˆ–å€¼</span></a></li><li class="toc-item toc-h3"><a class="toc-link" href="#äºŒè¿›åˆ¶" data-level="3" data-target="äºŒè¿›åˆ¶"><span class="toc-index">9.5</span><span class="toc-text"> äºŒè¿›åˆ¶</span></a></li><li class="toc-item toc-h3"><a class="toc-link" href="#å›¾çš„åˆ›æ–°çŸ¥è¯†" data-level="3" data-target="å›¾çš„åˆ›æ–°çŸ¥è¯†"><span class="toc-index">9.6</span><span class="toc-text"> å›¾çš„åˆ›æ–°çŸ¥è¯†</span></a></li><li class="toc-item toc-h3"><a class="toc-link" href="#äºŒåˆ†" data-level="3" data-target="äºŒåˆ†"><span class="toc-index">9.7</span><span class="toc-text"> äºŒåˆ†</span></a></li><li class="toc-item toc-h3"><a class="toc-link" href="#å¯¹äºæ•°ç»„ä¸­-ä¸åŒä½ç½®çš„å€¼-èƒ½å¦ç›¸äº’æŠµæ¶ˆå˜æˆå…¨æ˜¯-0-çš„æ•°ç»„" data-level="3" data-target="å¯¹äºæ•°ç»„ä¸­-ä¸åŒä½ç½®çš„å€¼-èƒ½å¦ç›¸äº’æŠµæ¶ˆå˜æˆå…¨æ˜¯-0-çš„æ•°ç»„"><span class="toc-index">9.8</span><span class="toc-text"> å¯¹äºæ•°ç»„ä¸­ ä¸åŒä½ç½®çš„å€¼ èƒ½å¦ç›¸äº’æŠµæ¶ˆï¼Œå˜æˆå…¨æ˜¯ 0 çš„æ•°ç»„</span></a></li><li class="toc-item toc-h3"><a class="toc-link" href="#åŒºé—´å¼‚æˆ–é—®é¢˜" data-level="3" data-target="åŒºé—´å¼‚æˆ–é—®é¢˜"><span class="toc-index">9.9</span><span class="toc-text"> åŒºé—´å¼‚æˆ–é—®é¢˜</span></a></li><li class="toc-item toc-h3"><a class="toc-link" href="#1" data-level="3" data-target="1"><span class="toc-index">9.10</span><span class="toc-text"> 1</span></a></li><li class="toc-item toc-h3"><a class="toc-link" href="#çŸ©é˜µé—®é¢˜" data-level="3" data-target="çŸ©é˜µé—®é¢˜"><span class="toc-index">9.11</span><span class="toc-text"> çŸ©é˜µé—®é¢˜</span></a><ul class="toc-list toc-level-3"><li class="toc-item toc-h4"><a class="toc-link" href="#çŸ©é˜µ-è¡Œåˆ—å¼‚æˆ–" data-level="4" data-target="çŸ©é˜µ-è¡Œåˆ—å¼‚æˆ–"><span class="toc-index">9.11.1</span><span class="toc-text"> çŸ©é˜µ è¡Œåˆ—å¼‚æˆ–</span></a></li></ul></li><li class="toc-item toc-h3"><a class="toc-link" href="#å…¬çº¦æ•°-å› å­é—®é¢˜" data-level="3" data-target="å…¬çº¦æ•°-å› å­é—®é¢˜"><span class="toc-index">9.12</span><span class="toc-text"> å…¬çº¦æ•° + å› å­é—®é¢˜</span></a></li></ul></li></ul></div><style>
            .toc-widget {
                position: sticky;
                top: 1rem;
                max-height: calc(100vh - 2rem);
                display: flex;
                flex-direction: column;
                border-radius: 6px;
                box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
                overflow: hidden;
                background: white;
                border: 1px solid rgba(0, 0, 0, 0.08);
            }
            
            .toc-header {
                flex-shrink: 0;
                padding: 1.25rem 1.25rem 0.75rem;
                background: white;
                border-bottom: 1px solid rgba(0, 0, 0, 0.06);
            }
            
            .toc-header .menu-label {
                margin: 0;
                font-size: 1rem;
                font-weight: 600;
                color: #363636;
                display: flex;
                align-items: center;
            }
            
            .toc-header .toc-icon {
                margin-right: 0.5rem;
                color: #4a90e2;
                font-size: 1rem;
            }
            
            .toc-content {
                flex: 1;
                overflow-y: auto;
                padding: 0.75rem 0 1.25rem;
                background: white;
                max-height: 450px;
                position: relative;
            }
            
            .toc-content::-webkit-scrollbar {
                width: 4px;
            }
            
            .toc-content::-webkit-scrollbar-track {
                background: transparent;
            }
            
            .toc-content::-webkit-scrollbar-thumb {
                background: rgba(0, 0, 0, 0.15);
                border-radius: 2px;
            }
            
            .toc-content::-webkit-scrollbar-thumb:hover {
                background: rgba(0, 0, 0, 0.25);
            }
            
            .toc-list {
                list-style: none;
                margin: 0;
                padding: 0;
                position: relative;
            }
            
            .toc-item {
                margin: 0;
                position: relative;
            }
            
            .toc-link {
                display: flex;
                align-items: flex-start;
                padding: 0.4rem 1.25rem;
                text-decoration: none;
                color: #4a4a4a;
                transition: all 0.2s ease;
                line-height: 1.4;
                position: relative;
            }
            
            .toc-link:hover {
                color: #4a90e2;
                background-color: rgba(74, 144, 226, 0.05);
            }
            
            .toc-link.is-active {
                color: #4a90e2;
                background-color: rgba(74, 144, 226, 0.08);
                font-weight: 500;
                border-left: 3px solid #4a90e2;
                padding-left: calc(1.25rem - 3px);
            }
            
            .toc-index {
                color: #4a90e2;
                font-weight: 500;
                margin-right: 0.5rem;
                font-size: 0.85rem;
                flex-shrink: 0;
                min-width: 2rem;
            }
            
            .toc-text {
                flex: 1;
                overflow: hidden;
                text-overflow: ellipsis;
                display: -webkit-box;
                -webkit-line-clamp: 2;
                -webkit-box-orient: vertical;
            }
            
            /* H1 æ ‡é¢˜ - ä¸»æ ‡é¢˜ */
            .toc-h1 .toc-link {
                font-size: 0.95rem;
                font-weight: 600;
                padding: 0.6rem 1.25rem;
                margin: 0.1rem 0;
                border-left: 2px solid transparent;
            }
            
            .toc-h1 .toc-link.is-active {
                border-left: 3px solid #4a90e2;
                padding-left: calc(1.25rem - 3px);
                background-color: rgba(74, 144, 226, 0.1);
            }
            
            .toc-h1 .toc-index {
                font-size: 0.9rem;
                font-weight: 600;
                color: #4a90e2;
            }
            
            /* H2 æ ‡é¢˜ - äºŒçº§æ ‡é¢˜ */
            .toc-h2 {
                position: relative;
            }
            
            .toc-h2::before {
                content: '';
                position: absolute;
                left: 1.5rem;
                top: 0;
                bottom: 0;
                width: 1px;
                background: rgba(74, 144, 226, 0.2);
                z-index: 0;
            }
            
            .toc-h2 .toc-link {
                font-size: 0.9rem;
                padding-left: 2.25rem;
                position: relative;
            }
            
            .toc-h2 .toc-link::before {
                content: '';
                position: absolute;
                left: 1.25rem;
                top: 50%;
                width: 6px;
                height: 6px;
                background: #4a90e2;
                border-radius: 50%;
                transform: translateY(-50%);
                opacity: 0.6;
            }
            
            .toc-h2 .toc-link:hover::before,
            .toc-h2 .toc-link.is-active::before {
                opacity: 1;
            }
            
            .toc-h2 .toc-link.is-active {
                padding-left: calc(2.25rem - 3px);
            }
            
            /* H3 æ ‡é¢˜ - ä¸‰çº§æ ‡é¢˜ */
            .toc-h3 {
                position: relative;
            }
            
            .toc-h3::before {
                content: '';
                position: absolute;
                left: 2.25rem;
                top: 0;
                bottom: 0;
                width: 1px;
                background: rgba(74, 144, 226, 0.15);
                z-index: 0;
            }
            
            .toc-h3 .toc-link {
                font-size: 0.85rem;
                padding-left: 3rem;
                color: #6a6a6a;
                position: relative;
            }
            
            .toc-h3 .toc-link::before {
                content: '';
                position: absolute;
                left: 2rem;
                top: 50%;
                width: 4px;
                height: 4px;
                background: rgba(74, 144, 226, 0.6);
                border-radius: 50%;
                transform: translateY(-50%);
            }
            
            .toc-h3 .toc-link:hover::before,
            .toc-h3 .toc-link.is-active::before {
                background: #4a90e2;
            }
            
            .toc-h3 .toc-link.is-active {
                padding-left: calc(3rem - 3px);
                color: #4a90e2;
            }
            
            .toc-h3 .toc-index {
                color: rgba(74, 144, 226, 0.8);
                font-size: 0.8rem;
            }
            
            /* H4, H5, H6 æ ‡é¢˜ - æ›´æ·±å±‚çº§ */
            .toc-h4 .toc-link,
            .toc-h5 .toc-link,
            .toc-h6 .toc-link {
                font-size: 0.8rem;
                padding-left: 3.75rem;
                color: #888;
                position: relative;
            }
            
            .toc-h4 .toc-link::before,
            .toc-h5 .toc-link::before,
            .toc-h6 .toc-link::before {
                content: 'â€¢';
                position: absolute;
                left: 2.75rem;
                top: 50%;
                font-size: 8px;
                color: rgba(74, 144, 226, 0.4);
                transform: translateY(-50%);
            }
            
            .toc-h4 .toc-link:hover::before,
            .toc-h5 .toc-link:hover::before,
            .toc-h6 .toc-link:hover::before,
            .toc-h4 .toc-link.is-active::before,
            .toc-h5 .toc-link.is-active::before,
            .toc-h6 .toc-link.is-active::before {
                color: #4a90e2;
            }
            
            .toc-h4 .toc-link.is-active,
            .toc-h5 .toc-link.is-active,
            .toc-h6 .toc-link.is-active {
                padding-left: calc(3.75rem - 3px);
                color: #4a90e2;
            }
            
            .toc-h4 .toc-index,
            .toc-h5 .toc-index,
            .toc-h6 .toc-index {
                color: rgba(74, 144, 226, 0.7);
                font-size: 0.75rem;
            }
            
            /* åµŒå¥—åˆ—è¡¨å±‚æ¬¡æ„Ÿ */
            .toc-level-1 {
                margin-top: 0;
            }
            
            .toc-level-2,
            .toc-level-3,
            .toc-level-4,
            .toc-level-5,
            .toc-level-6 {
                margin: 0.2rem 0;
                padding-left: 0;
            }
            
            /* åˆ†ç»„é—´è· */
            .toc-h1:not(:first-child) {
                margin-top: 0.5rem;
                border-top: 1px solid rgba(0, 0, 0, 0.06);
                padding-top: 0.5rem;
            }
            
            /* å“åº”å¼è®¾è®¡ */
            @media (max-width: 768px) {
                .toc-widget {
                    max-height: 300px;
                }
                
                .toc-content {
                    max-height: 250px;
                }
                
                .toc-h2 .toc-link {
                    padding-left: 2rem;
                }
                
                .toc-h3 .toc-link {
                    padding-left: 2.5rem;
                }
                
                .toc-h4 .toc-link,
                .toc-h5 .toc-link,
                .toc-h6 .toc-link {
                    padding-left: 3rem;
                }
            }
        </style><script src="/js/toc.js" defer></script><script>
            (function() {
                let currentActiveLink = null;
                let headings = [];
                let tocLinks = [];
                let isUserScrolling = true;
                let scrollTimeout = null;
                
                // é…ç½®å¸¸é‡ - å½“æ ‡é¢˜åˆ°è¾¾é¡µé¢ä¸­é—´åä¸Šä½ç½®æ—¶æ¿€æ´»
                const SCROLL_OFFSET = 80; // ç‚¹å‡»æ»šåŠ¨æ—¶çš„åç§»é‡
                const ACTIVATION_POSITION = window.innerHeight * 0.3; // æ¿€æ´»ä½ç½®ï¼šè§†å£é«˜åº¦çš„30%å¤„ï¼ˆä¸­é—´åä¸Šï¼‰
                
                function initTocTracking() {
                    // è·å–æ‰€æœ‰æ ‡é¢˜å…ƒç´ 
                    headings = Array.from(document.querySelectorAll('h1, h2, h3, h4, h5, h6')).filter(h => h.id);
                    
                    // è·å–æ‰€æœ‰TOCé“¾æ¥
                    tocLinks = Array.from(document.querySelectorAll('.toc-link[data-target]'));
                    
                    if (headings.length === 0 || tocLinks.length === 0) return;
                    
                    // ä¸ºTOCé“¾æ¥æ·»åŠ ç‚¹å‡»äº‹ä»¶
                    tocLinks.forEach(link => {
                        link.addEventListener('click', (e) => {
                            e.preventDefault();
                            const targetId = link.getAttribute('data-target');
                            const targetElement = document.getElementById(targetId);
                            
                            if (targetElement) {
                                isUserScrolling = false; // æ ‡è®°ä¸ºç¨‹åºæ§åˆ¶çš„æ»šåŠ¨
                                
                                const targetPosition = targetElement.getBoundingClientRect().top + window.pageYOffset - SCROLL_OFFSET;
                                
                                window.scrollTo({
                                    top: targetPosition,
                                    behavior: 'smooth'
                                });
                                
                                // ç«‹å³æ›´æ–°æ¿€æ´»çŠ¶æ€
                                updateActiveLink(targetId);
                                
                                // æ»šåŠ¨å®Œæˆåæ¢å¤ç”¨æˆ·æ»šåŠ¨æ ‡è®°
                                setTimeout(() => {
                                    isUserScrolling = true;
                                }, 1000);
                            }
                        });
                    });
                    
                    // è®¾ç½®æ»šåŠ¨ç›‘å¬
                    setupScrollTracking();
                    
                    // åˆå§‹åŒ–æ—¶æ£€æŸ¥å½“å‰ä½ç½®
                    setTimeout(() => {
                        updateActiveFromScroll();
                    }, 300);
                }
                
                function setupScrollTracking() {
                    window.addEventListener('scroll', () => {
                        if (!isUserScrolling) return;
                        
                        clearTimeout(scrollTimeout);
                        scrollTimeout = setTimeout(() => {
                            updateActiveFromScroll();
                        }, 10);
                    }, { passive: true });
                }
                
                function updateActiveFromScroll() {
                    if (headings.length === 0) return;
                    
                    let activeHeading = null;
                    let minDistance = Infinity;
                    
                    // éå†æ‰€æœ‰æ ‡é¢˜ï¼Œæ‰¾åˆ°è·ç¦»æ¿€æ´»ä½ç½®æœ€è¿‘çš„æ ‡é¢˜
                    headings.forEach(heading => {
                        const rect = heading.getBoundingClientRect();
                        const headingTop = rect.top;
                        
                        // è®¡ç®—æ ‡é¢˜è·ç¦»æ¿€æ´»ä½ç½®çš„è·ç¦»
                        const distance = Math.abs(headingTop - ACTIVATION_POSITION);
                        
                        // åªè€ƒè™‘åœ¨æ¿€æ´»ä½ç½®ä¹‹ä¸Šæˆ–åˆšå¥½ç»è¿‡æ¿€æ´»ä½ç½®çš„æ ‡é¢˜
                        if (headingTop <= ACTIVATION_POSITION + 50 && distance < minDistance) {
                            minDistance = distance;
                            activeHeading = heading;
                        }
                    });
                    
                    // ç‰¹æ®Šå¤„ç†ï¼šå¦‚æœæ²¡æœ‰æ‰¾åˆ°åˆé€‚çš„æ ‡é¢˜
                    if (!activeHeading) {
                        // æ£€æŸ¥æ˜¯å¦åœ¨é¡µé¢é¡¶éƒ¨ - æ¿€æ´»ç¬¬ä¸€ä¸ªæ ‡é¢˜
                        const scrollTop = window.pageYOffset || document.documentElement.scrollTop;
                        if (scrollTop < 100 && headings.length > 0) {
                            activeHeading = headings[0];
                        }
                        
                        // æ£€æŸ¥æ˜¯å¦åœ¨é¡µé¢åº•éƒ¨ - æ¿€æ´»æœ€åä¸€ä¸ªæ ‡é¢˜
                        const documentHeight = Math.max(
                            document.body.scrollHeight,
                            document.body.offsetHeight,
                            document.documentElement.clientHeight,
                            document.documentElement.scrollHeight,
                            document.documentElement.offsetHeight
                        );
                        
                        if (scrollTop + window.innerHeight >= documentHeight - 50 && headings.length > 0) {
                            activeHeading = headings[headings.length - 1];
                        }
                    }
                    
                    // æ›´æ–°æ¿€æ´»çŠ¶æ€
                    if (activeHeading) {
                        updateActiveLink(activeHeading.id);
                    } else {
                        // å¦‚æœæ²¡æœ‰æ‰¾åˆ°ä»»ä½•åˆé€‚çš„æ ‡é¢˜ï¼Œæ¸…é™¤æ¿€æ´»çŠ¶æ€
                        if (currentActiveLink) {
                            currentActiveLink.classList.remove('is-active');
                            currentActiveLink = null;
                        }
                    }
                }
                
                function updateActiveLink(targetId) {
                    // å¦‚æœç›®æ ‡IDä¸å½“å‰æ¿€æ´»çš„ç›¸åŒï¼Œä¸éœ€è¦æ›´æ–°
                    if (currentActiveLink && currentActiveLink.getAttribute('data-target') === targetId) {
                        return;
                    }
                    
                    // ç§»é™¤å½“å‰æ¿€æ´»çŠ¶æ€
                    if (currentActiveLink) {
                        currentActiveLink.classList.remove('is-active');
                    }
                    
                    // æ‰¾åˆ°å¯¹åº”çš„TOCé“¾æ¥å¹¶æ¿€æ´»
                    const newActiveLink = tocLinks.find(link => 
                        link.getAttribute('data-target') === targetId
                    );
                    
                    if (newActiveLink) {
                        newActiveLink.classList.add('is-active');
                        currentActiveLink = newActiveLink;
                        
                        // æ»šåŠ¨TOCå®¹å™¨ä»¥ç¡®ä¿æ¿€æ´»é“¾æ¥å¯è§
                        scrollTocToActive(newActiveLink);
                    }
                }
                
                function scrollTocToActive(activeLink) {
                    const tocContent = document.querySelector('.toc-content');
                    if (!tocContent || !activeLink) return;
                    
                    const tocRect = tocContent.getBoundingClientRect();
                    const linkRect = activeLink.getBoundingClientRect();
                    
                    // è®¡ç®—é“¾æ¥ç›¸å¯¹äºTOCå®¹å™¨çš„ä½ç½®
                    const linkOffsetTop = activeLink.offsetTop;
                    const containerHeight = tocContent.clientHeight;
                    
                    // å¦‚æœé“¾æ¥ä¸åœ¨å¯è§†åŒºåŸŸå†…ï¼Œåˆ™æ»šåŠ¨åˆ°åˆé€‚ä½ç½®
                    if (linkRect.top < tocRect.top + 20 || linkRect.bottom > tocRect.bottom - 20) {
                        const targetScrollTop = linkOffsetTop - containerHeight / 2;
                        
                        tocContent.scrollTo({
                            top: Math.max(0, targetScrollTop),
                            behavior: 'smooth'
                        });
                    }
                }
                
                // é˜²æŠ–å‡½æ•°
                function debounce(func, wait) {
                    let timeout;
                    return function executedFunction(...args) {
                        const later = () => {
                            clearTimeout(timeout);
                            func(...args);
                        };
                        clearTimeout(timeout);
                        timeout = setTimeout(later, wait);
                    };
                }
                
                // é¡µé¢åŠ è½½å®Œæˆååˆå§‹åŒ–
                if (document.readyState === 'loading') {
                    document.addEventListener('DOMContentLoaded', initTocTracking);
                } else {
                    initTocTracking();
                }
                
                // å¤„ç†é¡µé¢å°ºå¯¸å˜åŒ–
                window.addEventListener('resize', debounce(() => {
                    updateActiveFromScroll();
                }, 250));
                
                // æ¸…ç†å‡½æ•°
                window.addEventListener('beforeunload', () => {
                    if (observer) {
                        observer.disconnect();
                    }
                });
            })();
        </script></div></div><!--!--><style>.column.column-left,.column.column-right{display:block}</style></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><a class="footer-logo is-block mb-2" href="/"><img class="logo-img" src="/img/JIELY.png" alt="éœ¸ç‹é¾™çš„å°çªğŸ¦–" height="28"><img class="logo-img-dark" src="/img/JIELY.png" alt="éœ¸ç‹é¾™çš„å°çªğŸ¦–" height="28"></a><p class="is-size-7"><span>&copy; 2025 Jiely</span>Â Â Powered by <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a>Â &amp;Â <a href="https://github.com/imaegoo/hexo-theme-icarus" target="_blank" rel="noopener">Icarus</a><br><span id="busuanzi_container_site_uv">æ€»è®¿é—®é‡&nbsp;<span id="busuanzi_value_site_pv">-</span>&nbsp;æ¬¡&nbsp;&nbsp;æ€»è®¿å®¢æ•°&nbsp;<span id="busuanzi_value_site_uv">-</span>&nbsp;äºº</span></p></div><div class="level-item has-text-centered"><img src="/img/animals.png" alt="Footer Photo" style="max-width: 500px; height: auto;"></div><div class="level-end"><div class="field has-addons"><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Attribution 4.0 International" href="https://creativecommons.org/licenses/by/4.0/deed.zh"><i class="fab fa-creative-commons-by"></i></a></p></div></div></div></div></footer><script src="/js/imaegoo/jquery/3.3.1/dist/jquery.min.js"></script><script src="/js/imaegoo/moment/2.22.2/min/moment-with-locales.min.js"></script><script src="https://cdn.jsdelivr.net/npm/twikoo@1.6.44/dist/twikoo.all.min.js"></script><script src="/js/imaegoo/clipboard/2.0.4/dist/clipboard.min.js" defer></script><script>moment.locale("zh-cn");</script><script>var IcarusThemeSettings = {
            article: {
                highlight: {
                    clipboard: true,
                    fold: 'unfolded'
                }
            }
        };</script><script data-pjax src="/js/column.js"></script><a id="back-to-top" title="å›åˆ°é¡¶ç«¯" href="javascript:;"><i class="fas fa-chevron-up"></i></a><script data-pjax src="/js/back_to_top.js" defer></script><!--!--><!--!--><script src="/js/imaegoo/lightgallery/1.10.0/dist/js/lightgallery.min.js" defer></script><script src="/js/imaegoo/justifiedGallery/3.8.1/dist/js/jquery.justifiedGallery.min.js" defer></script><script>window.addEventListener("load", () => {
            if (typeof $.fn.lightGallery === 'function') {
                $('.article').lightGallery({ selector: '.gallery-item' });
            }
            if (typeof $.fn.justifiedGallery === 'function') {
                if ($('.justified-gallery > p > .gallery-item').length) {
                    $('.justified-gallery > p > .gallery-item').unwrap();
                }
                $('.justified-gallery').justifiedGallery();
            }
        });</script><!--!--><!--!--><script src="/js/imaegoo/cookieconsent/3.1.1/build/cookieconsent.min.js" defer></script><script>window.addEventListener("load", () => {
      window.cookieconsent.initialise({
        type: "info",
        theme: "edgeless",
        static: false,
        position: "bottom-right",
        content: {
          message: "æ­¤ç½‘ç«™ä½¿ç”¨ Cookieï¼Œä»¥å¯ç”¨è¯„è®ºç³»ç»Ÿå’Œåˆ†æåŠŸèƒ½ã€‚",
          dismiss: "çŸ¥é“äº†",
          allow: "å…è®¸ä½¿ç”¨Cookie",
          deny: "æ‹’ç»",
          link: "äº†è§£æ›´å¤š",
          policy: "Cookieæ”¿ç­–",
          href: "/cookies/",
        },
        palette: {
          popup: {
            background: "#edeff5",
            text: "#838391"
          },
          button: {
            background: "#4b81e8"
          },
        },
      });
    });</script><script data-pjax src="/js/main.js" defer></script><div class="searchbox"><div class="searchbox-container"><div class="searchbox-header"><div class="searchbox-input-container"><input class="searchbox-input" type="text" placeholder="æƒ³è¦æŸ¥æ‰¾ä»€ä¹ˆ..."></div><div class="searchbox-pinyin"><label class="checkbox"><input id="search-by-pinyin" type="checkbox" checked="checked"><span>Â æ‹¼éŸ³æ£€ç´¢</span></label></div><a class="searchbox-close" href="javascript:;">Ã—</a></div><div class="searchbox-body"></div></div></div><script src="/js/imaegoo/pinyin.js" defer></script><script src="/js/insight.js" defer></script><script>document.addEventListener('DOMContentLoaded', function () {
            loadInsight({"contentUrl":"/content.json"}, {"hint":"æƒ³è¦æŸ¥æ‰¾ä»€ä¹ˆ...","untitled":"(æ— æ ‡é¢˜)","posts":"æ–‡ç« ","pages":"é¡µé¢","categories":"åˆ†ç±»","tags":"æ ‡ç­¾"});
        });</script><script type="text/javascript" src="/js/imaegoo/imaegoo.js"></script><script type="text/javascript" src="/js/imaegoo/universe.js"></script><script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js"></script><script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.min.js">
                            document.addEventListener("DOMContentLoaded", function() {
                                renderMathInElement(document.body, {
                                    delimiters: [
                                        {left: "$$", right: "$$", display: true},
                                        {left: "$", right: "$", display: false}
                                    ]
                                });
                            });
                        </script></body></html>